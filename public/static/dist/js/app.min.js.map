{"version":3,"sources":["node_modules/_browser-pack@6.0.2@browser-pack/_prelude.js","public/static/src/js/app.js","public/static/src/js/module/config.js","public/static/src/js/module/configDialog.js","public/static/src/js/module/const.js","public/static/src/js/module/dialog.js","public/static/src/js/module/index.js","public/static/src/js/module/msg.js","public/static/src/js/module/other.js","public/static/src/js/module/post.js","public/static/src/js/module/public.js","public/static/src/js/module/read.js","public/static/src/js/module/script.js","public/static/src/js/module/util.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_config","_util","_const","_msg","_dialog","_script","_public","Public","_index","Index","_read","Read","_post","Post","_other","Other","_configDialog","window","pageId","$","attr","exportModule","Util","Const","default","Msg","Dialog","Script","Conf","readConfig","read","writeConfig","write","ex","console","log","init","startTime","Date","handleRegisterPage","Config","customCssEnabled","customCssContent","append","preventCloseWindow","handleMainMenu","handleMainMenuLink","showSidebarBtnGroupEnabled","showSidebarBtnGroup","handleSidebarRollBtn","handleSearchDialog","fillCommonForumPanel","showEditCommonForumDialog","handlePageInput","bindFastSubmitShortcutKey","handleAtTipsBtn","handleIndexThreadPanel","handleSelectBg","gotoFloor","threadContentFontSize","handleFastGotoFloorBtn","handleTuiThreadBtn","handleCopyFloorLinkBtn","handleFastReplyBtn","handleGoodPostBtn","handleBlockFloorBtn","handleBuyThreadBtn","copyBuyThreadList","replaceAttachLabel","handleFloorImage","checkPostForm","handleCopyCodeBtn","addSmileCode","addRedundantKeywordWarning","bindMultiQuoteCheckClick","handleClearMultiQuoteDataBtn","handleMoveThreadBtn","click","handleMultiQuote","userMemoEnabled","addUserMemo","handleEditorBtns","handleAttachBtns","Info","multiQuote","highlightUnReadAtTipsMsg","handleUserPageBtns","handleProfilePage","handleGameIntroSearchArea","includes","tuiGame","bindFavorPageBtnsClick","bindFriendPageBtnsClick","syncPerPageFloorNum","assignBirthdayField","handleUploadAvatarFileBtn","transferKfbAlert","bindMessageActionBtnsClick","showSelfRateErrorSizeSubmitWarning","on","confirm","this","text","trim","localStorage","removeItem","uid","handleBuyItemBtns","showMyInfoInItemShop","blockUserEnabled","blockUsers","blockThreadEnabled","blockThread","followUserEnabled","followUsers","kfSmileEnhanceExtensionEnabled","rootPath","staticPath","resTimestamp","tooltip","container","document","ready","name","activeNewReplyPanel","activeTopRecommendPanel","commonForumList","showSidebarRollBtnEnabled","showSidebarMainMenuBtnEnabled","showSidebarForumListBtnEnabled","showSidebarSearchBtnEnabled","showSidebarHomePageBtnEnabled","perPageFloorNum","userMemoList","defShowMsgDuration","followUserList","highlightFollowUserThreadInHPEnabled","highlightFollowUserThreadLinkEnabled","blockUserDefaultType","blockUserAtTipsEnabled","blockUserForumType","blockUserFidList","blockUserList","blockThreadDefForumType","blockThreadDefFidList","blockThreadList","extend","options","JSON","parse","type","isEmptyObject","normalize","getDifferenceSetOfObject","stringify","clear","settings","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Object","entries","Symbol","iterator","next","done","_step$value","_slicedToArray","value","key","err","return","show","$dialog","create","submit","preventDefault","getMainConfigValue","close","$this","hasClass","data","showRunCommandDialog","showUserMemoDialog","showCustomCssDialog","showFollowUserDialog","showBlockUserDialog","showBlockThreadDialog","find","prompt","parseInt","isNaN","clearTmpData","alert","end","location","reload","showImportOrExportSettingDialog","setMainConfigValue","each","is","prop","val","Boolean","arguments","_const2","test","deleteCookie","multiQuoteStorageName","$cmd","$result","content","_Script$runCmd","runCmd","response","focus","keydown","ctrlKey","keyCode","select","$userMemoList","split","line","_line$split","_line$split2","user","_line$split2$","memo","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_step2$value","$content","dialogName","$followUserList","addFollowUser","appendTo","inFollowOrBlockUserList","push","$checked","remove","$addUser","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","showCommonImportOrExportConfigDialog","selectAll","selectInverse","closest","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","$blockUserList","addBlockUser","Set","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","fid","add","concat","_toConsumableArray","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","change","triggerHandler","join","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","bodyContent","footerContent","$blockThreadList","addBlockThread","keyWord","userType","userList","fidType","fidList","verify","flag","$txtKeyWord","eval","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","newObj","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","size","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","html","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_iterator11","_step11","includeUser","excludeUser","includeFid","excludeFid","atTipsTimeExpires","bgStyleExpires","storagePrefix","atTipsTimeCookieName","prevAtTipsTimeCookieName","bgStyleCookieName","availableForumList","resize","id","title","checked","isOpera","isEdge","not","removeClass","addClass","fadeIn","css","height","outerHeight","fadeOut","parent","off","time","cookieValue","getCookie","setCookie","curDate","getDate","toString","padStart","tab","$target","target","targetPanel","typeName","fileName","path","color","$bg","toLowerCase","replace","duration","msg","clickable","preventable","$container","isFirst","destroy","$msg","hide","stopPropagation","slideDown","setTimeout","wait","slideUp","gjc","userName","timeString","prevString","index","curString","keyword","searchType","cookieName","ajax","url","success","$num","num","error","complete","removeData","$form","action","matches","exec","year","month","day","syncConfig","_$checked","makeUrl","showValidationMsg","trigger","namecheck","$response","post","serialize","_ref","fail","$area","str","splice","$registerDate","now","_matches","getMonth","getFullYear","ratingSize","parseFloat","titleSize","toLocaleString","get","kfbMatches","gxMatches","kfb","gx","itemId","safeId","removeHtmlTag","always","textArea","selText","getSelText","addCode","codeType","$postType","$postTitle","getStrByteLen","$voteItemContent","$postContent","_length","$postGjc","after","blur","$newAttachArea","$lastAttachArea","insertAfter","$node","$relatedTarget","relatedTarget","_data","tid","quoteList","list","values","_data2","Array","isArray","quote","keywords","$keywords","clearQueue","floor","pid","queue","getTime","postContent","$countdownNum","dequeue","filter","ConfigDialog","maxHeight","documentElement","clientHeight","scroll","$btn","scrollTop","animate","$searchDialog","$searchKeyword","$method","Math","$current","$currentBox","disabled","maxPageNum","excludeParams","currentPageNum","href","commonForumListHtml","availableForumListHtml","elem","dragulaInit","dragula","revertOnSpill","$dragulaScriptPath","dragulaScriptPath","getScript","children","_step3$value","_step3$value$","_fid","addEventListener","returnValue","configName","callback","callbackAfterSubmit","regex1","RegExp","regex2","isBlock","_step5$value","regex","$topFloor","getCheckedMultiQuoteData","link","getHostNameUrl","copyText","$article","selectionStart","selectionEnd","goodPostTips","$floor","prepend","price","$wait","map","repeat","selectedIndex","modal","naturalWidth","width","hashName","prev","hash","$pre","decodeHtmlSpecialChar","keys","aid","replaceWith","cmd","isOutput","isError","String","date","prefix","cookie","encodeURI","toUTCString","match","decodeURI","increment","setFullYear","setMonth","setDate","setHours","getHours","setMinutes","getMinutes","setSeconds","getSeconds","setMilliseconds","getMilliseconds","extractQueryStr","len","charCodeAt","protocol","host","startPos","indexOf","prePos","substring","params","Map","param","_param$split","_param$split2","set","buildQueryStr","queryStr","urlType","deepEqual","includeOtherParam","paramList","urlParam","delete","startsWith","pathname","baseFile","getQueryParam","$nodes","$parent","inArray","$feedback","b","c","$source","getSelection","selectAllChildren","result","execCommand","removeAllRanges","findIndex","opera","navigator","appVersion"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\nimport {init as initConfig} from './module/config';\r\nimport * as Util from './module/util';\r\nimport Const from './module/const';\r\nimport * as Msg from './module/msg';\r\nimport * as Dialog from './module/dialog';\r\nimport * as Script from './module/script';\r\nimport * as Public from './module/public';\r\nimport * as Index from './module/index';\r\nimport * as Read from './module/read';\r\nimport * as Post from './module/post';\r\nimport * as Other from './module/other';\r\nimport * as ConfigDialog from './module/configDialog';\r\n\r\n// ID\r\nwindow.pageId = $('body').attr('id');\r\n\r\n/**\r\n * \r\n */\r\nconst exportModule = function () {\r\n    try {\r\n        window.Util = require('./module/util');\r\n        window.Const = require('./module/const').default;\r\n        window.Msg = require('./module/msg');\r\n        window.Dialog = require('./module/dialog');\r\n        window.Script = require('./module/script');\r\n        window.Public = require('./module/public');\r\n        window.Index = require('./module/index');\r\n        window.Read = require('./module/read');\r\n        window.Post = require('./module/post');\r\n        window.Other = require('./module/other');\r\n        const Conf = require('./module/config');\r\n        window.readConfig = Conf.read;\r\n        window.writeConfig = Conf.write;\r\n    }\r\n    catch (ex) {\r\n        console.log(ex);\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst init = function () {\r\n    if (pageId === 'loginPage') return;\r\n    let startTime = new Date();\r\n    exportModule();\r\n    if (pageId === 'registerPage') {\r\n        Other.handleRegisterPage();\r\n        return;\r\n    }\r\n    initConfig();\r\n\r\n    if (Config.customCssEnabled && Config.customCssContent) $('head').append(`<style>${Config.customCssContent}</style>`);\r\n    Public.preventCloseWindow();\r\n    Public.handleMainMenu();\r\n    Public.handleMainMenuLink();\r\n    if (Config.showSidebarBtnGroupEnabled) Public.showSidebarBtnGroup();\r\n    Public.handleSidebarRollBtn();\r\n    Public.handleSearchDialog();\r\n    Public.fillCommonForumPanel();\r\n    Public.showEditCommonForumDialog();\r\n    if ($('.page-input').length > 0) Public.handlePageInput();\r\n    Public.bindFastSubmitShortcutKey();\r\n\r\n    if (pageId === 'indexPage') {\r\n        Index.handleAtTipsBtn();\r\n        Index.handleIndexThreadPanel();\r\n        Index.handleSelectBg();\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        Read.gotoFloor();\r\n        if (Config.threadContentFontSize > 0)\r\n            $('head').append(`<style>.read-content { font-size: ${Config.threadContentFontSize}px; }</style>`);\r\n        Read.handleFastGotoFloorBtn();\r\n        Read.handleTuiThreadBtn();\r\n        Read.handleCopyFloorLinkBtn();\r\n        Read.handleFastReplyBtn();\r\n        Read.handleGoodPostBtn();\r\n        Read.handleBlockFloorBtn();\r\n        Read.handleBuyThreadBtn();\r\n        Read.copyBuyThreadList();\r\n        Read.replaceAttachLabel();\r\n        Read.handleFloorImage();\r\n        Post.checkPostForm();\r\n        Read.handleCopyCodeBtn();\r\n        Post.addSmileCode($('#postContent'));\r\n        Post.addRedundantKeywordWarning();\r\n        Read.bindMultiQuoteCheckClick();\r\n        Post.handleClearMultiQuoteDataBtn();\r\n        Read.handleMoveThreadBtn();\r\n        $('.multi-reply-btn').click(() => Post.handleMultiQuote(1));\r\n        if (Config.userMemoEnabled) Read.addUserMemo();\r\n    }\r\n    else if (pageId === 'postPage') {\r\n        Post.addRedundantKeywordWarning();\r\n        Post.checkPostForm();\r\n        Post.handleEditorBtns();\r\n        Post.addSmileCode($('#postContent'));\r\n        Post.handleAttachBtns();\r\n        Post.handleClearMultiQuoteDataBtn();\r\n        if (Info.multiQuote) Post.handleMultiQuote(2);\r\n    }\r\n    else if (pageId === 'gjcPage') {\r\n        Other.highlightUnReadAtTipsMsg();\r\n    }\r\n    else if (pageId === 'userPage') {\r\n        Other.handleUserPageBtns();\r\n        Other.handleProfilePage();\r\n    }\r\n    else if (pageId === 'gameIntroSearchPage') {\r\n        Other.handleGameIntroSearchArea();\r\n    }\r\n    else if (['gameIntroPage', 'gameIntroCompanyPage', 'gameIntroTypePage', 'gameIntroPropertyPage'].includes(pageId)) {\r\n        Other.tuiGame();\r\n    }\r\n    else if (pageId === 'favorPage') {\r\n        Other.bindFavorPageBtnsClick();\r\n    }\r\n    else if (pageId === 'friendPage') {\r\n        Other.bindFriendPageBtnsClick();\r\n    }\r\n    else if (pageId === 'modifyPage') {\r\n        Other.syncPerPageFloorNum();\r\n        Other.assignBirthdayField();\r\n        Other.handleUploadAvatarFileBtn();\r\n    }\r\n    else if (pageId === 'bankPage') {\r\n        Other.transferKfbAlert();\r\n    }\r\n    else if (pageId === 'messagePage') {\r\n        Other.bindMessageActionBtnsClick();\r\n    }\r\n    else if (pageId === 'readMessagePage') {\r\n        Read.handleFloorImage();\r\n        Read.handleCopyCodeBtn();\r\n    }\r\n    else if (pageId === 'writeMessagePage') {\r\n        Post.addSmileCode($('#msgContent'));\r\n    }\r\n    else if (pageId === 'selfRateRatingPage') {\r\n        Other.showSelfRateErrorSizeSubmitWarning();\r\n    }\r\n    else if (pageId === 'haloPage') {\r\n        $('#buyHaloBtns').on('click', 'a', function () {\r\n            if (!confirm(`${$(this).text().trim()}`)) return false;\r\n            localStorage.removeItem('pd_tmp_log_' + Info.uid);\r\n        });\r\n    }\r\n    else if (pageId === 'itemShopPage') {\r\n        Other.handleBuyItemBtns();\r\n        Other.showMyInfoInItemShop();\r\n    }\r\n\r\n    if (Config.blockUserEnabled) Public.blockUsers();\r\n    if (Config.blockThreadEnabled) Public.blockThread();\r\n    if (Config.followUserEnabled) Public.followUsers();\r\n    if (Config.kfSmileEnhanceExtensionEnabled && ['readPage', 'postPage', 'writeMessagePage'].includes(pageId)) {\r\n        $('body').append(\r\n            `<script src=\"${Info.rootPath}${Info.staticPath}js/userScript/KfEmotion.min.user.js?ts=${Info.resTimestamp}\"></script>`\r\n        );\r\n    }\r\n\r\n    $('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    console.log(`${new Date() - startTime}ms`);\r\n};\r\n\r\n$(document).ready(init);\r\n","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\n\r\n// \r\nconst name = 'kf_config';\r\n\r\n/**\r\n * \r\n */\r\nexport const Config = {\r\n    // \r\n    activeNewReplyPanel: '#galgameNewReplyPanel',\r\n    // \r\n    activeTopRecommendPanel: '#galgameTopRecommendPanel',\r\n    // \r\n    commonForumList: [],\r\n\r\n    // truefalse\r\n    showSidebarBtnGroupEnabled: true,\r\n    // /truefalse\r\n    showSidebarRollBtnEnabled: true,\r\n    // truefalse\r\n    showSidebarMainMenuBtnEnabled: false,\r\n    // truefalse\r\n    showSidebarForumListBtnEnabled: true,\r\n    // truefalse\r\n    showSidebarSearchBtnEnabled: false,\r\n    // truefalse\r\n    showSidebarHomePageBtnEnabled: true,\r\n\r\n    // \r\n    perPageFloorNum: 10,\r\n    // 014px\r\n    threadContentFontSize: 0,\r\n    // truefalse\r\n    userMemoEnabled: false,\r\n    // {'':''}{'':'','':''}\r\n    userMemoList: {},\r\n    // truefalse\r\n    kfSmileEnhanceExtensionEnabled: false,\r\n\r\n    // -1\r\n    defShowMsgDuration: -1,\r\n    // CSStruefalse\r\n    customCssEnabled: false,\r\n    // CSS\r\n    customCssContent: '',\r\n\r\n    // truefalse\r\n    followUserEnabled: false,\r\n    // [{name:''}][{name:''}, {name:''}]\r\n    followUserList: [],\r\n    // truefalse\r\n    highlightFollowUserThreadInHPEnabled: true,\r\n    // truefalse\r\n    highlightFollowUserThreadLinkEnabled: true,\r\n    // truefalse\r\n    blockUserEnabled: false,\r\n    // 012\r\n    blockUserDefaultType: 0,\r\n    // @truefalse\r\n    blockUserAtTipsEnabled: true,\r\n    // 012\r\n    blockUserForumType: 0,\r\n    // ID[16, 41, 67, 57, 84, 92, 127, 68, 163, 182, 9]\r\n    blockUserFidList: [],\r\n    // [{name:'', type:}][{name:'', type:0}, {name:'', type:1}]\r\n    blockUserList: [],\r\n    // truefalse\r\n    blockThreadEnabled: false,\r\n    // 012\r\n    blockThreadDefForumType: 0,\r\n    // ID[16, 41, 67, 57, 84, 92, 127, 68, 163, 182, 9]\r\n    blockThreadDefFidList: [],\r\n    // [{keyWord:'', includeUser:[''], excludeUser:[''], includeFid:[ID], excludeFid:[ID]}]\r\n    // '/abc/'includeUserexcludeUserincludeFidexcludeFid\r\n    // [{keyWord: '1'}, {keyWord: '2', includeUser:['1', '2'], includeFid: [5, 56]}, {keyWord: '/A.*B/i', excludeFid: [92, 127, 68]}]\r\n    blockThreadList: [],\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const init = function () {\r\n    window.Config = $.extend(true, {}, Config);\r\n    read();\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const read = function () {\r\n    let options = localStorage[name];\r\n    if (!options) return;\r\n    try {\r\n        options = JSON.parse(options);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!options || $.type(options) !== 'object' || $.isEmptyObject(options)) return;\r\n    options = normalize(options);\r\n    window.Config = $.extend(true, {}, Config, options);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const write = function () {\r\n    let options = Util.getDifferenceSetOfObject(Config, window.Config);\r\n    localStorage[name] = JSON.stringify(options);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const clear = function () {\r\n    localStorage.removeItem(name);\r\n};\r\n\r\n/**\r\n * Config\r\n * @param {{}} options Config\r\n * @returns {{}} Config\r\n */\r\nexport const normalize = function (options) {\r\n    let settings = {};\r\n    if ($.type(options) !== 'object') return settings;\r\n    for (let [key, value] of Object.entries(options)) {\r\n        if (key in Config && $.type(value) === $.type(Config[key])) {\r\n            settings[key] = value;\r\n        }\r\n    }\r\n    return settings;\r\n};\r\n","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport * as Dialog from './dialog';\r\nimport {\r\n    read as readConfig,\r\n    write as writeConfig,\r\n    clear as clearConfig,\r\n    normalize as normalizeConfig,\r\n    Config as defConfig,\r\n} from './config';\r\nimport * as Script from './script';\r\nimport * as Public from './public';\r\n\r\n/**\r\n * \r\n */\r\nexport const show = function () {\r\n    const dialogName = 'configDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<div class=\"btn-group-sm text-right mb-1\">\r\n  <a class=\"btn btn-link text-danger\" data-name=\"clearTmpData\" href=\"#\"></a>\r\n  <a class=\"btn btn-link\" data-name=\"openRunCommandDialog\" href=\"#\"></a>\r\n</div>\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"showSidebarBtnGroupEnabled\" type=\"checkbox\"> \r\n      <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n    </label>\r\n  </legend>\r\n  <div class=\"mb-2 d-sm-inline-block\">\r\n    <div class=\"form-check form-check-inline\">\r\n      <label class=\"form-check-label\">\r\n        <input class=\"form-check-input\" name=\"showSidebarRollBtnEnabled\" type=\"checkbox\"> /\r\n      </label>\r\n    </div>\r\n    <div class=\"form-check form-check-inline\">\r\n      <label class=\"form-check-label\">\r\n        <input class=\"form-check-input\" name=\"showSidebarMainMenuBtnEnabled\" type=\"checkbox\"> \r\n      </label>\r\n    </div>\r\n  </div>\r\n  <div class=\"mb-2 d-sm-inline-block ml-sm-3\">\r\n    <div class=\"form-check form-check-inline\">\r\n      <label class=\"form-check-label\">\r\n        <input class=\"form-check-input\" name=\"showSidebarForumListBtnEnabled\" type=\"checkbox\"> \r\n      </label>\r\n    </div>\r\n    <div class=\"form-check form-check-inline\">\r\n      <label class=\"form-check-label\">\r\n        <input class=\"form-check-input\" name=\"showSidebarSearchBtnEnabled\" type=\"checkbox\"> \r\n      </label>\r\n    </div>\r\n    <div class=\"form-check form-check-inline\">\r\n      <label class=\"form-check-label\">\r\n        <input class=\"form-check-input\" name=\"showSidebarHomePageBtnEnabled\" type=\"checkbox\"> \r\n      </label>\r\n    </div>\r\n  </div>\r\n</fieldset>\r\n\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend></legend>\r\n  <div class=\"form-group mb-2\">\r\n    <label for=\"perPageFloorNum\"></label>\r\n    <select class=\"custom-select custom-select-sm w-auto\" id=\"perPageFloorNum\" name=\"perPageFloorNum\">\r\n      <option value=\"10\">10</option><option value=\"20\">20</option><option value=\"30\">30</option>\r\n    </select>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n  </div>\r\n  <div class=\"input-group mb-2\">\r\n    <div class=\"input-group-prepend\">\r\n      <span class=\"input-group-text\"></span>\r\n    </div>\r\n    <input class=\"form-control\" name=\"threadContentFontSize\" data-toggle=\"tooltip\" type=\"number\" min=\"8\" max=\"72\"\r\n           title=\"14px\">\r\n    <div class=\"input-group-append\">\r\n      <span class=\"input-group-text\">px</span>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"userMemoEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openUserMemoDialog]\"> \r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openUserMemoDialog\" href=\"#\" role=\"button\">&raquo;</a>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"kfSmileEnhanceExtensionEnabled\" type=\"checkbox\"> \r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"eddie32\">[?]</span>\r\n  </div>\r\n</fieldset>\r\n\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend></legend>\r\n  <div class=\"input-group mb-2\">\r\n    <div class=\"input-group-prepend\">\r\n      <span class=\"input-group-text\"></span>\r\n    </div>\r\n    <input class=\"form-control\" name=\"defShowMsgDuration\" data-toggle=\"tooltip\" type=\"number\" min=\"-1\" required\r\n           title=\"-115\">\r\n    <div class=\"input-group-append\">\r\n      <span class=\"input-group-text\"></span>\r\n    </div>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"customCssEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openCustomCssDialog]\"> CSS\r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"CSSCSS\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openCustomCssDialog\" href=\"#\" role=\"button\">&raquo;</a>\r\n  </div>\r\n</fieldset>\r\n\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend></legend>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"followUserEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openFollowUserDialog]\"> \r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openFollowUserDialog\" href=\"#\" role=\"button\">&raquo;</a>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockUserEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openBlockUserDialog]\"> \r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openBlockUserDialog\" href=\"#\" role=\"button\">&raquo;</a>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockThreadEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openBlockThreadDialog]\"> \r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openBlockThreadDialog\" href=\"#\" role=\"button\">&raquo;</a>\r\n  </div>\r\n</fieldset>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImportOrExportSettingDialog\" type=\"button\">/</button>\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>\r\n<button class=\"btn btn-danger\" name=\"reset\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        readConfig();\r\n        let options = getMainConfigValue($dialog);\r\n        options = normalizeConfig(options);\r\n        $.extend(Config, options);\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).on('click', 'a[data-name^=\"open\"][href=\"#\"]', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.hasClass('disabled-link')) return;\r\n        let name = $this.data('name');\r\n        if (name === 'openRunCommandDialog') showRunCommandDialog();\r\n        else if (name === 'openUserMemoDialog') showUserMemoDialog();\r\n        else if (name === 'openCustomCssDialog') showCustomCssDialog();\r\n        else if (name === 'openFollowUserDialog') showFollowUserDialog();\r\n        else if (name === 'openBlockUserDialog') showBlockUserDialog();\r\n        else if (name === 'openBlockThreadDialog') showBlockThreadDialog();\r\n    }).find('[data-name=\"clearTmpData\"]').click(function (e) {\r\n        e.preventDefault();\r\n        let type = prompt(\r\n            'Cookies\\n01Cookies2', 0\r\n        );\r\n        if (type === null) return;\r\n        type = parseInt(type);\r\n        if (!isNaN(type) && type >= 0) {\r\n            clearTmpData(type);\r\n            alert('');\r\n        }\r\n    }).end().find('[name=\"reset\"]').click(function () {\r\n        if (confirm('')) {\r\n            clearConfig();\r\n            alert('');\r\n            Dialog.close(dialogName);\r\n            location.reload();\r\n        }\r\n    }).end().find('[name=\"openImportOrExportSettingDialog\"]').click(showImportOrExportSettingDialog);\r\n\r\n    setMainConfigValue($dialog);\r\n    Dialog.show(dialogName);\r\n};\r\n\r\n/**\r\n * \r\n * @param {jQuery} $dialog \r\n */\r\nconst setMainConfigValue = function ($dialog) {\r\n    $dialog.find('input[name], select[name]').each(function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        if (name in Config) {\r\n            if ($this.is('[type=\"checkbox\"]') && typeof Config[name] === 'boolean') $this.prop('checked', Config[name] === true);\r\n            else $this.val(Config[name]);\r\n        }\r\n    });\r\n    $dialog.find('[name=\"threadContentFontSize\"]').val(Config.threadContentFontSize > 0 ? Config.threadContentFontSize : '');\r\n};\r\n\r\n/**\r\n * Config\r\n * @param {jQuery} $dialog \r\n * @returns {{}} Config\r\n */\r\nconst getMainConfigValue = function ($dialog) {\r\n    let options = {};\r\n    $dialog.find('input[name], select[name]').each(function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        if (name in Config) {\r\n            if ($this.is('[type=\"checkbox\"]') && typeof Config[name] === 'boolean')\r\n                options[name] = Boolean($this.prop('checked'));\r\n            else if (typeof Config[name] === 'number') {\r\n                options[name] = parseInt($this.val());\r\n                if (name === 'threadContentFontSize' && isNaN(options[name])) options[name] = 0;\r\n            }\r\n            else options[name] = $.trim($this.val());\r\n        }\r\n    });\r\n    return options;\r\n};\r\n\r\n/**\r\n * \r\n * @param {number} type 01Cookies2\r\n */\r\nconst clearTmpData = function (type = 0) {\r\n    if (type === 0 || type === 1) {\r\n        for (let key in Const) {\r\n            if (/CookieName$/.test(key)) {\r\n                Util.deleteCookie(Const[key]);\r\n            }\r\n        }\r\n    }\r\n    if (type === 0 || type === 2) {\r\n        //TmpLog.clear();\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst showRunCommandDialog = function () {\r\n    const dialogName = 'runCommandDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\">\r\n  <kbd>Ctrl+Enter</kbd><kbd>Ctrl+</kbd>\r\n</p>\r\n<div class=\"form-group\">\r\n  <label for=\"cfgCmd\"></label>\r\n  <textarea class=\"form-control\" name=\"cmd\" id=\"cfgCmd\" rows=\"6\" wrap=\"off\" aria-label=\"\" style=\"white-space: pre;\"></textarea>\r\n</div>\r\n<div class=\"form-group\">\r\n  <label for=\"cfgResult\"></label>\r\n  <textarea class=\"form-control\" name=\"result\" id=\"cfgResult\" rows=\"6\" wrap=\"off\" aria-label=\"\" style=\"white-space: pre;\"></textarea>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-danger\" name=\"clear\" type=\"button\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n    let $cmd = $dialog.find('[name=\"cmd\"]');\r\n    let $result = $dialog.find('[name=\"result\"]');\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        let content = $cmd.val();\r\n        if (!$.trim(content)) return;\r\n        let {response} = Script.runCmd(content, true);\r\n        $result.val(response);\r\n    }).end().find('[name=\"clear\"]').click(function () {\r\n        $cmd.val('').focus();\r\n    });\r\n\r\n    $cmd.keydown(function (e) {\r\n        if (e.ctrlKey && e.keyCode === 13) {\r\n            $dialog.submit();\r\n        }\r\n        else if (e.ctrlKey && e.keyCode === 8) {\r\n            $dialog.find('[name=\"clear\"]').click();\r\n        }\r\n    });\r\n\r\n    Dialog.show(dialogName);\r\n    $cmd.focus();\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst showImportOrExportSettingDialog = function () {\r\n    const dialogName = 'imOrExSettingDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\">\r\n  <b></b><br>\r\n  <b></b><br>\r\n  <span class=\"text-danger\">KFOL</span>\r\n</p>\r\n<div class=\"form-group\">\r\n  <textarea class=\"form-control\" name=\"setting\" rows=\"10\" aria-label=\"\" style=\"word-break: break-all;\"></textarea>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('')) return;\r\n        let options = $.trim($dialog.find('[name=\"setting\"]').val());\r\n        if (!options) return;\r\n        try {\r\n            options = JSON.parse(options);\r\n        }\r\n        catch (ex) {\r\n            alert('');\r\n            return;\r\n        }\r\n        if (!options || $.type(options) !== 'object') {\r\n            alert('');\r\n            return;\r\n        }\r\n        options = normalizeConfig(options);\r\n        window.Config = $.extend(true, {}, defConfig, options);\r\n        writeConfig();\r\n        alert('');\r\n        location.reload();\r\n    });\r\n    Dialog.show(dialogName);\r\n    $dialog.find('[name=\"setting\"]').val(JSON.stringify(Util.getDifferenceSetOfObject(defConfig, Config))).select().focus();\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst showUserMemoDialog = function () {\r\n    const dialogName = 'userMemoDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\"><code>:</code></p>\r\n<div class=\"form-group\">\r\n  <textarea class=\"form-control\" name=\"userMemoList\" rows=\"13\" wrap=\"off\" aria-label=\"\" style=\"white-space: pre;\"></textarea>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n    let $userMemoList = $dialog.find('[name=\"userMemoList\"]');\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        let content = $.trim($userMemoList.val());\r\n        Config.userMemoList = {};\r\n        for (let line of content.split('\\n')) {\r\n            line = $.trim(line);\r\n            if (!line) continue;\r\n            if (!/.+?:.+/.test(line)) {\r\n                alert('');\r\n                $userMemoList.focus();\r\n                return;\r\n            }\r\n            let [user, memo = ''] = line.split(':');\r\n            if (!memo) continue;\r\n            Config.userMemoList[user.trim()] = memo.trim();\r\n        }\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    });\r\n\r\n    let content = '';\r\n    for (let [user, memo] of Object.entries(Config.userMemoList)) {\r\n        content += `${user}:${memo}\\n`;\r\n    }\r\n    Dialog.show(dialogName);\r\n    $userMemoList.val(content).focus();\r\n};\r\n\r\n/**\r\n * CSS\r\n */\r\nconst showCustomCssDialog = function () {\r\n    const dialogName = 'customCssDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<div class=\"form-group\">\r\n  <textarea class=\"form-control\" name=\"customCssContent\" rows=\"15\" wrap=\"off\" aria-label=\"CSS\" style=\"white-space: pre;\"></textarea>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, 'CSS', bodyContent, footerContent);\r\n    let $content = $dialog.find('[name=\"customCssContent\"]');\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        Config.customCssContent = $.trim($content.val());\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n        alert('CSS');\r\n    });\r\n    Dialog.show(dialogName);\r\n    $content.val(Config.customCssContent).focus();\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst showFollowUserDialog = function () {\r\n    const dialogName = 'followUserDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    let bodyContent = `\r\n<div class=\"form-check\">\r\n  <label class=\"form-check-label\">\r\n    <input class=\"form-check-input\" name=\"highlightFollowUserThreadInHpEnabled\" type=\"checkbox\"> \r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n  </label>\r\n</div>\r\n<div class=\"form-check mb-3\">\r\n  <label class=\"form-check-label\">\r\n    <input class=\"form-check-input\" name=\"highlightFollowUserThreadLinkEnabled\" type=\"checkbox\"> \r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"\">[?]</span>\r\n  </label>\r\n</div>\r\n<ul class=\"list-unstyled\" id=\"followUserList\"></ul>\r\n<div class=\"btn-group btn-group-sm mb-3\" role=\"group\">\r\n  <button class=\"btn btn-secondary\" name=\"selectAll\" type=\"button\"></button>\r\n  <button class=\"btn btn-secondary\" name=\"selectInverse\" type=\"button\"></button>\r\n  <button class=\"btn btn-danger\" name=\"deleteSelect\" type=\"button\"></button>\r\n</div>\r\n<div class=\"input-group mb-3\">\r\n  <input class=\"form-control\" name=\"addUser\" data-toggle=\"tooltip\" type=\"text\" title=\"\" aria-label=\"\">\r\n  <div class=\"input-group-append\">\r\n    <button class=\"btn btn-success\" name=\"add\" type=\"button\"></button>\r\n  </div>\r\n</div>\r\n`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImOrExFollowUserListDialog\" type=\"button\">/</button>\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n    let $followUserList = $dialog.find('#followUserList');\r\n\r\n    /**\r\n     * \r\n     * @param {string} name \r\n     */\r\n    const addFollowUser = function (name) {\r\n        $(`\r\n<li class=\"input-group input-group-sm mb-2\">\r\n  <div class=\"input-group-prepend\">\r\n    <div class=\"input-group-text\">\r\n      <input type=\"checkbox\" aria-label=\"\">\r\n    </div>\r\n  </div>\r\n  <input class=\"form-control\" name=\"userName\" type=\"text\" value=\"${name}\" maxlength=\"12\" aria-label=\"\">\r\n  <div class=\"input-group-append\">\r\n    <button class=\"btn btn-danger\" name=\"delete\" type=\"button\" aria-label=\"\">\r\n      <i class=\"fa fa-trash\" aria-hidden=\"true\"></i>\r\n    </button>\r\n  </div>\r\n</li>\r\n`).appendTo($followUserList);\r\n    };\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        Config.highlightFollowUserThreadInHPEnabled = $dialog.find('[name=\"highlightFollowUserThreadInHpEnabled\"]').prop('checked');\r\n        Config.highlightFollowUserThreadLinkEnabled = $dialog.find('[name=\"highlightFollowUserThreadLinkEnabled\"]').prop('checked');\r\n        Config.followUserList = [];\r\n        $followUserList.find('li').each(function () {\r\n            let $this = $(this);\r\n            let name = $.trim($this.find('[name=\"userName\"]').val());\r\n            if (name !== '' && Util.inFollowOrBlockUserList(name, Config.followUserList) === -1) {\r\n                Config.followUserList.push({name});\r\n            }\r\n        });\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).find('[name=\"deleteSelect\"]').click(function () {\r\n        let $checked = $followUserList.find('li:has([type=\"checkbox\"]:checked)');\r\n        if (!$checked.length) return;\r\n        if (confirm('')) $checked.remove();\r\n    }).end().find('[name=\"addUser\"]').keydown(function (e) {\r\n        if (e.keyCode === 13) {\r\n            e.preventDefault();\r\n            $(this).next().find('button').click();\r\n        }\r\n    }).end().find('[name=\"add\"]').click(function () {\r\n        let $addUser = $dialog.find('[name=\"addUser\"]');\r\n        for (let name of $.trim($addUser.val()).split(',')) {\r\n            name = $.trim(name);\r\n            if (!name) continue;\r\n            if (Util.inFollowOrBlockUserList(name, Config.followUserList) === -1) addFollowUser(name);\r\n        }\r\n        $addUser.val('');\r\n        $followUserList.find('li:last-child [type=\"checkbox\"]').focus();\r\n    }).end().find('[name=\"openImOrExFollowUserListDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        Public.showCommonImportOrExportConfigDialog('', 'followUserList');\r\n    }).end().find('[name=\"selectAll\"]').click(() => Util.selectAll($followUserList.find('[type=\"checkbox\"]')))\r\n        .end().find('[name=\"selectInverse\"]').click(() => Util.selectInverse($followUserList.find('[type=\"checkbox\"]')));\r\n\r\n    $followUserList.on('click', '[name=\"delete\"]', function () {\r\n        $(this).closest('li').remove();\r\n    });\r\n\r\n    $dialog.find('[name=\"highlightFollowUserThreadInHpEnabled\"]').prop('checked', Config.highlightFollowUserThreadInHPEnabled);\r\n    $dialog.find('[name=\"highlightFollowUserThreadLinkEnabled\"]').prop('checked', Config.highlightFollowUserThreadLinkEnabled);\r\n    for (let user of Config.followUserList) {\r\n        addFollowUser(user.name);\r\n    }\r\n    Dialog.show(dialogName);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst showBlockUserDialog = function () {\r\n    const dialogName = 'blockUserDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    let bodyContent = `\r\n<div class=\"form-group mb-2\">\r\n  <label for=\"blockUserDefaultType\"></label>\r\n  <select class=\"custom-select custom-select-sm w-auto\" id=\"blockUserDefaultType\" name=\"blockUserDefaultType\">\r\n    <option value=\"0\"></option><option value=\"1\"></option><option value=\"2\"></option>\r\n  </select>\r\n  <div class=\"form-check form-check-inline ml-3\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockUserAtTipsEnabled\" type=\"checkbox\"> @\r\n      <span class=\"tips\" data-toggle=\"tooltip\" title=\"@\">[?]</span>\r\n    </label>\r\n  </div>\r\n</div>\r\n<div class=\"form-group mb-2\">\r\n  <label for=\"blockUserForumType\"></label>\r\n  <select class=\"custom-select custom-select-sm w-auto\" id=\"blockUserForumType\" name=\"blockUserForumType\">\r\n    <option value=\"0\"></option><option value=\"1\"></option><option value=\"2\"></option>\r\n  </select>\r\n</div>\r\n<div class=\"form-group\">\r\n  <label>ID</label>\r\n  <span class=\"tips\" data-toggle=\"tooltip\" title=\"URLfidID\">[?]</span>\r\n  <input class=\"form-control form-control-sm\" name=\"blockUserFidList\" type=\"text\">\r\n</div>\r\n<ul class=\"list-unstyled\" id=\"blockUserList\"></ul>\r\n<div class=\"btn-group btn-group-sm mb-3\" role=\"group\">\r\n  <button class=\"btn btn-secondary\" name=\"selectAll\" type=\"button\"></button>\r\n  <button class=\"btn btn-secondary\" name=\"selectInverse\" type=\"button\"></button>\r\n  <div class=\"btn-group btn-group-sm dropup\">\r\n    <button class=\"btn btn-info dropdown-toggle\" data-toggle=\"dropdown\" type=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\r\n      \r\n    </button>\r\n    <div class=\"dropdown-menu\" data-name=\"modifyMenu\">\r\n      <a class=\"dropdown-item\" data-value=\"0\" href=\"#\"></a>\r\n      <a class=\"dropdown-item\" data-value=\"1\" href=\"#\"></a>\r\n      <a class=\"dropdown-item\" data-value=\"2\" href=\"#\"></a>\r\n    </div>\r\n  </div>\r\n  <button class=\"btn btn-danger\" name=\"deleteSelect\" type=\"button\"></button>\r\n</div>\r\n<div class=\"input-group mb-3\">\r\n  <input class=\"form-control\" name=\"addUser\" data-toggle=\"tooltip\" type=\"text\" title=\"\" aria-label=\"\">\r\n  <div class=\"input-group-append\">\r\n    <button class=\"btn btn-success\" name=\"add\" type=\"button\"></button>\r\n  </div>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImOrExBlockUserListDialog\" type=\"button\">/</button>\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n    let $blockUserList = $dialog.find('#blockUserList');\r\n\r\n    /**\r\n     * \r\n     * @param {string} name \r\n     * @param {number} type \r\n     */\r\n    const addBlockUser = function (name, type) {\r\n        $(`\r\n<li class=\"form-group row no-gutters mb-2\">\r\n  <div class=\"col-7 input-group input-group-sm\">\r\n    <div class=\"input-group-prepend\">\r\n      <div class=\"input-group-text\">\r\n        <input type=\"checkbox\" aria-label=\"\">\r\n      </div>\r\n    </div>\r\n    <input class=\"form-control\" name=\"userName\" type=\"text\" value=\"${name}\" maxlength=\"12\" aria-label=\"\">\r\n  </div>\r\n  <div class=\"col-5 input-group input-group-sm\">\r\n    <select class=\"form-control\" name=\"blockType\">\r\n      <option value=\"0\"></option><option value=\"1\"></option><option value=\"2\"></option>\r\n    </select>\r\n    <div class=\"input-group-append\">\r\n      <button class=\"btn btn-danger\" name=\"delete\" type=\"button\" aria-label=\"\">\r\n        <i class=\"fa fa-trash\" aria-hidden=\"true\"></i>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</li>\r\n`).appendTo($blockUserList).find('[name=\"blockType\"]').val(type);\r\n    };\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        Config.blockUserDefaultType = parseInt($dialog.find('[name=\"blockUserDefaultType\"]').val());\r\n        Config.blockUserAtTipsEnabled = $dialog.find('[name=\"blockUserAtTipsEnabled\"]').prop('checked');\r\n        Config.blockUserForumType = parseInt($dialog.find('[name=\"blockUserForumType\"]').val());\r\n        let blockUserFidList = new Set();\r\n        for (let fid of $.trim($dialog.find('[name=\"blockUserFidList\"]').val()).split(',')) {\r\n            fid = parseInt(fid);\r\n            if (!isNaN(fid) && fid > 0) blockUserFidList.add(fid);\r\n        }\r\n        Config.blockUserFidList = [...blockUserFidList];\r\n        Config.blockUserList = [];\r\n        $blockUserList.find('li').each(function () {\r\n            let $this = $(this);\r\n            let name = $.trim($this.find('[name=\"userName\"]').val());\r\n            if (name && Util.inFollowOrBlockUserList(name, Config.blockUserList) === -1) {\r\n                let type = parseInt($this.find('[name=\"blockType\"]').val());\r\n                Config.blockUserList.push({name, type});\r\n            }\r\n        });\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).find('[data-name=\"modifyMenu\"]').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let value = parseInt($(this).data('value'));\r\n        $blockUserList.find('li:has([type=\"checkbox\"]:checked) select').val(value);\r\n    }).end().find('[name=\"deleteSelect\"]').click(function () {\r\n        let $checked = $blockUserList.find('li:has([type=\"checkbox\"]:checked)');\r\n        if (!$checked.length) return;\r\n        if (confirm('')) $checked.remove();\r\n    }).end().find('[name=\"addUser\"]').keydown(function (e) {\r\n        if (e.keyCode === 13) {\r\n            e.preventDefault();\r\n            $(this).next().find('button').click();\r\n        }\r\n    }).end().find('[name=\"add\"]').click(function () {\r\n        let $addUser = $dialog.find('[name=\"addUser\"]');\r\n        let type = parseInt($dialog.find('[name=\"blockUserDefaultType\"]').val());\r\n        for (let name of $.trim($addUser.val()).split(',')) {\r\n            name = $.trim(name);\r\n            if (!name) continue;\r\n            if (Util.inFollowOrBlockUserList(name, Config.blockUserList) === -1) addBlockUser(name, type);\r\n        }\r\n        $addUser.val('');\r\n        $blockUserList.find('li:last-child [type=\"checkbox\"]').focus();\r\n    }).end().find('[name=\"blockUserForumType\"]').change(function () {\r\n        $dialog.find('[name=\"blockUserFidList\"]').prop('disabled', parseInt($(this).val()) === 0);\r\n    }).end().find('[name=\"openImOrExBlockUserListDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        Public.showCommonImportOrExportConfigDialog('', 'blockUserList');\r\n    }).end().find('[name=\"selectAll\"]').click(() => Util.selectAll($blockUserList.find('[type=\"checkbox\"]')))\r\n        .end().find('[name=\"selectInverse\"]').click(() => Util.selectInverse($blockUserList.find('[type=\"checkbox\"]')));\r\n\r\n    $blockUserList.on('click', '[name=\"delete\"]', function () {\r\n        $(this).closest('li').remove();\r\n    });\r\n\r\n    $dialog.find('[name=\"blockUserDefaultType\"]').val(Config.blockUserDefaultType);\r\n    $dialog.find('[name=\"blockUserAtTipsEnabled\"]').prop('checked', Config.blockUserAtTipsEnabled);\r\n    $dialog.find('[name=\"blockUserForumType\"]').val(Config.blockUserForumType).triggerHandler('change');\r\n    $dialog.find('[name=\"blockUserFidList\"]').val(Config.blockUserFidList.join(','));\r\n    for (let user of Config.blockUserList) {\r\n        addBlockUser(user.name, user.type);\r\n    }\r\n    Dialog.show(dialogName);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nconst showBlockThreadDialog = function () {\r\n    const dialogName = 'blockThreadDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\">\r\n  <code>/abc/</code><code>/A.*B/i</code><br>\r\n  IDID<br>\r\n</p>\r\n<div class=\"form-group mb-2\">\r\n  <label for=\"blockThreadDefForumType\"></label>\r\n  <select class=\"custom-select custom-select-sm w-auto\" id=\"blockThreadDefForumType\" name=\"blockThreadDefForumType\">\r\n    <option value=\"0\"></option><option value=\"1\"></option><option value=\"2\"></option>\r\n  </select>\r\n</div>\r\n<div class=\"form-group\">\r\n  <label for=\"blockThreadDefFidList\">ID</label>\r\n  <input class=\"form-control form-control-sm\" id=\"blockThreadDefFidList\" name=\"blockThreadDefFidList\" type=\"text\">\r\n</div>\r\n<div class=\"table-responsive\">\r\n  <table class=\"table table-sm table-hover table-center text-nowrap\">\r\n    <thead>\r\n      <tr>\r\n        <th>()</th>\r\n        <th></th>\r\n        <th></th>\r\n        <th></th>\r\n        <th>ID</th>\r\n        <th></th>\r\n      </tr>\r\n    </thead>\r\n    <tbody id=\"blockThreadList\"></tbody>\r\n  </table>\r\n</div>\r\n<div class=\"btn-group btn-group-sm mb-3\" role=\"group\">\r\n  <button class=\"btn btn-success\" name=\"add\" type=\"button\"></button>\r\n  <button class=\"btn btn-danger\" name=\"clear\" type=\"button\"></button>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImOrExBlockThreadListDialog\" type=\"button\">/</button>\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n    let $blockThreadList = $dialog.find('#blockThreadList');\r\n\r\n    /**\r\n     * \r\n     * @param {string} keyWord \r\n     * @param {number} userType 012\r\n     * @param {string[]} userList \r\n     * @param {number} fidType 012\r\n     * @param {number[]} fidList ID\r\n     */\r\n    const addBlockThread = function (keyWord, userType, userList, fidType, fidList) {\r\n        $(`\r\n<tr>\r\n  <td>\r\n    <input class=\"form-control form-control-sm\" name=\"keyWord\" type=\"text\" value=\"${keyWord}\" aria-label=\"\" style=\"min-width: 12rem;\">\r\n  </td>\r\n  <td>\r\n    <select class=\"form-control form-control-sm\" name=\"userType\" aria-label=\"\" style=\"min-width: 4.5rem;\">\r\n      <option value=\"0\"></option><option value=\"1\"></option><option value=\"2\"></option>\r\n    </select>\r\n  </td>\r\n  <td>\r\n    <input class=\"form-control form-control-sm\" name=\"userList\" type=\"text\" value=\"${userList.join(',')}\" aria-label=\"\"\r\n           ${userType === 0 ? 'disabled' : ''} style=\"min-width: 12rem;\">\r\n  </td>\r\n  <td>\r\n    <select class=\"form-control form-control-sm\" name=\"fidType\" aria-label=\"\" style=\"min-width: 4.5rem;\">\r\n      <option value=\"0\"></option><option value=\"1\"></option><option value=\"2\"></option>\r\n    </select>\r\n  </td>\r\n  <td>\r\n    <input class=\"form-control form-control-sm\" name=\"fidList\" type=\"text\" value=\"${fidList.join(',')}\" aria-label=\"ID\"\r\n           ${fidType === 0 ? 'disabled' : ''} style=\"min-width: 9rem;\">\r\n  </td>\r\n  <td class=\"text-left\">\r\n    <button class=\"btn btn-danger btn-sm\" name=\"delete\" type=\"button\" aria-label=\"\">\r\n      <i class=\"fa fa-trash\" aria-hidden=\"true\"></i>\r\n    </button>\r\n  </td>\r\n</tr>\r\n`).appendTo($blockThreadList).find('[name=\"userType\"]').val(userType)\r\n            .end().find('[name=\"fidType\"]').val(fidType);\r\n    };\r\n\r\n    /**\r\n     * \r\n     * @returns {boolean} \r\n     */\r\n    const verify = function () {\r\n        let flag = true;\r\n        $blockThreadList.find('tr').each(function () {\r\n            let $this = $(this);\r\n            let $txtKeyWord = $this.find('[name=\"keyWord\"]');\r\n            let keyWord = $txtKeyWord.val();\r\n            if (!$.trim(keyWord)) return;\r\n            if (/^\\/.+\\/[gimuy]*$/.test(keyWord)) {\r\n                try {\r\n                    eval(keyWord);\r\n                }\r\n                catch (ex) {\r\n                    alert('');\r\n                    $txtKeyWord.select().focus();\r\n                    flag = false;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n        return flag;\r\n    };\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        if (!verify()) return;\r\n        Config.blockThreadDefForumType = parseInt($dialog.find('[name=\"blockThreadDefForumType\"]').val());\r\n        let blockThreadDefFidList = new Set();\r\n        for (let fid of $.trim($dialog.find('[name=\"blockThreadDefFidList\"]').val()).split(',')) {\r\n            fid = parseInt(fid);\r\n            if (!isNaN(fid) && fid > 0) blockThreadDefFidList.add(fid);\r\n        }\r\n        Config.blockThreadDefFidList = [...blockThreadDefFidList];\r\n        Config.blockThreadList = [];\r\n        $blockThreadList.find('tr').each(function () {\r\n            let $this = $(this);\r\n            let keyWord = $this.find('[name=\"keyWord\"]').val();\r\n            if (!$.trim(keyWord)) return;\r\n            let newObj = {keyWord};\r\n\r\n            let userType = parseInt($this.find('[name=\"userType\"]').val());\r\n            if (userType > 0) {\r\n                let userList = new Set();\r\n                for (let user of $.trim($this.find('[name=\"userList\"]').val()).split(',')) {\r\n                    user = $.trim(user);\r\n                    if (user) userList.add(user);\r\n                }\r\n                if (userList.size > 0) newObj[userType === 2 ? 'excludeUser' : 'includeUser'] = [...userList];\r\n            }\r\n\r\n            let fidType = parseInt($this.find('[name=\"fidType\"]').val());\r\n            if (fidType > 0) {\r\n                let fidList = new Set();\r\n                for (let fid of $.trim($this.find('[name=\"fidList\"]').val()).split(',')) {\r\n                    fid = parseInt(fid);\r\n                    if (!isNaN(fid) && fid > 0) fidList.add(fid);\r\n                }\r\n                if (fidList.size > 0) newObj[fidType === 2 ? 'excludeFid' : 'includeFid'] = [...fidList];\r\n            }\r\n            Config.blockThreadList.push(newObj);\r\n        });\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).find('[name=\"clear\"]').click(function () {\r\n        if (confirm('')) $blockThreadList.html('');\r\n    }).end().find('[name=\"add\"]').click(function () {\r\n        addBlockThread(\r\n            '', 0, [],\r\n            parseInt($dialog.find('[name=\"blockThreadDefForumType\"]').val()),\r\n            $.trim($dialog.find('[name=\"blockThreadDefFidList\"]').val()).split(',')\r\n        );\r\n    }).end().find('[name=\"blockThreadDefForumType\"]').change(function () {\r\n        $dialog.find('[name=\"blockThreadDefFidList\"]').prop('disabled', parseInt($(this).val()) === 0);\r\n    }).end().find('[name=\"openImOrExBlockThreadListDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        Public.showCommonImportOrExportConfigDialog('', 'blockThreadList');\r\n    }).end().find('[name=\"selectAll\"]').click(() => Util.selectAll($blockThreadList.find('[type=\"checkbox\"]')))\r\n        .end().find('[name=\"selectInverse\"]').click(() => Util.selectInverse($blockThreadList.find('[type=\"checkbox\"]')));\r\n\r\n    $blockThreadList.on('change', 'select', function () {\r\n        let $this = $(this);\r\n        $this.closest('td').next('td').find('input').prop('disabled', parseInt($this.val()) === 0);\r\n    }).on('click', '[name=\"delete\"]', function () {\r\n        $(this).closest('tr').remove();\r\n    });\r\n\r\n    $dialog.find('[name=\"blockThreadDefForumType\"]').val(Config.blockThreadDefForumType).triggerHandler('change');\r\n    $dialog.find('[name=\"blockThreadDefFidList\"]').val(Config.blockThreadDefFidList.join(','));\r\n    for (let data of Config.blockThreadList) {\r\n        let {keyWord, includeUser, excludeUser, includeFid, excludeFid} = data;\r\n        let userType = 0;\r\n        let userList = [];\r\n        if (typeof includeUser !== 'undefined') {\r\n            userType = 1;\r\n            userList = includeUser;\r\n        }\r\n        else if (typeof excludeUser !== 'undefined') {\r\n            userType = 2;\r\n            userList = excludeUser;\r\n        }\r\n\r\n        let fidType = 0;\r\n        let fidList = [];\r\n        if (typeof includeFid !== 'undefined') {\r\n            fidType = 1;\r\n            fidList = includeFid;\r\n        }\r\n        else if (typeof excludeFid !== 'undefined') {\r\n            fidType = 2;\r\n            fidList = excludeFid;\r\n        }\r\n        addBlockThread(keyWord, userType, userList, fidType, fidList);\r\n    }\r\n    Dialog.show(dialogName);\r\n};\r\n","/*  */\r\n'use strict';\r\n\r\n// \r\nconst storagePrefix = 'kf_';\r\n\r\n/**\r\n * \r\n */\r\nconst Const = {\r\n    // atCookie\r\n    atTipsTimeExpires: 3,\r\n    // Cookie\r\n    bgStyleExpires: 365,\r\n\r\n    // \r\n    storagePrefix: storagePrefix,\r\n    // LocalStorage\r\n    multiQuoteStorageName: storagePrefix + 'multiQuote',\r\n    // atCookie\r\n    atTipsTimeCookieName: 'atTipsTime',\r\n    // atCookie\r\n    prevAtTipsTimeCookieName: 'prevAtTipsTime',\r\n    // Cookie\r\n    bgStyleCookieName: 'bgStyle',\r\n\r\n    // \r\n    commonForumList: [\r\n        {fid: 106, name: ''},\r\n        {fid: 41, name: ''},\r\n        {fid: 16, name: 'BT'},\r\n        {fid: 52, name: ''},\r\n        {fid: 84, name: ''},\r\n        {fid: 67, name: 'CG'},\r\n        {fid: 5, name: ''},\r\n        {fid: 56, name: ''},\r\n        {fid: 57, name: ''},\r\n    ],\r\n    // \r\n    availableForumList: [\r\n        {fid: 106, name: ''},\r\n        {fid: 52, name: ''},\r\n        {fid: 41, name: ''},\r\n        {fid: 67, name: 'CG'},\r\n        {fid: 16, name: 'BT'},\r\n        {fid: 9, name: ''},\r\n        {fid: 102, name: ''},\r\n        {fid: 24, name: ''},\r\n        {fid: 57, name: ''},\r\n        {fid: 84, name: ''},\r\n        {fid: 92, name: ''},\r\n        {fid: 127, name: ''},\r\n        {fid: 68, name: 'ACG'},\r\n        {fid: 163, name: 'LIVE'},\r\n        {fid: 94, name: ''},\r\n        {fid: 87, name: ''},\r\n        {fid: 86, name: ''},\r\n        {fid: 115, name: ''},\r\n        {fid: 96, name: ''},\r\n        {fid: 36, name: ''},\r\n        {fid: 5, name: ''},\r\n        {fid: 56, name: ''},\r\n        {fid: 4, name: ''},\r\n        {fid: 93, name: ''},\r\n        {fid: 59, name: ''},\r\n        {fid: 125, name: ''},\r\n        {fid: 181, name: ''},\r\n        {fid: 98, name: ''},\r\n        {fid: 99, name: ''},\r\n        {fid: 112, name: ''},\r\n        {fid: 100, name: ''},\r\n    ],\r\n};\r\n\r\nexport default Const;\r\n","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\n\r\n/**\r\n * \r\n * @param {string} id ID\r\n * @param {string} title \r\n * @param {string} bodyContent \r\n * @param {string} footerContent \r\n * @returns {jQuery} jQuery\r\n */\r\nexport const create = function (id, title, bodyContent, footerContent = '') {\r\n    let html = `\r\n<form>\r\n<div class=\"dialog\" id=\"${id}\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\" aria-labelledby=\"${id}Title\">\r\n  <div class=\"container dialog-content\" role=\"document\">\r\n    <div class=\"dialog-header\">\r\n      <h5 class=\"dialog-title\" id=\"${id}Title\">${title}</h5>\r\n      <button class=\"close\" data-dismiss=\"dialog\" type=\"button\" aria-label=\"\">\r\n        <span aria-hidden=\"true\">&times;</span>\r\n      </button>\r\n    </div>\r\n    <div class=\"dialog-body\">${bodyContent}</div>\r\n    <div class=\"dialog-footer\" ${!footerContent ? 'hidden' : ''}>${footerContent}</div>\r\n  </div>\r\n</div>\r\n</form>`;\r\n    let $dialog = $(html).appendTo('body');\r\n    $dialog.on('click', '[data-dismiss=\"dialog\"]', () => close(id))\r\n        .on('click', '.tips', () => false)\r\n        .on('click', '.disabled-link', () => false)\r\n        .keydown(function (e) {\r\n            if (e.keyCode === 27) {\r\n                return close(id);\r\n            }\r\n        })\r\n        .find('legend [type=\"checkbox\"]')\r\n        .click(function () {\r\n            let $this = $(this);\r\n            let checked = $this.prop('checked');\r\n            if (Util.isOpera() || Util.isEdge())\r\n                $this.closest('fieldset').find('input, select, textarea, button').not('legend input').prop('disabled', !checked);\r\n            else $this.closest('fieldset').prop('disabled', !checked);\r\n        }).end()\r\n        .find('input[data-disabled]')\r\n        .click(function () {\r\n            let $this = $(this);\r\n            let checked = $this.prop('checked');\r\n            $($this.data('disabled')).each(function () {\r\n                let $this = $(this);\r\n                if ($this.is('a')) {\r\n                    if (checked) $this.removeClass('disabled-link');\r\n                    else $this.addClass('disabled-link');\r\n                }\r\n                else {\r\n                    $this.prop('disabled', !checked);\r\n                }\r\n            });\r\n        }).end().find('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    $(window).on('resize.' + id, () => resize(id));\r\n    return $dialog;\r\n};\r\n\r\n/**\r\n * \r\n * @param {string} id ID\r\n */\r\nexport const show = function (id) {\r\n    let $dialog = $('#' + id);\r\n    if (!$dialog.length) return;\r\n    $dialog.find('legend [type=\"checkbox\"]')\r\n        .each(function () {\r\n            $(this).triggerHandler('click');\r\n        }).end().find('input[data-disabled]')\r\n        .each(function () {\r\n            $(this).triggerHandler('click');\r\n        });\r\n    $dialog.fadeIn('normal').find('.close:first').focus();\r\n    resize(id);\r\n};\r\n\r\n/**\r\n * \r\n * @param {string} id ID\r\n */\r\nexport const resize = function (id) {\r\n    let $dialog = $('#' + id);\r\n    $dialog.find('.dialog-body')\r\n        .css('max-height', $(window).height() - $dialog.find('.dialog-header').outerHeight() - $dialog.find('.dialog-footer').outerHeight());\r\n};\r\n\r\n/**\r\n * \r\n * @param {string} id ID\r\n * @returns {boolean} false\r\n */\r\nexport const close = function (id) {\r\n    $('#' + id).fadeOut('normal', function () {\r\n        $(this).parent().remove();\r\n    });\r\n    $(window).off('resize.' + id);\r\n    return false;\r\n};\r\n","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * @\r\n */\r\nexport const handleAtTipsBtn = function () {\r\n    $('#atTips').click(function () {\r\n        let $this = $(this);\r\n        let time = $this.data('time');\r\n        let cookieValue = Util.getCookie(Const.atTipsTimeCookieName);\r\n        if (!time || time === cookieValue) return;\r\n        if (!cookieValue) {\r\n            let curDate = new Date().getDate().toString();\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, curDate.padStart(2, '0') + '0000');\r\n        }\r\n        else if (cookieValue !== time) {\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, cookieValue);\r\n        }\r\n        Util.setCookie(Const.atTipsTimeCookieName, time, Util.getDate(`+${Const.atTipsTimeExpires}d`));\r\n        $this.removeClass('btn-outline-danger').addClass('btn-outline-primary');\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleIndexThreadPanel = function () {\r\n    if (Config.activeNewReplyPanel) $(`a[data-toggle=\"tab\"][href=\"${Config.activeNewReplyPanel}\"]`).tab('show');\r\n    if (Config.activeTopRecommendPanel) $(`a[data-toggle=\"tab\"][href=\"${Config.activeTopRecommendPanel}\"]`).tab('show');\r\n\r\n    $(document).on('shown.bs.tab', '[data-toggle=\"tab\"]', function (e) {\r\n        let $target = $(e.target);\r\n        let targetPanel = $target.attr('href');\r\n        let typeName = '';\r\n        if (targetPanel.includes('NewReplyPanel')) typeName = 'activeNewReplyPanel';\r\n        else if (targetPanel.includes('TopRecommendPanel')) typeName = 'activeTopRecommendPanel';\r\n        if (typeName && Config[typeName] !== targetPanel) {\r\n            readConfig();\r\n            Config[typeName] = targetPanel;\r\n            writeConfig();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleSelectBg = function () {\r\n    $('#selectBgImage').on('click', '[data-id]', function () {\r\n        let $this = $(this);\r\n        let id = $this.data('id');\r\n        let fileName = $this.data('filename');\r\n        let path = $this.parent().data('path');\r\n        if (!id || !fileName || !path) return;\r\n        if (confirm('')) {\r\n            Util.setCookie(Const.bgStyleCookieName, id, Util.getDate(`+${Const.bgStyleExpires}d`), Const.storagePrefix);\r\n            $('body, .modal-content').css('background-image', 'url(\"' + path + fileName + '\")');\r\n            alert('');\r\n        }\r\n    }).on('click', '[data-color]', function () {\r\n        let $this = $(this);\r\n        let color = $this.data('color');\r\n        if (!color) return;\r\n        if (confirm('')) {\r\n            Util.setCookie(Const.bgStyleCookieName, color, Util.getDate(`+${Const.bgStyleExpires}d`), Const.storagePrefix);\r\n            $('body, .modal-content').css('background', color);\r\n            alert('');\r\n        }\r\n    });\r\n\r\n    $('#customBgStyle').click(function () {\r\n        let value = Util.getCookie(Const.bgStyleCookieName, Const.storagePrefix);\r\n        if (!value || parseInt(value)) value = '';\r\n        value = prompt(\r\n            'URLCSS\\nhttp://xxx.com/abc.jpg  #fcfcfc\\n' +\r\n            '',\r\n            value\r\n        );\r\n        if (value === null) return;\r\n        let $bg = $('body, .modal-content, .dialog-content');\r\n        if ($.trim(value) === '') {\r\n            Util.deleteCookie(Const.bgStyleCookieName, Const.storagePrefix);\r\n            alert('');\r\n            location.reload();\r\n        }\r\n        else if (/^https?:\\/\\/[^\"']+/.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate(`+${Const.bgStyleExpires}d`), Const.storagePrefix);\r\n            $bg.css('background-image', 'url(\"' + value + '\")');\r\n            alert('');\r\n        }\r\n        else if (/^#[0-9a-f]{6}$/i.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate(`+${Const.bgStyleExpires}d`), Const.storagePrefix);\r\n            $bg.css('background', value.toLowerCase());\r\n            alert('');\r\n        }\r\n        else if (!/[<>{}]/.test(value)) {\r\n            value = value.replace(';', '');\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate(`+${Const.bgStyleExpires}d`), Const.storagePrefix);\r\n            $bg.css('background', value);\r\n            alert('');\r\n        }\r\n        else {\r\n            alert('');\r\n        }\r\n    });\r\n};\r\n","/*  */\r\n'use strict';\r\n\r\n/**\r\n * \r\n * @param {string|Object} options \r\n * @param {string} [options.msg] \r\n * @param {number} [options.duration={@link Config.defShowMsgDuration}] -1\r\n * @param {boolean} [options.clickable=true] \r\n * @param {boolean} [options.preventable=false] \r\n * @param {number} [duration] -1\r\n * @example\r\n * show('<span class=\"mr-3\"></span><span class=\"text-item\"><em class=\"text-warning\">+1</em></span>', -1);\r\n * show({\r\n *   msg: '<span class=\"mr-3\"></span><span class=\"text-item\">KFB<em class=\"text-warning\">+8</em></span>',\r\n *   duration: 20,\r\n *   clickable: false,\r\n * });\r\n * @returns {jQuery} \r\n */\r\nexport const show = function (options, duration) {\r\n    let settings = {\r\n        msg: '',\r\n        duration: Config.defShowMsgDuration,\r\n        clickable: true,\r\n        preventable: false,\r\n    };\r\n    if ($.type(options) === 'object') {\r\n        $.extend(settings, options);\r\n    }\r\n    else {\r\n        settings.msg = options;\r\n        settings.duration = typeof duration === 'undefined' ? Config.defShowMsgDuration : duration;\r\n    }\r\n\r\n    let $container = $('.msg-container');\r\n    let isFirst = $container.length === 0;\r\n    if (!isFirst && !$('.mask').length) {\r\n        if ($container.height() >= $(window).height() * 0.8) {\r\n            destroy();\r\n            isFirst = true;\r\n        }\r\n    }\r\n    if (settings.preventable && !$('.mask').length) {\r\n        $('<div class=\"mask\"></div>').appendTo('body');\r\n    }\r\n    if (isFirst) {\r\n        $container = $('<div class=\"container msg-container\"></div>').appendTo('body');\r\n    }\r\n\r\n    let $msg = $(`<div class=\"msg\">${settings.msg}</div>`).appendTo($container);\r\n    $msg.on('click', '.stop-action', function (e) {\r\n        e.preventDefault();\r\n        $(this).text('&hellip;').closest('.msg').data('stop', true);\r\n    });\r\n    if (settings.clickable) {\r\n        $msg.css('cursor', 'pointer').click(function () {\r\n            hide($(this));\r\n        }).find('a').click(function (e) {\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n    if (settings.preventable) $msg.attr('preventable', true);\r\n    $msg.slideDown('normal');\r\n    if (settings.duration > -1) {\r\n        setTimeout(() => {\r\n            hide($msg);\r\n        }, settings.duration * 1000);\r\n    }\r\n    return $msg;\r\n};\r\n\r\n/**\r\n * \r\n * @param {string} msg \r\n * @param {boolean} preventable \r\n * @returns {jQuery} \r\n */\r\nexport const wait = function (msg, preventable = true) {\r\n    msg += '<i class=\"fa fa-spinner fa-spin fa-lg fa-fw ml-3\" aria-label=\"\" aria-hidden=\"true\"></i>';\r\n    return show({msg, duration: -1, clickable: false, preventable});\r\n};\r\n\r\n/**\r\n * \r\n * @param {jQuery} $msg \r\n */\r\nexport const hide = function ($msg) {\r\n    $msg.slideUp('normal', function () {\r\n        remove($(this));\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n * @param {jQuery} $msg \r\n */\r\nexport const remove = function ($msg) {\r\n    let $container = $msg.parent();\r\n    $msg.remove();\r\n    if (!$('.msg').length) {\r\n        $container.remove();\r\n        $('.mask').remove();\r\n    }\r\n    else if (!$('.msg[preventable]').length) {\r\n        $('.mask').remove();\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const destroy = function () {\r\n    $('.msg-container').remove();\r\n    $('.mask').remove();\r\n};\r\n","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * \r\n */\r\nexport const highlightUnReadAtTipsMsg = function () {\r\n    if (Info.gjc !== Info.userName) return;\r\n    let timeString = Util.getCookie(Const.prevAtTipsTimeCookieName);\r\n    if (!timeString || !/^\\d+\\d+\\d+$/.test(timeString)) return;\r\n    let prevString = '';\r\n    $('.thread-list-item time').each(function (index) {\r\n        let $this = $(this);\r\n        let curString = $.trim($this.text());\r\n        if (index === 0) prevString = curString;\r\n        if (timeString < curString && prevString >= curString) {\r\n            $this.addClass('text-danger');\r\n            prevString = curString;\r\n        }\r\n        else return false;\r\n    });\r\n\r\n    $(document).on('click', '.thread-list-item .thread-link-item a', function () {\r\n        Util.deleteCookie(Const.prevAtTipsTimeCookieName);\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleGameIntroSearchArea = function () {\r\n    $('#gameSearchKeyword').val(Info.keyword);\r\n    $('#gameSearchType').val(Info.searchType);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const tuiGame = function () {\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n\r\n        let type = $this.data('type');\r\n        let cookieName = '';\r\n        if (type === 'company') cookieName = 'g_intro_inc_tui_';\r\n        else if (type === 'type') cookieName = 'g_intro_adv_tui_';\r\n        else if (type === 'property') cookieName = 'g_intro_moe_tui_';\r\n        else cookieName = 'g_intro_tui_';\r\n        cookieName += Info.id;\r\n        if (Util.getCookie(cookieName, '')) {\r\n            alert('48');\r\n            return;\r\n        }\r\n\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: $this.data('url'),\r\n            success: function () {\r\n                let $num = $this.find('span:first');\r\n                let num = parseInt($num.text());\r\n                $num.text('+1');\r\n                setTimeout(() => {\r\n                    $num.text(++num);\r\n                }, 1000);\r\n            },\r\n            error: function () {\r\n                alert('');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const bindFavorPageBtnsClick = function () {\r\n    let $form = $('form[name=\"favorForm\"]');\r\n\r\n    $(document).on('click', '.remove-catalog', () => confirm(''));\r\n\r\n    $('#addCatalog').click(function (e) {\r\n        e.preventDefault();\r\n        let type = $.trim(prompt(''));\r\n        if (!type) return;\r\n        $form.find('[name=\"job\"]').val('addtype');\r\n        $form.find('[name=\"type\"]').val(type);\r\n        $form.submit();\r\n    });\r\n\r\n    $('#favorActionBtns').on('click', 'button', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectInverse') {\r\n            Util.selectInverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`${$checked.length}`)) {\r\n                $form.find('[name=\"job\"]').val('clear');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n\r\n    $('#convertCatalogDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let type = $(this).data('type');\r\n        let $checked = $('[name=\"delid[]\"]:checked');\r\n        if ($checked.length > 0 && confirm(`${$checked.length}`)) {\r\n            $form.find('[name=\"job\"]').val('change');\r\n            $form.find('[name=\"type\"]').val(type);\r\n            $form.submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const bindFriendPageBtnsClick = function () {\r\n    $('#friendActionBtns').on('click', '[type=\"button\"]', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"selid[]\"]'));\r\n        }\r\n        else if (action === 'selectInverse') {\r\n            Util.selectInverse($('[name=\"selid[]\"]'));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const assignBirthdayField = function () {\r\n    $('#birthday').change(function () {\r\n        let value = $(this).val().trim();\r\n        let matches = /(\\d{4})-(\\d{1,2})-(\\d{1,2})/.exec(value);\r\n        let year = '', month = '', day = '';\r\n        if (matches) {\r\n            year = parseInt(matches[1]);\r\n            month = parseInt(matches[2]);\r\n            day = parseInt(matches[3]);\r\n        }\r\n        $('[name=\"proyear\"]').val(year);\r\n        $('[name=\"promonth\"]').val(month);\r\n        $('[name=\"proday\"]').val(day);\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const syncPerPageFloorNum = function () {\r\n    /**\r\n     * \r\n     */\r\n    const syncConfig = function () {\r\n        let perPageFloorNum = parseInt($('[name=\"p_num\"]').val());\r\n        if (perPageFloorNum === 0) perPageFloorNum = 10;\r\n        if (!isNaN(perPageFloorNum) && perPageFloorNum !== Config.perPageFloorNum) {\r\n            Config.perPageFloorNum = perPageFloorNum;\r\n            writeConfig();\r\n        }\r\n    };\r\n\r\n    syncConfig();\r\n    $('#creator').submit(function () {\r\n        readConfig();\r\n        syncConfig();\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleUploadAvatarFileBtn = function () {\r\n    $('#browseAvatar').change(function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png'].includes(matches[1].toLowerCase())) {\r\n            alert('');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const bindMessageActionBtnsClick = function () {\r\n    $('#messageActionBtns').on('click', 'button', function () {\r\n        let $form = $('#messageListForm');\r\n        let name = $(this).attr('name');\r\n        if (name === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (name === 'selectInverse') {\r\n            Util.selectInverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (name === 'selectCustom') {\r\n            let title = $.trim(\r\n                prompt('|', '|KFB|||')\r\n            );\r\n            if (!title) return;\r\n            $('[name=\"delid[]\"]').prop('checked', false);\r\n            $('a.thread-link').each(function () {\r\n                let $this = $(this);\r\n                for (let key of title.split('|')) {\r\n                    if ($this.text().toLowerCase().includes(key.toLowerCase())) {\r\n                        $this.parent().find('[name=\"delid[]\"]').prop('checked', true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else if (name === 'download') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`${$checked.length}`)) {\r\n                $form.attr('action', '/message.php').find('[name=\"action\"]').val('down');\r\n                $form.submit();\r\n            }\r\n        }\r\n        else if (name === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`${$checked.length}`)) {\r\n                $form.attr('action', Util.makeUrl('message/job')).find('[name=\"action\"]').val('del');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleRegisterPage = function () {\r\n    $(document).on('change', 'input[name]', function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        let value = $this.val();\r\n        if (!value) {\r\n            Util.showValidationMsg($this, 'clear');\r\n            return;\r\n        }\r\n        Util.showValidationMsg($('#response'), 'clear');\r\n        if (name === 'regpwd') {\r\n            if (value.length > 16 || value.length < 6) {\r\n                Util.showValidationMsg($this, 'error', '');\r\n            }\r\n            else {\r\n                Util.showValidationMsg($this, 'clear');\r\n                $('[name=\"regpwdrepeat\"]').trigger('change');\r\n            }\r\n        }\r\n        else if (name === 'regpwdrepeat') {\r\n            if (value !== $('[name=\"regpwd\"]').val()) Util.showValidationMsg($this, 'error', '');\r\n            else Util.showValidationMsg($this, 'clear');\r\n        }\r\n    });\r\n\r\n    $('#registerBtn').click(function () {\r\n        let $this = $(this);\r\n        let $form = $this.closest('form');\r\n        if ($form.find('.has-danger').length > 0) {\r\n            alert('');\r\n            return false;\r\n        }\r\n\r\n        let action = $this.data('action');\r\n        if (action === 'check') {\r\n            if (typeof window.namecheck !== 'function') return;\r\n            if (!window.namecheck()) return;\r\n            let $response = $('#response');\r\n            $this.prop('disabled', true);\r\n            Util.showValidationMsg($response, 'wait', '&hellip;');\r\n            $.post(Util.makeUrl('register/check'), $('[name=\"checkForm\"]').serialize(), ({type, msg}) => {\r\n                $this.prop('disabled', false);\r\n                Util.showValidationMsg($response, type, msg);\r\n                if (type === 'success') $this.data('action', 'register').find('span:last-child').text('');\r\n            }).fail(() => {\r\n                Util.showValidationMsg($response, 'error', '');\r\n            });\r\n        }\r\n        else {\r\n            $form.submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleUserPageBtns = function () {\r\n    let $area = $('#profileBtns');\r\n    let userName = $area.data('username');\r\n    $area.on('click', '[name=\"followUser\"], [name=\"blockUser\"]', function () {\r\n        readConfig();\r\n        let $this = $(this);\r\n        let str = '';\r\n        let userList = Config.followUserList;\r\n        if ($this.attr('name') === 'blockUser') {\r\n            str = '';\r\n            userList = Config.blockUserList;\r\n            Config.blockUserEnabled = true;\r\n        }\r\n        else Config.followUserEnabled = true;\r\n        if ($this.text().includes('')) {\r\n            let index = Util.inFollowOrBlockUserList(userName, userList);\r\n            if (index > -1) {\r\n                userList.splice(index, 1);\r\n                writeConfig();\r\n            }\r\n            $this.removeClass('btn-outline-danger').addClass('btn-outline-primary').find('span').text(str + '');\r\n            alert('' + str);\r\n        }\r\n        else {\r\n            if (Util.inFollowOrBlockUserList(userName, userList) === -1) {\r\n                if (str === '') {\r\n                    let type = Config.blockUserDefaultType;\r\n                    type = prompt('012', type);\r\n                    if (type === null) return;\r\n                    type = parseInt(type);\r\n                    if (isNaN(type) || type < 0 || type > 2) type = Config.blockUserDefaultType;\r\n                    userList.push({name: userName, type: type});\r\n                }\r\n                else {\r\n                    userList.push({name: userName});\r\n                }\r\n                writeConfig();\r\n            }\r\n            $this.removeClass('btn-outline-primary').addClass('btn-outline-danger').find('span').text('' + str);\r\n            alert('' + str);\r\n        }\r\n    }).find('[name=\"followUser\"], [name=\"blockUser\"]').each(function () {\r\n        let $this = $(this);\r\n        let str = '';\r\n        let userList = Config.followUserList;\r\n        if ($this.attr('name') === 'blockUser') {\r\n            str = '';\r\n            userList = Config.blockUserList;\r\n        }\r\n        if (Util.inFollowOrBlockUserList(userName, userList) > -1) {\r\n            $this.removeClass('btn-outline-primary').addClass('btn-outline-danger').find('span').text('' + str);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleProfilePage = function () {\r\n    let $registerDate = $('#registerDate');\r\n    let matches = /(\\d{4})-(\\d{2})-(\\d{2})/.exec($registerDate.text());\r\n    if (matches) {\r\n        let now = new Date();\r\n        let [, year, month, day] = matches;\r\n        if (parseInt(month) === now.getMonth() + 1 && parseInt(day) === now.getDate() && parseInt(year) <= now.getFullYear()) {\r\n            $registerDate.attr('title', `${now.getFullYear() - parseInt(year)}`).addClass('text-danger help');\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const showSelfRateErrorSizeSubmitWarning = function () {\r\n    $('form[name=\"selfRate\"]').submit(function () {\r\n        let $this = $(this);\r\n        let ratingSize = parseFloat($this.find('[name=\"psize\"]').val());\r\n        if (isNaN(ratingSize) || ratingSize <= 0) return;\r\n        if (parseInt($this.find('[name=\"psizegb\"]').val()) === 2) ratingSize *= 1024;\r\n        let titleSize = parseInt($this.find('a[data-title-size]').data('title-size'));\r\n        if (titleSize && (titleSize > ratingSize * (100 + 3) / 100 + 1 || titleSize < ratingSize * (100 - 3) / 100 - 1)) {\r\n            return confirm(`(${titleSize.toLocaleString()}M)(${ratingSize.toLocaleString()}M)`);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * KFB\r\n */\r\nexport const showMyInfoInItemShop = function () {\r\n    $.get(`/profile.php?action=show&uid=${Info.uid}&t=${$.now()}`, function (html) {\r\n        let kfbMatches = /(\\d+)\\s*KFB/.exec(html);\r\n        let gxMatches = /(\\d+(?:\\.\\d+)?)/.exec(html);\r\n        if (!kfbMatches && !gxMatches) return;\r\n        let kfb = parseInt(kfbMatches[1]);\r\n        let gx = parseFloat(gxMatches[1]);\r\n        $('#myInfo').html(` <b>${kfb.toLocaleString()}</b> KFB  <b>${gx}</b> `);\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleBuyItemBtns = function () {\r\n    $('#itemList').on('click', 'button[name=\"buy\"]', function () {\r\n        let $this = $(this);\r\n        let itemId = $this.data('id');\r\n        if (!confirm('')) return;\r\n        $this.prop('disabled', true);\r\n        $.post('/kf_fw_ig_shop.php', `buy=${itemId}&safeid=${Info.safeId}`).done(function (html) {\r\n            let msg = Util.removeHtmlTag(html);\r\n            alert(msg);\r\n        }).fail(() => alert('')).always(() => $this.prop('disabled', false));\r\n    });\r\n};","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport * as Msg from './msg';\r\n\r\n/**\r\n * \r\n */\r\nexport const handleEditorBtns = function () {\r\n    let textArea = $('#postContent').get(0);\r\n\r\n    // \r\n    $(document).on('click', '.editor-btn-group button[data-action]', function () {\r\n        let action = $(this).data('action');\r\n        let value = '';\r\n        switch (action) {\r\n            case 'link':\r\n                value = prompt('URL', 'http://');\r\n                break;\r\n            case 'img':\r\n                value = prompt('URL', 'http://');\r\n                break;\r\n            case 'sell':\r\n                value = prompt('', 1);\r\n                break;\r\n            case 'hide':\r\n                value = prompt('', 1);\r\n                break;\r\n            case 'audio': {\r\n                value = prompt('HTML5\\n', 'http://');\r\n                let matches = /^https?:\\/\\/music\\.163\\.com\\/(?:#\\/)?song\\?id=(\\d+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/163/${matches[1]}.mp3`;\r\n                matches = /^https?:\\/\\/www\\.xiami\\.com\\/song\\/(\\w+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/xiami/${matches[1]}.mp3`;\r\n            }\r\n                break;\r\n            case 'video': {\r\n                value = prompt('HTML5\\nYouTube', 'http://');\r\n                let matches = /^https?:\\/\\/(?:www\\.)?youtube\\.com\\/watch\\?v=([\\w\\-]+)/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n                matches = /^https?:\\/\\/youtu\\.be\\/([\\w\\-]+)$/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n            }\r\n                break;\r\n        }\r\n        if (value === null) return;\r\n\r\n        let selText = '';\r\n        let code = '';\r\n        switch (action) {\r\n            case 'link':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[url=${value}]${selText}[/url]`;\r\n                break;\r\n            case 'img':\r\n                code = `[img]${value}[/img]`;\r\n                break;\r\n            case 'quote':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[quote]${selText}[/quote]`;\r\n                break;\r\n            case 'code':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[code]${selText}[/code]`;\r\n                break;\r\n            case 'sell':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sell=${value}]${selText}[/sell]`;\r\n                break;\r\n            case 'hide':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[hide=${value}]${selText}[/hide]`;\r\n                break;\r\n            case 'bold':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[b]${selText}[/b]`;\r\n                break;\r\n            case 'italic':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[i]${selText}[/i]`;\r\n                break;\r\n            case 'underline':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[u]${selText}[/u]`;\r\n                break;\r\n            case 'strike':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[strike]${selText}[/strike]`;\r\n                break;\r\n            case 'super':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sup]${selText}[/sup]`;\r\n                break;\r\n            case 'sub':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sub]${selText}[/sub]`;\r\n                break;\r\n            case 'horizontal':\r\n                code = `[hr]`;\r\n                break;\r\n            case 'align-left':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=left]${selText}[/align]`;\r\n                break;\r\n            case 'align-center':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=center]${selText}[/align]`;\r\n                break;\r\n            case 'align-right':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=right]${selText}[/align]`;\r\n                break;\r\n            case 'fly':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[fly]${selText}[/fly]`;\r\n                break;\r\n            case 'audio':\r\n                code = `[audio]${value}[/audio]`;\r\n                break;\r\n            case 'video':\r\n                code = `[video]${value}[/video]`;\r\n                break;\r\n        }\r\n        if (!code) return;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // \r\n    $('#fontSizeDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let size = $(this).data('size');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[size=${size}]${selText}[/size]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // \r\n    $('#colorDropdownMenu, #bgColorDropdownMenu').on('click', 'span', function () {\r\n        let $this = $(this);\r\n        let codeType = $this.parent().is('#bgColorDropdownMenu') ? 'backcolor' : 'color';\r\n        let color = $this.data('color');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[${codeType}=${color}]${selText}[/${codeType}]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const checkPostForm = function () {\r\n    $('#postForm').submit(function () {\r\n        let $postType = $('#postType');\r\n        if ($postType.length > 0 && !$postType.val()) {\r\n            alert('');\r\n            $postType.focus();\r\n            return false;\r\n        }\r\n\r\n        let $postTitle = $('#postTitle');\r\n        if ($postTitle.length > 0) {\r\n            let length = Util.getStrByteLen($postTitle.val());\r\n            if (!length) {\r\n                alert('');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n            else if (length > 100) {\r\n                alert(' 100 ');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $voteItemContent = $('#voteItemContent');\r\n        if ($voteItemContent.length > 0) {\r\n            if (!$voteItemContent.val().trim()) {\r\n                alert('');\r\n                $voteItemContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postContent = $('#postContent');\r\n        if ($postContent.length > 0) {\r\n            let length = Util.getStrByteLen($postContent.val().trim());\r\n            if (length < 12) {\r\n                alert(' 12 ');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n            else if (length > 50000) {\r\n                alert(' 50000 ');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postGjc = $('#postGjc');\r\n        if ($postGjc.length > 0 && Info.action === 'new' && !$postGjc.val().trim()) {\r\n            alert('');\r\n            $postGjc.focus();\r\n            return false;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleAttachBtns = function () {\r\n    $(document).on('click', '.attach-area a[data-action]', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let $area = $this.closest('.attach-area');\r\n        let action = $this.data('action');\r\n        let id = $area.data('id');\r\n        if (!id) return;\r\n        if (action === 'insert') {\r\n            let type = $this.data('type');\r\n            let textArea = $('#postContent').get(0);\r\n            let code = `[${type === 'new' ? 'upload' : 'attachment'}=${id}]`;\r\n            Util.addCode(textArea, code);\r\n            textArea.focus();\r\n        }\r\n        else if (action === 'update') {\r\n            $area.find('.attach-info').prop('hidden', true).after(\r\n                `<label><input name=\"replace_${id}\" type=\"file\" aria-label=\"\"></label>`\r\n            );\r\n            $this.data('action', 'cancel').text('').blur();\r\n            if (!$(document).data('attachUpdateAlert')) {\r\n                alert('30');\r\n                $(document).data('attachUpdateAlert', true);\r\n            }\r\n        }\r\n        else if (action === 'cancel') {\r\n            $area.find('.attach-info').prop('hidden', false).next('label').remove();\r\n            $this.data('action', 'update').text('').blur();\r\n        }\r\n        else if (action === 'delete') {\r\n            $area.remove();\r\n        }\r\n    });\r\n\r\n    $(document).on('change', '[type=\"file\"]', function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png', 'torrent'].includes(matches[1].toLowerCase())) {\r\n            alert('');\r\n            return;\r\n        }\r\n\r\n        let type = $this.data('type');\r\n        if (type === 'new') {\r\n            $this.removeData('type').parent().next().prop('hidden', false);\r\n\r\n            let $newAttachArea = $('#newAttachArea');\r\n            let totalNum = $newAttachArea.find('[type=\"file\"]').length;\r\n            if (totalNum >= 5) return;\r\n            let $lastAttachArea = $newAttachArea.find('[type=\"file\"]:last').closest('.attach-area');\r\n            let id = parseInt($lastAttachArea.data('id'));\r\n            if (!id) return;\r\n            id++;\r\n            $(`\r\n<div class=\"form-group row font-size-sm attach-area\" data-id=\"${id}\">\r\n  <div class=\"col-12 col-form-label\">\r\n    <label>\r\n      <input name=\"attachment_${id}\" data-type=\"new\" type=\"file\" aria-label=\"\">\r\n    </label>\r\n    <span hidden>\r\n      <a data-action=\"insert\" data-type=\"new\" href=\"#\"></a>&nbsp;\r\n      <a data-action=\"delete\" href=\"#\"></a>\r\n    </span>\r\n  </div>\r\n  <div class=\"col-4\">\r\n    <label class=\"sr-only\" for=\"atc_downrvrc${id}\"></label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_downrvrc${id}\" name=\"atc_downrvrc${id}\" data-toggle=\"tooltip\" \r\ntype=\"number\" value=\"0\" min=\"0\" title=\"\" placeholder=\"\">\r\n  </div>\r\n  <div class=\"col-8\">\r\n    <label class=\"sr-only\" for=\"atc_desc${id}\"></label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_desc${id}\" name=\"atc_desc${id}\" data-toggle=\"tooltip\" type=\"text\" \r\ntitle=\"\" placeholder=\"\">\r\n  </div>\r\n</div>\r\n`).insertAfter($lastAttachArea).find('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n * @param {jQuery} $node jQuery\r\n */\r\nexport const addSmileCode = function ($node) {\r\n    $('.smile-panel').on('click', 'img', function () {\r\n        $('.smile-panel').addClass('open');\r\n        let textArea = $node.get(0);\r\n        if (!textArea) return;\r\n        let code = `[s:${$(this).data('id')}]`;\r\n        Util.addCode(textArea, code, '');\r\n        textArea.blur();\r\n    }).parent().on('shown.bs.dropdown', function () {\r\n        $('.smile-panel img').each(function () {\r\n            let $this = $(this);\r\n            if (!$this.attr('src')) {\r\n                $this.attr('src', $this.data('src'));\r\n            }\r\n        });\r\n    }).on('hide.bs.dropdown', function (e) {\r\n        let $relatedTarget = $(e.relatedTarget);\r\n        if (!$relatedTarget.data('open')) $relatedTarget.removeData('open');\r\n        else return e.preventDefault();\r\n    });\r\n\r\n    $('#smileDropdownBtn').click(function () {\r\n        let $this = $(this);\r\n        $this.data('open', !$this.data('open'));\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n * @param {number} type 12\r\n */\r\nexport const handleMultiQuote = function (type = 1) {\r\n    let data = localStorage[Const.multiQuoteStorageName];\r\n    if (!data) return;\r\n    try {\r\n        data = JSON.parse(data);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) return;\r\n    let {tid, quoteList} = data;\r\n    if (!Info.tid || tid !== Info.tid || $.type(quoteList) !== 'object') return;\r\n    if (type === 2 && !Info.fid) return;\r\n    let list = [];\r\n    for (let data of Object.values(quoteList)) {\r\n        if (!Array.isArray(data)) continue;\r\n        for (let quote of data) {\r\n            list.push(quote);\r\n        }\r\n    }\r\n    if (!list.length) {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        return;\r\n    }\r\n\r\n    let keywords = new Set();\r\n    let content = '';\r\n    let $keywords = $('[name=\"diy_guanjianci\"]');\r\n    if (type === 2) {\r\n        Msg.wait(`<span class=\"mr-3\">&hellip;</span><em class=\"text-warning countdown-num\">${list.length}</em>`);\r\n        $(document).clearQueue('MultiQuote');\r\n    }\r\n    $.each(list, function (index, data) {\r\n        if (typeof data.floor === 'undefined' || typeof data.pid === 'undefined') return;\r\n        keywords.add(data.userName);\r\n        if (type === 2) {\r\n            $(document).queue('MultiQuote', function () {\r\n                $.get(Util.makeUrl(\r\n                    'post/index',\r\n                    `action=quote&fid=${Info.fid}&tid=${tid}&pid=${data.pid}&article=${data.floor}&t=${new Date().getTime()}`\r\n                ), function ({postContent}) {\r\n                    content += postContent ? postContent + (index === list.length - 1 ? '' : '\\n') : '';\r\n                    let $countdownNum = $('.countdown-num:last');\r\n                    $countdownNum.text(parseInt($countdownNum.text()) - 1);\r\n                    if (index === list.length - 1) {\r\n                        Msg.destroy();\r\n                        $('#postContent').val(content).focus();\r\n                        $keywords.trigger('change');\r\n                    }\r\n                    else {\r\n                        setTimeout(() => $(document).dequeue('MultiQuote'), 100);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            content += `[quote] ${data.floor}(${data.userName}) [/quote]\\n`;\r\n        }\r\n    });\r\n    for (let [index, quote] of list.entries()) {\r\n    }\r\n    $keywords.val([...keywords].join(','));\r\n    $('#postForm').submit(function () {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n    });\r\n    if (type === 2) {\r\n        $(document).dequeue('MultiQuote');\r\n    }\r\n    else {\r\n        $('#postContent').val(content).focus();\r\n        $keywords.trigger('change');\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleClearMultiQuoteDataBtn = function () {\r\n    $('.clear-multi-quote-data-btn').click(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('')) return;\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        $('[name=\"diy_guanjianci\"]').val('');\r\n        $('#postContent').val('');\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const addRedundantKeywordWarning = function () {\r\n    $('input[name=\"diy_guanjianci\"]').change(function () {\r\n        let $this = $(this);\r\n        let keywords = $.trim($this.val()).split(',').filter(str => str);\r\n        if (keywords.length > 5) {\r\n            alert('5');\r\n            $this.select().focus();\r\n        }\r\n    });\r\n};\r\n","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport * as Dialog from './dialog';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\nimport * as ConfigDialog from './configDialog';\r\n\r\n/**\r\n * \r\n */\r\nexport const handleMainMenu = function () {\r\n    $('#mainMenuTogglerBtn').click(function () {\r\n        let maxHeight = document.documentElement.clientHeight - $(this).closest('.navbar').outerHeight();\r\n        if (maxHeight > 0) {\r\n            $('#mainMenu').css('max-height', maxHeight + 'px');\r\n        }\r\n    });\r\n    $('#sidebarMainMenuBtn').click(() => $('#mainMenuTogglerBtn').click());\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleMainMenuLink = function () {\r\n    $('#mainMenu').find('[data-name=\"openConfigDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        $('#mainMenuTogglerBtn').click();\r\n        ConfigDialog.show();\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const showSidebarBtnGroup = function () {\r\n    $('.sidebar-btn-group').prop('hidden', false);\r\n    if (Config.showSidebarRollBtnEnabled) $('#sidebarRollBtn').prop('hidden', false);\r\n    if (Config.showSidebarMainMenuBtnEnabled) $('#sidebarMainMenuBtn').prop('hidden', false);\r\n    if (Config.showSidebarForumListBtnEnabled) $('#sidebarForumListBtn').prop('hidden', false);\r\n    if (Config.showSidebarSearchBtnEnabled) $('#sidebarSearchBtn').prop('hidden', false);\r\n    if (Config.showSidebarHomePageBtnEnabled) $('#sidebarHomePageBtn').prop('hidden', false);\r\n};\r\n\r\n/**\r\n * /\r\n */\r\nexport const handleSidebarRollBtn = function () {\r\n    $(window).scroll(function () {\r\n        let $btn = $('#sidebarRollBtn');\r\n        if ($(window).scrollTop() > 640) {\r\n            if ($btn.data('direction') === 'top') return;\r\n            $btn.data('direction', 'top').attr('aria-label', '')\r\n                .find('i').removeClass('fa-chevron-down').addClass('fa-chevron-up');\r\n        }\r\n        else {\r\n            if ($btn.data('direction') === 'bottom') return;\r\n            $btn.data('direction', 'bottom').attr('aria-label', '')\r\n                .find('i').removeClass('fa-chevron-up').addClass('fa-chevron-down');\r\n        }\r\n    });\r\n\r\n    $('#sidebarRollBtn').click(function () {\r\n        let scrollTop = $(this).data('direction') === 'bottom' ? $('body').height() : 0;\r\n        $('body, html').animate({scrollTop: scrollTop});\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleSearchDialog = function () {\r\n    let $searchDialog = $('#searchDialog');\r\n\r\n    $searchDialog.on('shown.bs.modal', function () {\r\n        $('#searchKeyword').select().focus();\r\n    }).find('form').submit(function () {\r\n        let $this = $(this);\r\n        let $searchKeyword = $this.find('#searchKeyword');\r\n        let searchType = $this.find('#searchType').val();\r\n        let keyword = $.trim($searchKeyword.val());\r\n        if (searchType === 'gjc') {\r\n            $this.attr('action', Util.makeUrl('gjc/' + keyword));\r\n        }\r\n        else if (searchType === 'username') {\r\n            $this.attr('action', Util.makeUrl('user/username/' + keyword));\r\n        }\r\n        else {\r\n            $this.attr('action', Util.makeUrl('search'));\r\n            $searchKeyword.attr('name', searchType === 'author' ? 'pwuser' : 'keyword');\r\n            if (searchType === 'title') {\r\n                if (keyword.length && Util.getStrByteLen(keyword) <= 2) {\r\n                    let $method = $this.find('[name=\"method\"]');\r\n                    $method.val('OR');\r\n                    $searchKeyword.val(keyword + ' ' + Math.floor(new Date().getTime() / 1000));\r\n                    setTimeout(() => {\r\n                        $searchKeyword.val(keyword);\r\n                        $method.val('AND');\r\n                    }, 200);\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    $searchDialog.find('[name=\"searchRange\"]').on('click', function () {\r\n        let value = 'all';\r\n        if ($(this).val() === 'current') value = Info.fid;\r\n        $searchDialog.find('[name=\"f_fid\"]').val(value);\r\n    });\r\n\r\n    let $current = $searchDialog.find('[name=\"searchRange\"][value=\"current\"]');\r\n    let $currentBox = $current.closest('.form-check-inline');\r\n    $searchDialog.find('#searchType').change(function () {\r\n        let searchType = $(this).val();\r\n        if (!$current.data('enabled')) return;\r\n        let disabled = searchType === 'gjc' || searchType === 'username';\r\n        $current.prop('disabled', disabled);\r\n        if (disabled) $currentBox.addClass('disabled');\r\n        else $currentBox.removeClass('disabled');\r\n    });\r\n\r\n    if (pageId === 'threadPage' || pageId === 'readPage') {\r\n        $current.prop('disabled', false).data('enabled', true).click();\r\n        $currentBox.removeClass('disabled');\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handlePageInput = function () {\r\n    $(document).on('click', '.page-input', function (e) {\r\n        e.preventDefault();\r\n        if (Info.maxPageNum && Info.maxPageNum <= 1) return;\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let excludeParams = $(this).data('exclude');\r\n        if (excludeParams) excludeParams = excludeParams.split(',');\r\n        else excludeParams = [];\r\n        let num = parseInt(\r\n            prompt(`${Info.maxPageNum ? `${Info.maxPageNum}` : ''}`, Info.currentPageNum)\r\n        );\r\n        if (num && num > 0) {\r\n            location.href = Util.makeUrl(action, 'page=' + num, true, excludeParams);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const bindFastSubmitShortcutKey = function () {\r\n    $('[data-fast-submit=\"true\"]').keydown(function (e) {\r\n        if (e.keyCode === 13 && e.ctrlKey) {\r\n            $(this).closest('form').submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const showEditCommonForumDialog = function () {\r\n    $(document).on('click', '.edit-common-forum-btn', function (e) {\r\n        e.preventDefault();\r\n        const dialogName = 'editCommonForumDialog';\r\n        if ($('#' + dialogName).length > 0) return;\r\n        readConfig();\r\n\r\n        let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n        let commonForumListHtml = '';\r\n        for (let {fid, name} of commonForumList) {\r\n            commonForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n        let availableForumListHtml = '';\r\n        for (let {fid, name} of Const.availableForumList) {\r\n            if (commonForumList.find(elem => elem.fid === fid)) continue;\r\n            availableForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n\r\n        let bodyContent = `\r\n<p class=\"font-size-sm text-muted\">\r\n  \r\n</p>\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend></legend>\r\n  <div class=\"edit-forum-list d-flex flex-wrap\" id=\"editCommonForumList\">${commonForumListHtml}</div>\r\n</fieldset>\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend></legend>\r\n  <div class=\"edit-forum-list d-flex flex-wrap\" id=\"editAvailableForumList\">${availableForumListHtml}</div>\r\n</fieldset>`;\r\n        let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>\r\n<button class=\"btn btn-danger\" name=\"reset\" type=\"button\"></button>`;\r\n        let $dialog = Dialog.create(dialogName, '', bodyContent, footerContent);\r\n\r\n        const dragulaInit = function () {\r\n            let drake = dragula($dialog.find('.edit-forum-list').get(), {revertOnSpill: true});\r\n            drake.on('drag', function () {\r\n                $dialog.find('.dialog-body').css('overflow-y', 'hidden');\r\n            }).on('drop', function () {\r\n                $dialog.find('.dialog-body').css('overflow-y', 'auto');\r\n            }).on('cancel', function () {\r\n                $dialog.find('.dialog-body').css('overflow-y', 'auto');\r\n            });\r\n        };\r\n\r\n        let $dragulaScriptPath = $('[name=\"dragulaScriptPath\"]');\r\n        let dragulaScriptPath = $dragulaScriptPath.val();\r\n        if (dragulaScriptPath) {\r\n            $.getScript(dragulaScriptPath, dragulaInit);\r\n            $dragulaScriptPath.val('');\r\n        }\r\n        else {\r\n            dragulaInit();\r\n        }\r\n\r\n        $dialog.submit(function (e) {\r\n            e.preventDefault();\r\n            Config.commonForumList = [];\r\n            $('#editCommonForumList').children('.btn').each(function () {\r\n                let $this = $(this);\r\n                let fid = parseInt($this.data('fid'));\r\n                let name = $this.text().trim();\r\n                if (!fid || !name) return;\r\n                Config.commonForumList.push({fid: fid, name: name});\r\n            });\r\n            writeConfig();\r\n            alert('');\r\n            Dialog.close(dialogName);\r\n            location.reload();\r\n        }).find('[name=\"reset\"]').click(function () {\r\n            if (!confirm('')) return;\r\n            Config.commonForumList = [];\r\n            writeConfig();\r\n            alert('');\r\n            Dialog.close(dialogName);\r\n            location.reload();\r\n        });\r\n\r\n        Dialog.show(dialogName);\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const fillCommonForumPanel = function () {\r\n    let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n    let html = '';\r\n    for (let [index, {fid, name}] of commonForumList.entries()) {\r\n        if (index === 0 || index % 3 === 0) html += '<div class=\"row mb-3\">';\r\n        html += `\r\n<div class=\"col-4\">\r\n  <a class=\"btn btn-outline-primary btn-block\" href=\"${Util.makeUrl('thread')}/${fid}\">${name}</a>\r\n</div>`;\r\n        if (index === commonForumList.length - 1 || index % 3 === 2) html += '</div>';\r\n    }\r\n    $('.common-forum-panel').html(html);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const preventCloseWindow = function () {\r\n    window.addEventListener(\"beforeunload\", function (e) {\r\n        if ($('.mask').length > 0) {\r\n            let msg = '';\r\n            e.returnValue = msg;\r\n            return msg;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * /\r\n * @param {string} title \r\n * @param {string} configName \r\n * @param {?function} [callback] \r\n * @param {?function} [callbackAfterSubmit] \r\n */\r\nexport const showCommonImportOrExportConfigDialog = function (title, configName, callback, callbackAfterSubmit) {\r\n    const dialogName = 'pdCommonImOrExConfigDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\">\r\n  <b></b><br>\r\n  <b></b>\r\n</p>\r\n<div class=\"form-group\">\r\n  <textarea class=\"form-control\" name=\"commonConfig\" rows=\"10\" aria-label=\"\" style=\"word-break: break-all;\"></textarea>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\"></button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\"></button>`;\r\n    let $dialog = Dialog.create(dialogName, `${title}`, bodyContent, footerContent);\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('')) return;\r\n        let options = $.trim($dialog.find('[name=\"commonConfig\"]').val());\r\n        if (!options) return;\r\n        try {\r\n            options = JSON.parse(options);\r\n        }\r\n        catch (ex) {\r\n            alert('');\r\n            return;\r\n        }\r\n        if (!options || $.type(options) !== $.type(Config[configName])) {\r\n            alert('');\r\n            return;\r\n        }\r\n        Config[configName] = options;\r\n        writeConfig();\r\n        alert('');\r\n        Dialog.close(dialogName);\r\n        if (typeof callbackAfterSubmit === 'function') callbackAfterSubmit();\r\n        else location.reload();\r\n    });\r\n    Dialog.show(dialogName);\r\n    $dialog.find('[name=\"commonConfig\"]').val(JSON.stringify(Config[configName])).select().focus();\r\n    if (typeof callback === 'function') callback($dialog);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const followUsers = function () {\r\n    if (!Config.followUserList.length) return;\r\n    if (pageId === 'indexPage' && Config.highlightFollowUserThreadInHPEnabled) {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.followUserList) > -1) {\r\n                $this.addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'threadPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.followUserList) > -1) {\r\n                $this.closest('.thread-list-item').find('.thread-footer-column a:first').addClass('text-danger');\r\n                if (Config.highlightFollowUserThreadLinkEnabled) $this.addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        $('.read-floor').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('username'), Config.followUserList) > -1) {\r\n                $this.find('.floor-num').addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'gjcPage' || pageId === 'sharePage' || pageId === 'searchPage') {\r\n        $('.thread-list-group').find('a[data-author]').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.followUserList) > -1) {\r\n                $this.addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const blockUsers = function () {\r\n    if (!Config.blockUserList.length) return;\r\n    let num = 0;\r\n    if (pageId === 'indexPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            let index = Util.inFollowOrBlockUserList($this.data('author'), Config.blockUserList);\r\n            if (index > -1 && Config.blockUserList[index].type <= 1) {\r\n                num++;\r\n                $this.closest('.thread-link-group').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'threadPage') {\r\n        if (Config.blockUserForumType === 1 && !Config.blockUserFidList.includes(Info.fid)) return;\r\n        else if (Config.blockUserForumType === 2 && Config.blockUserFidList.includes(Info.fid)) return;\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            let index = Util.inFollowOrBlockUserList($this.data('author'), Config.blockUserList);\r\n            if (index > -1 && Config.blockUserList[index].type <= 1) {\r\n                num++;\r\n                $this.closest('.thread-list-item').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        if (Config.blockUserForumType === 1 && !Config.blockUserFidList.includes(Info.fid)) return;\r\n        else if (Config.blockUserForumType === 2 && Config.blockUserFidList.includes(Info.fid)) return;\r\n        $('.read-floor').each(function () {\r\n            let $this = $(this);\r\n            let index = Util.inFollowOrBlockUserList($this.data('username'), Config.blockUserList);\r\n            if (index > -1) {\r\n                let floor = parseInt($this.data('floor'));\r\n                if (Config.blockUserList[index].type === 2 && floor === 0) return;\r\n                else if (Config.blockUserList[index].type === 1 && floor > 0) return;\r\n                num++;\r\n                $this.closest('.read-floor').remove();\r\n            }\r\n        });\r\n        $('.read-content').find('.blockquote > p').each(function () {\r\n            let $this = $(this);\r\n            let content = $this.text().trim();\r\n            for (let data of Config.blockUserList) {\r\n                if (data.type === 1) continue;\r\n                try {\r\n                    let regex1 = new RegExp(`^(\\\\d+|)${data.name}`, 'i');\r\n                    let regex2 = new RegExp(`^\\\\s*\\\\d+\\\\(${data.name}\\\\)\\\\s*`, 'i');\r\n                    if (regex1.test(content) || regex2.test(content)) {\r\n                        $this.html(`<mark class=\"help\" data-toggle=\"tooltip\" title=\"${data.name}\"></mark>`);\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                }\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'gjcPage' && Config.blockUserAtTipsEnabled) {\r\n        $('.thread-list-group').find('a[data-author]').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.blockUserList) > -1) {\r\n                num++;\r\n                $this.closest('.thread-list-item').remove();\r\n            }\r\n        });\r\n    }\r\n    if (num > 0) console.log(`${num}`);\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const blockThread = function () {\r\n    if (!Config.blockThreadList.length) return;\r\n\r\n    /**\r\n     * \r\n     * @param {string} title \r\n     * @param {string} userName \r\n     * @param {number} fid ID\r\n     * @returns {boolean} \r\n     */\r\n    const isBlock = function (title, userName, fid = 0) {\r\n        for (let {keyWord, includeUser, excludeUser, includeFid, excludeFid} of Config.blockThreadList) {\r\n            let regex = null;\r\n            if (/^\\/.+\\/[gimuy]*$/.test(keyWord)) {\r\n                try {\r\n                    regex = eval(keyWord);\r\n                }\r\n                catch (ex) {\r\n                    console.log(ex);\r\n                    continue;\r\n                }\r\n            }\r\n            if (userName) {\r\n                if (includeUser) {\r\n                    if (!includeUser.includes(userName)) continue;\r\n                }\r\n                else if (excludeUser) {\r\n                    if (excludeUser.includes(userName)) continue;\r\n                }\r\n            }\r\n            if (fid) {\r\n                if (includeFid) {\r\n                    if (!includeFid.includes(fid)) continue;\r\n                }\r\n                else if (excludeFid) {\r\n                    if (excludeFid.includes(fid)) continue;\r\n                }\r\n            }\r\n            if (regex) {\r\n                if (regex.test(title)) return true;\r\n            }\r\n            else {\r\n                if (title.toLowerCase().includes(keyWord.toLowerCase())) return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    let num = 0;\r\n    if (pageId === 'indexPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (isBlock($this.text().trim(), $this.data('author'))) {\r\n                num++;\r\n                $this.closest('.thread-link-group').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'threadPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (isBlock($this.attr('title'), $this.data('author'), Info.fid)) {\r\n                num++;\r\n                $this.closest('.thread-list-item').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        if (Info.currentPageNum !== 1) return;\r\n        let $topFloor = $('.read-floor[data-floor=\"0\"]');\r\n        if (!$topFloor.length) return;\r\n        if (isBlock($('.thread-title').text().trim(), $topFloor.data('username'), Info.fid)) {\r\n            num++;\r\n            $topFloor.remove();\r\n        }\r\n    }\r\n    if (num > 0) console.log(`${num}`);\r\n};\r\n","/*  */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {write as writeConfig} from './config';\r\nimport * as Msg from './msg';\r\n\r\n/**\r\n * \r\n */\r\nexport const handleCopyFloorLinkBtn = function () {\r\n    $(document).on('click', '.floor-num', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let link = Util.getHostNameUrl() + $this.attr('href');\r\n        $this.data('copy-text', link);\r\n        if (!Util.copyText($this, $this)) {\r\n            prompt('', link);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleFastReplyBtn = function () {\r\n    $(document).on('click', '.fast-reply-btn', function () {\r\n        let $article = $(this).closest('article');\r\n        let floor = $article.data('floor');\r\n        let userName = $article.data('username');\r\n        $('#postGjc').val(userName);\r\n        let postContent = $('#postContent').get(0);\r\n        postContent.value = `[quote] ${floor}(${userName}) [/quote]\\n`;\r\n        postContent.selectionStart = postContent.value.length;\r\n        postContent.selectionEnd = postContent.value.length;\r\n        postContent.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleGoodPostBtn = function () {\r\n    $(document).on('click', '.handle-post-btn', function () {\r\n        let $this = $(this);\r\n        if (!Info.goodPostTips || $this.data('wait')) return;\r\n        let $floor = $(this).closest('.read-floor');\r\n        let pid = $floor.data('pid');\r\n        let userName = $floor.data('username');\r\n        $floor.addClass('good-post-mark');\r\n        if (!confirm(`\\n${Info.goodPostTips}`)) {\r\n            $floor.removeClass('good-post-mark');\r\n            return;\r\n        }\r\n        let $sameUserNameFloors = $(`.read-floor[data-username=\"${userName}\"]`).not($floor);\r\n        if ($sameUserNameFloors.find('.fieldset-alert:contains(\"\")').length > 0) {\r\n            if (!confirm('')) {\r\n                $floor.removeClass('good-post-mark');\r\n                return;\r\n            }\r\n        }\r\n\r\n        $this.data('wait', true);\r\n        $.post('/diy_read_cztz.php', `tid=${Info.tid}&pid=${pid}&safeid=${Info.safeId}`)\r\n            .done(function (html) {\r\n                if (/|/.test(html)) {\r\n                    let $content = $floor.find('.read-content');\r\n                    if (!$content.find('.fieldset-alert:contains(\"\")').length) {\r\n                        $content.prepend('<fieldset class=\"fieldset fieldset-alert\"><legend></legend></fieldset>');\r\n                    }\r\n                }\r\n                if (!//.test(html)) {\r\n                    $floor.removeClass('good-post-mark');\r\n                }\r\n                alert(html);\r\n            }).always(() => $this.removeData('wait'));\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleBlockFloorBtn = function () {\r\n    $(document).on('click', '.block-floor', () => confirm(''));\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleBuyThreadBtn = function () {\r\n    $(document).on('click', '.buy-thread-btn', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let pid = $this.data('pid');\r\n        let price = $this.data('price');\r\n        if (price > 5 && !confirm(`${price}KFB`)) return;\r\n        let $wait = Msg.wait('&hellip;');\r\n        $.get(Util.makeUrl('job/buytopic', `tid=${Info.tid}&pid=${pid}&verify=${Info.verify}&t=${new Date().getTime()}`),\r\n            function ({msg}) {\r\n                Msg.remove($wait);\r\n                if (msg === '') {\r\n                    location.reload();\r\n                }\r\n                else if (msg.includes('')) {\r\n                    alert('');\r\n                    location.reload();\r\n                }\r\n                else {\r\n                    alert('');\r\n                }\r\n            });\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const copyBuyThreadList = function () {\r\n    $(document).on('change', '.buy-thread-list', function () {\r\n        let $this = $(this);\r\n        if ($this.val() !== 'copyList') return;\r\n        let list = $this.find('option').map(function (index) {\r\n            let name = $(this).text();\r\n            if (index === 0 || index === 1 || name.includes('-'.repeat(11))) return null;\r\n            else return name;\r\n        }).get().join('\\n');\r\n        $this.get(0).selectedIndex = 0;\r\n        if (!list) {\r\n            alert('');\r\n            return;\r\n        }\r\n\r\n        let $dialog = $(`\r\n<div class=\"modal fade\" id=\"buyThreadListDialog\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"buyThreadListDialogTitle\"\r\n     aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-sm\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"buyThreadListDialogTitle\"></h5>\r\n        <button class=\"close\" data-dismiss=\"modal\" type=\"button\" aria-label=\"\">\r\n          <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div class=\"form-group\">\r\n          <textarea class=\"form-control\" name=\"buyThreadListContent\" rows=\"14\" aria-label=\"\">${list}</textarea>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n`).appendTo('body');\r\n        $dialog.on('shown.bs.modal', function () {\r\n            $dialog.find('[name=\"buyThreadListContent\"]').select().focus();\r\n        }).on('hidden.bs.modal', function () {\r\n            $dialog.remove();\r\n        }).modal('show');\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleFloorImage = function () {\r\n    $(document).on('click', '.img', function () {\r\n        let $this = $(this);\r\n        if ($this.parent().is('a') || this.naturalWidth <= $this.closest('.read-content').width()) return;\r\n        location.href = $this.attr('src');\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const gotoFloor = function () {\r\n    if (Info.floor && Info.floor > 0) {\r\n        let hashName = $(`article[data-floor=\"${Info.floor}\"]`).prev('a').attr('name');\r\n        if (hashName) location.hash = '#' + hashName;\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleFastGotoFloorBtn = function () {\r\n    $('.fast-goto-floor').click(function (e) {\r\n        e.preventDefault();\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let floor = parseInt(prompt(''));\r\n        if (!floor || floor <= 0) return;\r\n        location.href = Util.makeUrl(action, `page=${Math.floor(floor / Config.perPageFloorNum) + 1}&floor=${floor}`);\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleTuiThreadBtn = function () {\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/diy_read_tui.php',\r\n            data: `tid=${Info.tid}&safeid=${Info.safeId}`,\r\n            success: function (msg) {\r\n                let matches = /<span.+?\\+\\d+!<\\/span>\\s*(\\d+)/i.exec(msg);\r\n                if (matches) {\r\n                    let $num = $this.find('span:first');\r\n                    $num.text('+1');\r\n                    setTimeout(() => {\r\n                        $num.text(matches[1]);\r\n                    }, 1000);\r\n                }\r\n                else if (//.test(msg)) {\r\n                    alert('');\r\n                }\r\n                else {\r\n                    alert('');\r\n                }\r\n            },\r\n            error: function () {\r\n                alert('');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleCopyCodeBtn = function () {\r\n    $(document).on('click', '.copy-code', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if (Util.copyText($this.next('pre'), $this)) return;\r\n\r\n        let code = $this.data('code');\r\n        if (code) {\r\n            $this.text('').removeData('code');\r\n            $this.next('textarea').remove();\r\n            $this.after(`<pre class=\"pre-scrollable\">${code}</pre>`);\r\n        }\r\n        else {\r\n            let $pre = $this.next('pre');\r\n            let html = $pre.html();\r\n            $this.text('').data('code', html);\r\n            html = Util.decodeHtmlSpecialChar(html);\r\n            let height = $pre.height();\r\n            if (height < 50) height = 50;\r\n            if (height > 340) height = 340;\r\n            $pre.remove();\r\n            $(`<textarea class=\"form-control code-textarea\" style=\"height: ${height}px\" wrap=\"off\">${html}</textarea>`)\r\n                .insertAfter($this).select().focus();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n * @returns {{}[]} \r\n */\r\nconst getCheckedMultiQuoteData = function () {\r\n    let quoteList = [];\r\n    $('.multi-quote-check:checked').each(function () {\r\n        let $article = $(this).closest('article');\r\n        quoteList.push({floor: $article.data('floor'), pid: $article.data('pid'), userName: $article.data('username')});\r\n    });\r\n    return quoteList;\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const bindMultiQuoteCheckClick = function () {\r\n    $(document).on('click', '.multi-quote-check', function () {\r\n        let data = localStorage[Const.multiQuoteStorageName];\r\n        if (data) {\r\n            try {\r\n                data = JSON.parse(data);\r\n                if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) data = null;\r\n                else if (!('tid' in data) || data.tid !== Info.tid || $.type(data.quoteList) !== 'object') data = null;\r\n            }\r\n            catch (ex) {\r\n                data = null;\r\n            }\r\n        }\r\n        else {\r\n            data = null;\r\n        }\r\n        let quoteList = getCheckedMultiQuoteData();\r\n        if (!data) {\r\n            localStorage.removeItem(Const.multiQuoteStorageName);\r\n            data = {tid: Info.tid, quoteList: {}};\r\n        }\r\n        if (quoteList.length > 0) data.quoteList[Info.currentPageNum] = quoteList;\r\n        else delete data.quoteList[Info.currentPageNum];\r\n        localStorage[Const.multiQuoteStorageName] = JSON.stringify(data);\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const addUserMemo = function () {\r\n    if ($.isEmptyObject(Config.userMemoList)) return;\r\n    $('.read-floor').each(function () {\r\n        let $this = $(this);\r\n        let userName = $this.data('username');\r\n        let key = Object.keys(Config.userMemoList).find(name => name === userName);\r\n        if (!key) return;\r\n        $this.find('.floor-user').after(\r\n            `<span class=\"tips font-size-sm\" data-toggle=\"tooltip\" title=\"${Config.userMemoList[key]}\">[?]</span>`\r\n        );\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const replaceAttachLabel = function () {\r\n    $('.attach-label').each(function () {\r\n        let $this = $(this);\r\n        if ($this.closest('.blockquote').length > 0) return;\r\n        let aid = $this.data('aid');\r\n        let pid = $this.closest('.read-floor').data('pid');\r\n        $this.replaceWith(`<img class=\"img\" src=\"/job.php?action=download&pid=${pid}&tid=${Info.tid}&aid=${aid}\" alt=\"[]\">`);\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n */\r\nexport const handleMoveThreadBtn = function () {\r\n    $('#moveThreadBtn').click(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('[]')) return;\r\n        $.post('/diy_admin_read.php', `tid=${Info.tid}&safeid=${Info.safeId}`, function (msg) {\r\n            alert(msg);\r\n            location.reload();\r\n        });\r\n    });\r\n};","/*  */\r\n'use strict';\r\n\r\n/**\r\n * \r\n * @param {string} cmd \r\n * @param {boolean} isOutput \r\n * @returns {{isError: boolean, response: string}} isErrorresponse\r\n */\r\nexport const runCmd = function (cmd, isOutput = false) {\r\n    let isError = false;\r\n    let response = '';\r\n    try {\r\n        response = eval(cmd);\r\n        if (isOutput) console.log(response);\r\n    }\r\n    catch (ex) {\r\n        isError = true;\r\n        response = ex;\r\n        console.log(ex);\r\n    }\r\n    return {isError, response: String(response)};\r\n};\r\n","/*  */\r\n'use strict';\r\n\r\n/**\r\n * Cookie\r\n * @param {string} name Cookie\r\n * @param {*} value Cookie\r\n * @param {?Date} date Cookie\r\n * @param {string} prefix Cookie\r\n */\r\nexport const setCookie = function (name, value, date = null, prefix = Info.uid + '_' + Const.storagePrefix) {\r\n    document.cookie = `${prefix}${name}=${encodeURI(value)}${!date ? '' : ';expires=' + date.toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * Cookie\r\n * @param {string} name Cookie\r\n * @param {string} prefix Cookie\r\n * @returns {?string} Cookie\r\n */\r\nexport const getCookie = function (name, prefix = Info.uid + '_' + Const.storagePrefix) {\r\n    let regex = new RegExp(`(^| )${prefix}${name}=([^;]*)(;|$)`);\r\n    let matches = document.cookie.match(regex);\r\n    if (!matches) return null;\r\n    else return decodeURI(matches[2]);\r\n};\r\n\r\n/**\r\n * Cookie\r\n * @param {string} name Cookie\r\n * @param {string} prefix Cookie\r\n */\r\nexport const deleteCookie = function (name, prefix = Info.uid + '_' + Const.storagePrefix) {\r\n    document.cookie = `${prefix}${name}=;expires=${getDate('-1d').toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * Date\r\n * @param {string} value +-YyMdhmsms\r\n * @returns {?Date} Date\r\n * @example\r\n * Tools.getDate('+2y') 2Date\r\n * Tools.getDate('+3M') 3Date\r\n * Tools.getDate('-4d') 4Date\r\n * Tools.getDate('5h') 5Date\r\n * Tools.getDate('2015Y') 2015Date\r\n */\r\nexport const getDate = function (value) {\r\n    let date = new Date();\r\n    let matches = /^(-|\\+)?(\\d+)([a-zA-Z]{1,2})$/.exec(value);\r\n    if (!matches) return null;\r\n    let flag = typeof matches[1] === 'undefined' ? 0 : (matches[1] === '+' ? 1 : -1);\r\n    let increment = flag === -1 ? -parseInt(matches[2]) : parseInt(matches[2]);\r\n    let unit = matches[3];\r\n    switch (unit) {\r\n        case 'Y':\r\n            date.setFullYear(increment);\r\n            break;\r\n        case 'y':\r\n            date.setFullYear(flag === 0 ? increment : date.getFullYear() + increment);\r\n            break;\r\n        case 'M':\r\n            date.setMonth(flag === 0 ? increment : date.getMonth() + increment);\r\n            break;\r\n        case 'd':\r\n            date.setDate(flag === 0 ? increment : date.getDate() + increment);\r\n            break;\r\n        case 'h':\r\n            date.setHours(flag === 0 ? increment : date.getHours() + increment);\r\n            break;\r\n        case 'm':\r\n            date.setMinutes(flag === 0 ? increment : date.getMinutes() + increment);\r\n            break;\r\n        case 's':\r\n            date.setSeconds(flag === 0 ? increment : date.getSeconds() + increment);\r\n            break;\r\n        case 'ms':\r\n            date.setMilliseconds(flag === 0 ? increment : date.getMilliseconds() + increment);\r\n            break;\r\n        default:\r\n            return null;\r\n    }\r\n    return date;\r\n};\r\n\r\n/**\r\n * 1GBK2\r\n * @param {string} str \r\n * @returns {number} \r\n */\r\nexport const getStrByteLen = function (str) {\r\n    let len = 0;\r\n    let cLen = 2;\r\n    for (let i = 0; i < str.length; i++) {\r\n        len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? cLen : 1;\r\n    }\r\n    return len;\r\n};\r\n\r\n/**\r\n * URL\r\n * @returns {string} URL\r\n */\r\nexport const getHostNameUrl = function () {\r\n    return location.protocol + '//' + location.host;\r\n};\r\n\r\n/**\r\n * BBCode\r\n * @param textArea \r\n * @param {string} code BBCode\r\n * @param {string} selText \r\n */\r\nexport const addCode = function (textArea, code, selText = '') {\r\n    let startPos = selText === '' ? code.indexOf(']') + 1 : code.indexOf(selText);\r\n    if (typeof textArea.selectionStart !== 'undefined') {\r\n        let prePos = textArea.selectionStart;\r\n        textArea.value = textArea.value.substring(0, prePos) + code + textArea.value.substring(textArea.selectionEnd);\r\n        textArea.selectionStart = prePos + startPos;\r\n        textArea.selectionEnd = prePos + startPos + selText.length;\r\n    }\r\n    else {\r\n        textArea.value += code;\r\n    }\r\n};\r\n\r\n/**\r\n * \r\n * @param textArea \r\n * @returns {string} \r\n */\r\nexport const getSelText = function (textArea) {\r\n    return textArea.value.substring(textArea.selectionStart, textArea.selectionEnd);\r\n};\r\n\r\n/**\r\n * URL\r\n * @param {string} str URL\r\n * @returns {Map} \r\n */\r\nexport const extractQueryStr = function (str) {\r\n    let params = new Map();\r\n    for (let param of str.split('&')) {\r\n        if (!param) continue;\r\n        let [key, value] = param.split('=');\r\n        params.set(key, typeof value !== 'undefined' ? value : '');\r\n    }\r\n    return params;\r\n};\r\n\r\n/**\r\n * URL\r\n * @param {Map} map \r\n * @returns {string} URL\r\n */\r\nexport const buildQueryStr = function (map) {\r\n    let queryStr = '';\r\n    for (let [key, value] of map) {\r\n        if (Info.urlType === 2) {\r\n            queryStr += (queryStr ? '&' : '') + key + '=' + value;\r\n        }\r\n        else {\r\n            queryStr += (queryStr ? '/' : '') + key + '/' + value;\r\n        }\r\n    }\r\n    return queryStr;\r\n};\r\n\r\n/**\r\n * URL\r\n * @param {string} action \r\n * @param {string} param \r\n * @param {boolean} includeOtherParam \r\n * @param {[]} excludeParams \r\n * @returns {string} URL URL\r\n */\r\nexport const makeUrl = function (action, param = '', includeOtherParam = false, excludeParams = []) {\r\n    let url = '';\r\n    let paramList = extractQueryStr(param);\r\n    if (includeOtherParam) {\r\n        paramList = new Map([...extractQueryStr(Info.urlParam).entries(), ...paramList.entries()]);\r\n        for (let i in excludeParams) {\r\n            paramList.delete(excludeParams[i]);\r\n        }\r\n    }\r\n    if (!action.startsWith('/')) {\r\n        if (location.pathname.startsWith(Info.baseFile)) url = Info.baseFile + '/';\r\n        else url = Info.rootPath;\r\n    }\r\n    url += action;\r\n    if (paramList.size > 0) {\r\n        let queryStr = buildQueryStr(paramList);\r\n        if (queryStr) {\r\n            url += (Info.urlType === 2 ? '?' : '/') + queryStr;\r\n        }\r\n    }\r\n    return url;\r\n};\r\n\r\n/**\r\n * URL\r\n * @param {string} name \r\n * @returns {?string} \r\n */\r\nexport const getQueryParam = function (name) {\r\n    return extractQueryStr(Info.urlParam).get(name);\r\n};\r\n\r\n/**\r\n * HTML\r\n * @param {string} str \r\n * @returns {string} \r\n */\r\nexport const decodeHtmlSpecialChar = function (str) {\r\n    if (!str.length) return '';\r\n    return str.replace(/<br\\s*\\/?>/gi, '\\n')\r\n        .replace(/&quot;/gi, '\\\"')\r\n        .replace(/&#39;/gi, '\\'')\r\n        .replace(/&nbsp;/gi, ' ')\r\n        .replace(/&gt;/gi, '>')\r\n        .replace(/&lt;/gi, '<')\r\n        .replace(/&amp;/gi, '&');\r\n};\r\n\r\n/**\r\n * HTML\r\n * @param html HTML\r\n * @returns {string} HTML\r\n */\r\nexport const removeHtmlTag = html => html ? html.replace(/<br\\s*\\/?>/g, '\\n').replace(/<[^>]+>/g, '') : '';\r\n\r\n/**\r\n * \r\n * @param {jQuery} $nodes jQuery\r\n */\r\nexport const selectAll = function ($nodes) {\r\n    $nodes.prop('checked', true);\r\n};\r\n\r\n/**\r\n * \r\n * @param {jQuery} $nodes jQuery\r\n */\r\nexport const selectInverse = function ($nodes) {\r\n    $nodes.each(function () {\r\n        let $this = $(this);\r\n        $this.prop('checked', !$this.prop('checked'));\r\n    });\r\n};\r\n\r\n/**\r\n * \r\n * @param {jQuery} $node jQuery\r\n * @param {string} type \r\n * @param {string} msg \r\n */\r\nexport const showValidationMsg = function ($node, type, msg = '') {\r\n    if (type === 'error') type = 'danger';\r\n    $node.removeClass('form-control-success form-control-warning form-control-danger');\r\n    let $parent = $node.parent();\r\n    $parent.removeClass('has-success has-warning has-danger');\r\n    if ($.inArray(type, ['success', 'warning', 'danger'] > -1)) {\r\n        $node.addClass('form-control-' + type).parent().addClass('has-' + type);\r\n    }\r\n    let $feedback = $parent.find('.form-control-feedback');\r\n    if (type === 'wait') {\r\n        $feedback.html(`<span class=\"text-muted\"><i class=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i> ${msg}</span>`);\r\n    }\r\n    else {\r\n        $feedback.text(msg);\r\n    }\r\n};\r\n\r\n/**\r\n * AB\r\n * @param {Object} a A\r\n * @param {Object} b B\r\n * @returns {Object} \r\n */\r\nexport const getDifferenceSetOfObject = function (a, b) {\r\n    let c = {};\r\n    if ($.type(a) !== 'object' || $.type(b) !== 'object') return c;\r\n    $.each(b, (key, data) => {\r\n        if (key in a) {\r\n            if (!deepEqual(a[key], data)) c[key] = data;\r\n        }\r\n    });\r\n    return c;\r\n};\r\n\r\n/**\r\n * \r\n * @param {*} a\r\n * @param {*} b\r\n * @returns {boolean} \r\n */\r\nexport const deepEqual = function (a, b) {\r\n    if (a === b) return true;\r\n    if ($.type(a) !== $.type(b)) return false;\r\n    if (typeof a === 'number' && typeof b === 'number' && isNaN(a) && isNaN(b)) return true;\r\n    if ($.isArray(a) && $.isArray(b) || $.type(a) === 'object' && $.type(b) === 'object') {\r\n        if (a.length !== b.length) return false;\r\n        for (var i in $.extend($.isArray(a) ? [] : {}, a, b)) {\r\n            if (typeof a[i] === 'undefined' || typeof b[i] === 'undefined') return false;\r\n            if (!deepEqual(a[i], b[i])) return false;\r\n        }\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n\r\n/**\r\n * \r\n * @param {jQuery} $target \r\n * @param {?jQuery} $source \r\n * @returns {boolean} \r\n */\r\nexport const copyText = function ($target, $source = null) {\r\n    if (!('execCommand' in document) || !$target.length) return false;\r\n    let copyText = $target.data('copy-text');\r\n    if (copyText) {\r\n        $target = $(`<span class=\"text-hide\">${copyText}</span>`).insertAfter($target);\r\n    }\r\n    let s = window.getSelection();\r\n    s.selectAllChildren($target.get(0));\r\n    let result = document.execCommand('copy');\r\n    s.removeAllRanges();\r\n    if (copyText) $target.remove();\r\n    if (result && $source) {\r\n        let msg = $source.data('copy-msg');\r\n        $source.attr('title', msg ? msg : '').on('hidden.bs.tooltip', function () {\r\n            $(this).tooltip('dispose');\r\n        }).tooltip('show');\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * \r\n * @param {string} name \r\n * @param {Array} list \r\n * @returns {number} -1\r\n */\r\nexport const inFollowOrBlockUserList = (name, list) => list.findIndex(data => data.name && data.name === name);\r\n\r\n/**\r\n * Opera\r\n * @returns {boolean} Opera\r\n */\r\nexport const isOpera = () => typeof window.opera !== 'undefined';\r\n\r\n/**\r\n * Edge\r\n * @returns {boolean} Edge\r\n */\r\nexport const isEdge = () => navigator.appVersion && navigator.appVersion.includes('Edge');\r\n"]}
{"version":3,"sources":["node_modules/.6.0.1@browser-pack/_prelude.js","public/static/src/js/app.js","public/static/src/js/module/config.js","public/static/src/js/module/configDialog.js","public/static/src/js/module/const.js","public/static/src/js/module/dialog.js","public/static/src/js/module/index.js","public/static/src/js/module/msg.js","public/static/src/js/module/other.js","public/static/src/js/module/post.js","public/static/src/js/module/public.js","public/static/src/js/module/read.js","public/static/src/js/module/util.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_config","_public","_index","_read","_post","_other","window","pageId","$","attr","validateRegisterField","init","preventCloseWindow","handleMainMenu","handleMainMenuLink","handleRollToTopOrBottomBtn","handleSearchDialog","fillCommonForumPanel","showEditCommonForumDialog","handlePageInput","handleAtTipsBtn","handleIndexThreadPanel","handleSelectBgImage","handleSelectBgColor","handleCustomBgStyle","gotoFloor","handleFastGotoFloorBtn","handleTuiThreadBtn","handleCopyFloorLinkBtn","handleFastReplyBtn","handleBlockFloorBtn","handleBuyThreadBtn","copyBuyThreadList","handleFloorImage","checkPostForm","bindFastSubmitShortcutKey","handleCopyCodeBtn","addSmileCode","bindMultiQuoteCheckClick","handleClearMultiQuoteDataBtn","click","handleMultiQuote","handleEditorBtns","handleAttachBtns","pageInfo","multiQuote","highlightUnReadAtTipsMsg","handleGameIntroSearchArea","tuiGameIntro","bindFavorPageBtnsClick","bindFriendPageBtnsClick","syncPerPageFloorNum","assignBirthdayField","handleUploadAvatarFileBtn","transferKfbAlert","bindMessageActionBtnsClick","tooltip","container","_util","Util","name","Config","perPageFloorNum","activeNewReplyPanel","activeTopRecommendPanel","activeForumPanel1","activeForumPanel2","commonForumList","defShowMsgDuration","read","extend","options","localStorage","JSON","parse","ex","type","isEmptyObject","normalize","write","getDifferenceSetOfObject","stringify","clear","removeItem","settings","each","key","value","_dialog","Dialog","show","dialogName","bodyContent","footerContent","create","Const","multiQuoteStorageName","atTipsTimeCookieName","prevAtTipsTimeCookieName","bgStyleCookieName","fid","availableForumList","id","title","arguments","undefined","style","html","$dialog","appendTo","on","close","keydown","keyCode","find","$this","this","closest","prop","end","checked","data","is","removeClass","addClass","css","height","outerHeight","triggerHandler","fadeIn","focus","fadeOut","remove","off","_const","time","cookieValue","getCookie","_const2","default","setCookie","currentDate","Date","getDate","tab","document","$target","target","targetPanel","typeName","includes","fileName","path","parent","confirm","alert","color","parseInt","prompt","$bg","trim","location","reload","test","toLowerCase","replace","duration","msg","clickable","preventable","$container","isFirst","destroy","$msg","preventDefault","text","hide","stopPropagation","slideDown","setTimeout","wait","slideUp","gjc","userName","timeString","prevString","index","curString","deleteCookie","val","keyword","searchType","cookieName","url","makeUrl","ajax","success","$num","num","error","complete","removeData","dataType","$form","submit","action","selectAll","selectReverse","$checked","change","matches","exec","year","month","day","syncConfig","isNaN","transferKfb","fixedDeposit","currentDeposit","_ret","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","split","Symbol","iterator","next","done","err","return","v","_typeof","_$checked","showValidationMsg","post","_ref","username","fail","trigger","_msg","Msg","textArea","get","_matches","selText","getSelText","addCode","size","codeType","$postType","$postTitle","getStrByteLen","$voteItemContent","$postContent","_length","$postGjc","$area","after","blur","$newAttachArea","totalNum","$lastAttachArea","insertAfter","$node","$relatedTarget","relatedTarget","_data","tid","quoteList","list","Object","values","_data2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","quote","push","keywords","Set","content","clearQueue","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_loop","_step2$value","_slicedToArray","add","queue","pid","floor","getTime","postContent","$countdownNum","dequeue","_iterator2","entries","concat","_toConsumableArray","join","_configDialog","ConfigDialog","maxHeight","documentElement","clientHeight","scroll","$btn","scrollTop","animate","$searchDialog","select","$searchKeyword","$method","Math","$current","maxPageNum","excludeParams","currentPageNum","href","ctrlKey","commonForumListHtml","_step$value","availableForumListHtml","elem","modal","$dragulaScriptPath","dragulaScriptPath","getScript","dragula","revertOnSpill","children","_step3$value","_step3$value$","_fid","addEventListener","returnValue","getCheckedMultiQuoteData","link","getHostNameUrl","copyText","$article","selectionStart","selectionEnd","price","$wait","verify","map","repeat","selectedIndex","naturalWidth","width","hashName","prev","hash","floorNum","safeId","$pre","decodeHtmlSpecialChar","date","prefix","cookiePrefix","cookie","encodeURI","toUTCString","regex","RegExp","match","decodeURI","flag","increment","unit","setFullYear","getFullYear","setMonth","getMonth","setDate","setHours","getHours","setMinutes","getMinutes","setSeconds","getSeconds","setMilliseconds","getMilliseconds","extractQueryStr","str","len","cLen","charCodeAt","protocol","host","startPos","indexOf","prePos","substring","params","Map","param","_param$split","_param$split2","set","buildQueryStr","queryStr","urlType","deepEqual","includeOtherParam","paramList","urlParam","delete","startsWith","pathname","baseFile","rootPath","getQueryParam","$nodes","$parent","inArray","$feedback","b","c","isArray","$source","getSelection","selectAllChildren","result","execCommand","removeAllRanges"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\nimport {init as initConfig} from './module/config';\r\n\r\nimport {\r\n    handleMainMenu,\r\n    handleMainMenuLink,\r\n    handleRollToTopOrBottomBtn,\r\n    handleSearchDialog,\r\n    handlePageInput,\r\n    bindFastSubmitShortcutKey,\r\n    showEditCommonForumDialog,\r\n    fillCommonForumPanel,\r\n    preventCloseWindow,\r\n} from './module/public';\r\n\r\nimport {\r\n    handleAtTipsBtn,\r\n    handleIndexThreadPanel,\r\n    handleSelectBgImage,\r\n    handleSelectBgColor,\r\n    handleCustomBgStyle\r\n} from './module/index';\r\n\r\nimport {\r\n    gotoFloor,\r\n    handleFastGotoFloorBtn,\r\n    handleTuiThreadBtn,\r\n    handleCopyFloorLinkBtn,\r\n    handleFastReplyBtn,\r\n    handleBlockFloorBtn,\r\n    handleBuyThreadBtn,\r\n    copyBuyThreadList,\r\n    handleFloorImage,\r\n    handleCopyCodeBtn,\r\n    bindMultiQuoteCheckClick,\r\n} from './module/read';\r\n\r\nimport {\r\n    checkPostForm,\r\n    addSmileCode,\r\n    handleEditorBtns,\r\n    handleAttachBtns,\r\n    handleMultiQuote,\r\n    handleClearMultiQuoteDataBtn,\r\n} from './module/post';\r\n\r\nimport {\r\n    highlightUnReadAtTipsMsg,\r\n    validateRegisterField,\r\n    handleGameIntroSearchArea,\r\n    tuiGameIntro,\r\n    bindFavorPageBtnsClick,\r\n    bindFriendPageBtnsClick,\r\n    syncPerPageFloorNum,\r\n    assignBirthdayField,\r\n    handleUploadAvatarFileBtn,\r\n    transferKfbAlert,\r\n    bindMessageActionBtnsClick,\r\n} from './module/other';\r\n\r\n// 页面ID\r\nwindow.pageId = $('body').attr('id');\r\n\r\n/**\r\n * 初始化\r\n */\r\n$(function () {\r\n    if (pageId === 'loginPage') return;\r\n    else if (pageId === 'registerPage') {\r\n        validateRegisterField();\r\n        return;\r\n    }\r\n    initConfig();\r\n\r\n    preventCloseWindow();\r\n    handleMainMenu();\r\n    handleMainMenuLink();\r\n    handleRollToTopOrBottomBtn();\r\n    handleSearchDialog();\r\n    fillCommonForumPanel();\r\n    showEditCommonForumDialog();\r\n    if ($('.page-input').length > 0) {\r\n        handlePageInput();\r\n    }\r\n    if (pageId === 'indexPage') {\r\n        handleAtTipsBtn();\r\n        handleIndexThreadPanel();\r\n        handleSelectBgImage();\r\n        handleSelectBgColor();\r\n        handleCustomBgStyle();\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        gotoFloor();\r\n        handleFastGotoFloorBtn();\r\n        handleTuiThreadBtn();\r\n        handleCopyFloorLinkBtn();\r\n        handleFastReplyBtn();\r\n        handleBlockFloorBtn();\r\n        handleBuyThreadBtn();\r\n        copyBuyThreadList();\r\n        handleFloorImage();\r\n        checkPostForm();\r\n        bindFastSubmitShortcutKey($('#postContent'));\r\n        handleCopyCodeBtn();\r\n        addSmileCode($('#postContent'));\r\n        bindMultiQuoteCheckClick();\r\n        handleClearMultiQuoteDataBtn();\r\n        $('.multi-reply-btn').click(() => {\r\n            handleMultiQuote(1);\r\n        });\r\n    }\r\n    else if (pageId === 'postPage') {\r\n        checkPostForm();\r\n        bindFastSubmitShortcutKey($('#postContent'));\r\n        handleEditorBtns();\r\n        addSmileCode($('#postContent'));\r\n        handleAttachBtns();\r\n        handleClearMultiQuoteDataBtn();\r\n        if (pageInfo.multiQuote) handleMultiQuote(2);\r\n    }\r\n    else if (pageId === 'gjcPage') {\r\n        highlightUnReadAtTipsMsg();\r\n    }\r\n    else if (pageId === 'gameIntroSearchPage') {\r\n        handleGameIntroSearchArea();\r\n    }\r\n    else if (pageId === 'gameIntroPage') {\r\n        tuiGameIntro('game');\r\n    }\r\n    else if (pageId === 'gameIntroCompanyPage') {\r\n        tuiGameIntro('company');\r\n    }\r\n    else if (pageId === 'gameIntroTypePage') {\r\n        tuiGameIntro('type');\r\n    }\r\n    else if (pageId === 'gameIntroPropertyPage') {\r\n        tuiGameIntro('property');\r\n    }\r\n    else if (pageId === 'favorPage') {\r\n        bindFavorPageBtnsClick();\r\n    }\r\n    else if (pageId === 'friendPage') {\r\n        bindFriendPageBtnsClick();\r\n    }\r\n    else if (pageId === 'modifyPage') {\r\n        syncPerPageFloorNum();\r\n        assignBirthdayField();\r\n        handleUploadAvatarFileBtn();\r\n    }\r\n    else if (pageId === 'bankPage') {\r\n        transferKfbAlert();\r\n    }\r\n    else if (pageId === 'messagePage') {\r\n        bindMessageActionBtnsClick();\r\n    }\r\n    else if (pageId === 'readMessagePage') {\r\n        handleFloorImage();\r\n        handleCopyCodeBtn();\r\n    }\r\n    else if (pageId === 'writeMessagePage') {\r\n        bindFastSubmitShortcutKey($('#msgContent'));\r\n        addSmileCode($('#msgContent'));\r\n    }\r\n    else if (pageId === 'messageBannedPage') {\r\n        bindFastSubmitShortcutKey($('[name=\"banidinfo\"]'));\r\n    }\r\n\r\n    //let tooltipStartTime = new Date();\r\n    $('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    //console.log(`tooltip初始化耗时：${new Date() - tooltipStartTime}ms`);\r\n});\r\n","/* 配置模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\n\r\n// 配置名称\r\nconst name = 'kf_config';\r\n\r\n/**\r\n * 配置类\r\n */\r\nexport const Config = {\r\n    // 主题每页楼层数量\r\n    perPageFloorNum: 0,\r\n    // 当前激活的最新回复面板\r\n    activeNewReplyPanel: '#galgameNewReplyPanel',\r\n    // 当前激活的当前推荐面板\r\n    activeTopRecommendPanel: '#galgameTopRecommendPanel',\r\n    // 当前激活的版块列表面板1\r\n    activeForumPanel1: '',\r\n    // 当前激活的版块列表面板2\r\n    activeForumPanel2: '',\r\n    // 常用版块列表\r\n    commonForumList: [],\r\n    // 默认的消息显示时间（秒），设置为-1表示永久显示\r\n    defShowMsgDuration: -1,\r\n};\r\n\r\n/**\r\n * 初始化\r\n */\r\nexport const init = function () {\r\n    window.Config = $.extend(true, {}, Config);\r\n    read();\r\n};\r\n\r\n/**\r\n * 读取设置\r\n */\r\nexport const read = function () {\r\n    let options = localStorage[name];\r\n    if (!options) return;\r\n    try {\r\n        options = JSON.parse(options);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!options || $.type(options) !== 'object' || $.isEmptyObject(options)) return;\r\n    options = normalize(options);\r\n    window.Config = $.extend(true, {}, Config, options);\r\n};\r\n\r\n/**\r\n * 写入设置\r\n */\r\nexport const write = function () {\r\n    let options = Util.getDifferenceSetOfObject(Config, window.Config);\r\n    localStorage[name] = JSON.stringify(options);\r\n};\r\n\r\n/**\r\n * 清空设置\r\n */\r\nexport const clear = function () {\r\n    localStorage.removeItem(name);\r\n};\r\n\r\n/**\r\n * 获取经过规范化的Config对象\r\n * @param {{}} options 待处理的Config对象\r\n * @returns {{}} 经过规范化的Config对象\r\n */\r\nconst normalize = function (options) {\r\n    var settings = {};\r\n    if ($.type(options) !== 'object') return settings;\r\n    $.each(options, (key, value) => {\r\n        if (key in Config && $.type(value) === $.type(Config[key])) {\r\n            settings[key] = value;\r\n        }\r\n    });\r\n    return settings;\r\n};\r\n","/* 设置对话框模块 */\r\n'use strict';\r\nimport * as Dialog from './dialog';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 显示设置对话框\r\n */\r\nexport const show = function () {\r\n    const dialogName = 'configDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<fieldset class=\"fieldset mb-1 py-sm\">\r\n  <legend>主题页面相关</legend>\r\n  <div class=\"form-group\">\r\n    <label>主题每页楼层数量</label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"主题页面中每页的楼层数量（用于电梯直达等功能），如果修改了论坛设置里的“文章列表每页个数”，请在此修改成相同的数目\">[?]</span>\r\n    <select class=\"custom-select form-control\" name=\"perPageFloorNum\">\r\n      <option value=\"10\">10</option><option value=\"20\">20</option><option value=\"30\">30</option>\r\n    </select>\r\n  </div>\r\n</fieldset>\r\n<fieldset class=\"fieldset mb-1 py-sm\">\r\n  <legend>其它设置</legend>\r\n  <div class=\"form-group\">\r\n    <label>默认消息显示时间</label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"默认的消息显示时间（秒），设置为-1表示永久显示，例：15\">[?]</span>\r\n    <input class=\"form-control\" name=\"defShowMsgDuration\" type=\"number\" min=\"-1\" required>\r\n  </div>\r\n</fieldset>\r\n<fieldset class=\"fieldset mb-1 py-sm\">\r\n  <legend>关注和屏蔽</legend>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"followUserEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openFollowUserDialog]\"> 关注用户\r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"开启关注用户的功能，所关注的用户将被加注记号，请点击详细设置管理关注用户\">[?]</span>\r\n    <a class=\"ml-1\" data-name=\"openFollowUserDialog\" href=\"#\" role=\"button\">详细设置&raquo;</a>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockUserEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openBlockUserDialog]\"> 屏蔽用户\r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"开启屏蔽用户的功能，你将看不见所屏蔽用户的发言，请点击详细设置管理屏蔽用户\">[?]</span>\r\n    <a class=\"ml-1\" data-name=\"openBlockUserDialog\" href=\"#\" role=\"button\">详细设置&raquo;</a>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockThreadEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openBlockThreadDialog]\"> 屏蔽主题\r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"开启屏蔽标题中包含指定关键字的主题的功能，请点击详细设置管理屏蔽关键字\">[?]</span>\r\n    <a class=\"ml-1\" data-name=\"openBlockThreadDialog\" href=\"#\" role=\"button\">详细设置&raquo;</a>\r\n  </div>\r\n</fieldset>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"button\">确定</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>`;\r\n    let $dialog = Dialog.create(dialogName, '助手设置', bodyContent, footerContent);\r\n    Dialog.show(dialogName);\r\n};\r\n","/* 常量模块 */\r\n'use strict';\r\n\r\n/**\r\n * 常量类\r\n */\r\nconst Const = {\r\n    // 存储多重引用数据的LocalStorage名称\r\n    multiQuoteStorageName: 'kf_multi_quote',\r\n    // at提醒时间的Cookie名称\r\n    atTipsTimeCookieName: 'at_tips_time',\r\n    // 上一次at提醒时间的Cookie名称\r\n    prevAtTipsTimeCookieName: 'prev_at_tips_time',\r\n    // 背景样式的Cookie名称\r\n    bgStyleCookieName: 'bg_style',\r\n    // 常用版块列表\r\n    commonForumList: [\r\n        {fid: 106, name: '新作动态'},\r\n        {fid: 41, name: '网盘下载'},\r\n        {fid: 16, name: '种子下载'},\r\n        {fid: 52, name: '游戏讨论'},\r\n        {fid: 84, name: '动漫讨论'},\r\n        {fid: 67, name: 'CG下载'},\r\n        {fid: 5, name: '自由讨论'},\r\n        {fid: 56, name: '个人日记'},\r\n        {fid: 57, name: '同人漫本'},\r\n    ],\r\n    // 可用版块列表\r\n    availableForumList: [\r\n        {fid: 106, name: '新作动态'},\r\n        {fid: 52, name: '游戏讨论'},\r\n        {fid: 16, name: '种子下载'},\r\n        {fid: 41, name: '网盘下载'},\r\n        {fid: 67, name: 'CG下载'},\r\n        {fid: 102, name: '游戏推荐'},\r\n        {fid: 24, name: '疑难互助'},\r\n        {fid: 57, name: '同人漫本'},\r\n        {fid: 84, name: '动漫讨论'},\r\n        {fid: 92, name: '动画共享'},\r\n        {fid: 127, name: '漫画小说'},\r\n        {fid: 68, name: '音乐共享'},\r\n        {fid: 163, name: 'LIVE共享'},\r\n        {fid: 182, name: '转载资源'},\r\n        {fid: 94, name: '原创绘画'},\r\n        {fid: 87, name: '宅物交流'},\r\n        {fid: 86, name: '电子产品'},\r\n        {fid: 115, name: '文字作品'},\r\n        {fid: 96, name: '图片来源'},\r\n        {fid: 36, name: '寻求资源'},\r\n        {fid: 5, name: '自由讨论'},\r\n        {fid: 56, name: '个人日记'},\r\n        {fid: 9, name: '我的关注'},\r\n        {fid: 4, name: '意见投诉'},\r\n        {fid: 93, name: '管理组区'},\r\n        {fid: 59, name: '原创组区'},\r\n        {fid: 125, name: '水楼林立'},\r\n        {fid: 181, name: '私人日记'},\r\n        {fid: 42, name: '旧期资料'},\r\n        {fid: 128, name: '作品判定'},\r\n        {fid: 98, name: '日本语版'},\r\n        {fid: 99, name: '意見箱'},\r\n        {fid: 112, name: '掲示板'},\r\n        {fid: 100, name: '創作感想'},\r\n    ],\r\n};\r\n\r\nexport default Const;\r\n","/* 对话框模块 */\r\n'use strict';\r\n\r\n/**\r\n * 创建对话框\r\n * @param {string} id 对话框ID\r\n * @param {string} title 对话框标题\r\n * @param {string} bodyContent 对话框主体内容\r\n * @param {string} footerContent 对话框底部内容\r\n * @param {string} style 对话框样式\r\n * @returns {jQuery} 对话框的jQuery对象\r\n */\r\nexport const create = function (id, title, bodyContent, footerContent = '', style = '') {\r\n    let html = `\r\n<div class=\"dialog-container\" id=\"${id}\" style=\"${style}\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\" aria-labelledby=\"${id}Title\">\r\n  <div class=\"container\" role=\"document\">\r\n    <form>\r\n      <div class=\"dialog-header\">\r\n        <button class=\"close\" data-dismiss=\"dialog\" type=\"button\" aria-label=\"关闭\">\r\n          <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n        <h5 class=\"dialog-title\" id=\"${id}Title\">${title}</h5>\r\n      </div>\r\n      <div class=\"dialog-body\">${bodyContent}</div>\r\n      <div class=\"dialog-footer\" ${!footerContent ? 'hidden' : ''}>${footerContent}</div>\r\n    </form>\r\n  </div>\r\n</div>`;\r\n    let $dialog = $(html).appendTo('body');\r\n    $dialog.on('click', '[data-dismiss=\"dialog\"]', () => close(id))\r\n        .on('click', '.tips', () => false)\r\n        .on('click', '.disabled-link', () => false)\r\n        .keydown(function (e) {\r\n            if (e.keyCode === 27) {\r\n                return close(id);\r\n            }\r\n        })\r\n        .find('legend [type=\"checkbox\"]')\r\n        .click(function () {\r\n            let $this = $(this);\r\n            $this.closest('fieldset').prop('disabled', !$this.prop('checked'));\r\n        }).end()\r\n        .find('input[data-disabled]')\r\n        .click(function () {\r\n            let $this = $(this);\r\n            let checked = $this.prop('checked');\r\n            $($this.data('disabled')).each(function () {\r\n                let $this = $(this);\r\n                if ($this.is('a')) {\r\n                    if (checked) $this.removeClass('disabled-link');\r\n                    else $this.addClass('disabled-link');\r\n                }\r\n                else {\r\n                    $this.prop('disabled', !checked);\r\n                }\r\n            });\r\n        }).end().find('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    $(window).on('resize.' + id, () => show(id));\r\n    return $dialog;\r\n};\r\n\r\n/**\r\n * 显示或调整对话框\r\n * @param {string} id 对话框ID\r\n */\r\nexport const show = function (id) {\r\n    let $dialog = $('#' + id);\r\n    if (!$dialog.length) return;\r\n    $dialog.find('.dialog-body')\r\n        .css('max-height', $(window).height() - $dialog.find('.dialog-header').outerHeight() - $dialog.find('.dialog-footer').outerHeight())\r\n        .end().find('legend [type=\"checkbox\"]')\r\n        .each(function () {\r\n            $(this).triggerHandler('click');\r\n        }).end().find('input[data-disabled]')\r\n        .each(function () {\r\n            $(this).triggerHandler('click');\r\n        });\r\n    $dialog.fadeIn('fast').find('.close:first').focus();\r\n};\r\n\r\n/**\r\n * 关闭对话框\r\n * @param {string} id 对话框ID\r\n * @returns {boolean} 返回false\r\n */\r\nexport const close = function (id) {\r\n    $('#' + id).fadeOut('fast', function () {\r\n        $(this).remove();\r\n    });\r\n    $(window).off('resize.' + id);\r\n    return false;\r\n};\r\n","/* 首页模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 处理首页的@提醒按钮\r\n */\r\nexport const handleAtTipsBtn = function () {\r\n    $('#atTips').click(function () {\r\n        let $this = $(this);\r\n        let time = $this.data('time');\r\n        let cookieValue = Util.getCookie(Const.atTipsTimeCookieName);\r\n        if (!time || time === cookieValue) return;\r\n        if (!cookieValue) {\r\n            let currentDate = (new Date()).getDate();\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, (currentDate < 10 ? '0' + currentDate : currentDate) + '日00时00分');\r\n        }\r\n        else if (cookieValue !== time) {\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, cookieValue);\r\n        }\r\n        Util.setCookie(Const.atTipsTimeCookieName, time, Util.getDate('+3d'));\r\n        $this.removeClass('btn-outline-danger').addClass('btn-outline-primary');\r\n    });\r\n};\r\n\r\n/**\r\n * 处理首页主题链接面板\r\n */\r\nexport const handleIndexThreadPanel = function () {\r\n    if (Config.activeNewReplyPanel) {\r\n        $(`a[data-toggle=\"tab\"][href=\"${Config.activeNewReplyPanel}\"]`).tab('show');\r\n    }\r\n    if (Config.activeTopRecommendPanel) {\r\n        $(`a[data-toggle=\"tab\"][href=\"${Config.activeTopRecommendPanel}\"]`).tab('show');\r\n    }\r\n\r\n    $(document).on('shown.bs.tab', 'a[data-toggle=\"tab\"]', function (e) {\r\n        let $target = $(e.target);\r\n        let targetPanel = $target.attr('href');\r\n        let typeName = '';\r\n        if (targetPanel.includes('NewReplyPanel')) typeName = 'activeNewReplyPanel';\r\n        else if (targetPanel.includes('TopRecommendPanel')) typeName = 'activeTopRecommendPanel';\r\n        if (typeName && Config[typeName] !== targetPanel) {\r\n            readConfig();\r\n            Config[typeName] = targetPanel;\r\n            writeConfig();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理选择页面背景图片\r\n */\r\nexport const handleSelectBgImage = function () {\r\n    $('#selectBgImage').on('click', '[data-id]', function () {\r\n        let $this = $(this);\r\n        let id = $this.data('id');\r\n        let fileName = $this.data('filename');\r\n        let path = $this.parent().data('path');\r\n        if (!id || !fileName || !path) return;\r\n        if (confirm('是否选择此背景图片？')) {\r\n            Util.setCookie(Const.bgStyleCookieName, id, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background-image', 'url(\"' + path + fileName + '\")');\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理选择页面背景颜色\r\n */\r\nexport const handleSelectBgColor = function () {\r\n    $('#selectBgImage').on('click', '[data-color]', function () {\r\n        let $this = $(this);\r\n        let color = $this.data('color');\r\n        if (!color) return;\r\n        if (confirm('是否选择此背景颜色？')) {\r\n            Util.setCookie(Const.bgStyleCookieName, color, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background', color);\r\n            alert('背景已更换');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理自定义背景样式\r\n */\r\nexport const handleCustomBgStyle = function () {\r\n    $('#customBgStyle').click(function () {\r\n        let value = Util.getCookie(Const.bgStyleCookieName);\r\n        if (!value || parseInt(value)) value = '';\r\n        value = prompt(\r\n            '请输入背景图片URL、颜色代码或CSS样式：\\n（例：http://xxx.com/abc.jpg 或 #fcfcfc，留空表示恢复默认背景）\\n' +\r\n            '（注：建议选择简洁、不花哨、偏浅色系的背景图片或颜色）',\r\n            value\r\n        );\r\n        if (value === null) return;\r\n        let $bg = $('body, .modal-content, .dialog-container');\r\n        if ($.trim(value) === '') {\r\n            Util.setCookie(Const.bgStyleCookieName, '', Util.getDate('-1d'));\r\n            alert('背景已恢复默认');\r\n            location.reload();\r\n        }\r\n        else if (/^https?:\\/\\/[^\"']+/.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $bg.css('background-image', 'url(\"' + value + '\")');\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n        else if (/^#[0-9a-f]{6}$/i.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $bg.css('background', value.toLowerCase());\r\n            alert('背景已更换');\r\n        }\r\n        else if (!/[<>{}]/.test(value)) {\r\n            value = value.replace(';', '');\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $bg.css('background', value);\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n        else {\r\n            alert('格式不正确');\r\n        }\r\n    });\r\n};\r\n","/* 消息模块 */\r\n'use strict';\r\n\r\n/**\r\n * 显示消息\r\n * @param {string|Object} options 消息或设置对象\r\n * @param {string} [options.msg] 消息\r\n * @param {number} [options.duration={@link Config.defShowMsgDuration}] 消息显示时间（秒），-1为永久显示\r\n * @param {boolean} [options.clickable=true] 消息框可否手动点击消除\r\n * @param {boolean} [options.preventable=false] 是否阻止点击网页上的其它元素\r\n * @param {number} [duration] 消息显示时间（秒），-1为永久显示\r\n * @example\r\n * show('<span class=\"mr-1\">使用道具</span><span class=\"text-item\">神秘系数<em class=\"text-warning\">+1</em></span>', -1);\r\n * show({\r\n *   msg: '<span class=\"mr-1\">抽取神秘盒子</span><span class=\"text-item\">KFB<em class=\"text-warning\">+8</em></span>',\r\n *   duration: 20,\r\n *   clickable: false,\r\n * });\r\n * @returns {jQuery} 消息框对象\r\n */\r\nexport const show = function (options, duration) {\r\n    let settings = {\r\n        msg: '',\r\n        duration: Config.defShowMsgDuration,\r\n        clickable: true,\r\n        preventable: false,\r\n    };\r\n    if ($.type(options) === 'object') {\r\n        $.extend(settings, options);\r\n    }\r\n    else {\r\n        settings.msg = options;\r\n        settings.duration = typeof duration === 'undefined' ? Config.defShowMsgDuration : duration;\r\n    }\r\n\r\n    let $container = $('.msg-container');\r\n    let isFirst = $container.length === 0;\r\n    if (!isFirst && !$('.mask').length) {\r\n        if ($container.height() >= $(window).height() * 0.8) {\r\n            destroy();\r\n            isFirst = true;\r\n        }\r\n    }\r\n    if (settings.preventable && !$('.mask').length) {\r\n        $('<div class=\"mask\"></div>').appendTo('body');\r\n    }\r\n    if (isFirst) {\r\n        $container = $('<div class=\"container msg-container\"></div>').appendTo('body');\r\n    }\r\n\r\n    let $msg = $(`<div class=\"msg\">${settings.msg}</div>`).appendTo($container);\r\n    $msg.on('click', '.stop-action', function (e) {\r\n        e.preventDefault();\r\n        $(this).text('正在停止&hellip;').closest('.msg').data('stop', true);\r\n    });\r\n    if (settings.clickable) {\r\n        $msg.css('cursor', 'pointer').click(function () {\r\n            hide($(this));\r\n        }).find('a').click(function (e) {\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n    if (settings.preventable) $msg.attr('preventable', true);\r\n    $msg.slideDown('normal');\r\n    if (settings.duration > -1) {\r\n        setTimeout(() => {\r\n            hide($msg);\r\n        }, settings.duration * 1000);\r\n    }\r\n    return $msg;\r\n};\r\n\r\n/**\r\n * 显示等待消息\r\n * @param {string} msg 消息\r\n * @param {boolean} preventable 是否阻止点击网页上的其它元素\r\n * @returns {jQuery} 消息框对象\r\n */\r\nexport const wait = function (msg, preventable = true) {\r\n    return show({msg, duration: -1, clickable: false, preventable});\r\n};\r\n\r\n/**\r\n * 隐藏指定消息框\r\n * @param {jQuery} $msg 消息框对象\r\n */\r\nexport const hide = function ($msg) {\r\n    $msg.slideUp('normal', function () {\r\n        remove($(this));\r\n    });\r\n};\r\n\r\n/**\r\n * 移除指定消息框\r\n * @param {jQuery} $msg 消息框对象\r\n */\r\nexport const remove = function ($msg) {\r\n    let $container = $msg.parent();\r\n    $msg.remove();\r\n    if (!$('.msg').length) {\r\n        $container.remove();\r\n        $('.mask').remove();\r\n    }\r\n    else if (!$('.msg[preventable]').length) {\r\n        $('.mask').remove();\r\n    }\r\n};\r\n\r\n/**\r\n * 销毁所有消息框\r\n */\r\nexport const destroy = function () {\r\n    $('.msg-container').remove();\r\n    $('.mask').remove();\r\n};\r\n","/* 其它模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 高亮关键词页面中未读的消息\r\n */\r\nexport const highlightUnReadAtTipsMsg = function () {\r\n    if (pageInfo.gjc !== pageInfo.userName) return;\r\n    let timeString = Util.getCookie(Const.prevAtTipsTimeCookieName);\r\n    if (!timeString || !/^\\d+日\\d+时\\d+分$/.test(timeString)) return;\r\n    let prevString = '';\r\n    $('.thread-list-item time').each(function (index) {\r\n        let $this = $(this);\r\n        let curString = $.trim($this.text());\r\n        if (index === 0) prevString = curString;\r\n        if (timeString < curString && prevString >= curString) {\r\n            $this.addClass('text-danger');\r\n            prevString = curString;\r\n        }\r\n        else return false;\r\n    });\r\n\r\n    $(document).on('click', '.thread-list-item .thread-link-item a', function () {\r\n        Util.deleteCookie(Const.prevAtTipsTimeCookieName);\r\n    });\r\n};\r\n\r\n/**\r\n * 处理游戏搜索区域\r\n */\r\nexport const handleGameIntroSearchArea = function () {\r\n    $('#gameSearchKeyword').val(pageInfo.keyword);\r\n    $('#gameSearchType').val(pageInfo.searchType);\r\n};\r\n\r\n/**\r\n * 推游戏介绍\r\n * @param {string} type 页面类型\r\n */\r\nexport const tuiGameIntro = function (type) {\r\n    let cookieName = '';\r\n    if (type === 'company') cookieName = 'g_intro_inc_tui_';\r\n    else if (type === 'type') cookieName = 'g_intro_adv_tui_';\r\n    else if (type === 'property') cookieName = 'g_intro_moe_tui_';\r\n    else cookieName = 'g_intro_tui_';\r\n    cookieName += pageInfo.id;\r\n    let url = Util.makeUrl('game_intro/' + type, `id=${pageInfo.id}&tui=1`);\r\n\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        if (Util.getCookie(cookieName, '')) {\r\n            alert('你在48小时内已经推过');\r\n            return;\r\n        }\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: url,\r\n            success: function () {\r\n                let $num = $this.find('span:first');\r\n                let num = parseInt($num.text());\r\n                $num.text('+1');\r\n                setTimeout(() => {\r\n                    $num.text(++num);\r\n                }, 1000);\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            },\r\n            dataType: 'html'\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定收藏夹页面按钮点击事件\r\n */\r\nexport const bindFavorPageBtnsClick = function () {\r\n    let $form = $('form[name=\"favorForm\"]');\r\n\r\n    $(document).on('click', '.remove-catalog', () => confirm('是否删除该目录？'));\r\n\r\n    $('#addCatalog').click(function (e) {\r\n        e.preventDefault();\r\n        let type = $.trim(prompt('请输入收藏夹目录名称：'));\r\n        if (!type) return;\r\n        $form.find('[name=\"job\"]').val('addtype');\r\n        $form.find('[name=\"type\"]').val(type);\r\n        $form.submit();\r\n    });\r\n\r\n    $('#favorActionBtns').on('click', 'button', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            Util.selectReverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否删除这${$checked.length}项？`)) {\r\n                $form.find('[name=\"job\"]').val('clear');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n\r\n    $('#convertCatalogDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let type = $(this).data('type');\r\n        let $checked = $('[name=\"delid[]\"]:checked');\r\n        if ($checked.length > 0 && confirm(`是否将这${$checked.length}项转换到指定目录？`)) {\r\n            $form.find('[name=\"job\"]').val('change');\r\n            $form.find('[name=\"type\"]').val(type);\r\n            $form.submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定好友列表页面按钮点击事件\r\n */\r\nexport const bindFriendPageBtnsClick = function () {\r\n    $('#friendActionBtns').on('click', '[type=\"button\"]', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"selid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            Util.selectReverse($('[name=\"selid[]\"]'));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 在账号设置页面里为生日字段赋值\r\n */\r\nexport const assignBirthdayField = function () {\r\n    $('#birthday').change(function () {\r\n        let value = $(this).val().trim();\r\n        let matches = /(\\d{4})-(\\d{1,2})-(\\d{1,2})/.exec(value);\r\n        let year = '', month = '', day = '';\r\n        if (matches) {\r\n            year = parseInt(matches[1]);\r\n            month = parseInt(matches[2]);\r\n            day = parseInt(matches[3]);\r\n        }\r\n        $('[name=\"proyear\"]').val(year);\r\n        $('[name=\"promonth\"]').val(month);\r\n        $('[name=\"proday\"]').val(day);\r\n    });\r\n};\r\n\r\n/**\r\n * 同步主题每页楼层数量的设置\r\n */\r\nexport const syncPerPageFloorNum = function () {\r\n    /**\r\n     * 同步设置\r\n     */\r\n    const syncConfig = function () {\r\n        let perPageFloorNum = parseInt($('[name=\"p_num\"]').val());\r\n        if (perPageFloorNum === 0) perPageFloorNum = 10;\r\n        if (!isNaN(perPageFloorNum) && perPageFloorNum !== Config.perPageFloorNum) {\r\n            Config.perPageFloorNum = perPageFloorNum;\r\n            writeConfig();\r\n        }\r\n    };\r\n\r\n    syncConfig();\r\n    $('#creator').submit(function () {\r\n        readConfig();\r\n        syncConfig();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理上传头像文件浏览按钮\r\n */\r\nexport const handleUploadAvatarFileBtn = function () {\r\n    $('#browseAvatar').change(function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png'].includes(matches[1].toLowerCase())) {\r\n            alert('头像图片类型不匹配');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 转账提醒\r\n */\r\nexport const transferKfbAlert = function () {\r\n    $('#transferKfbForm').submit(function () {\r\n        let $this = $(this);\r\n        let transferKfb = parseInt($this.find('[name=\"to_money\"]').val());\r\n        let fixedDeposit = parseInt($('#fixedDeposit').text());\r\n        let currentDeposit = parseInt($('#currentDeposit').text());\r\n        if (transferKfb > 0 && fixedDeposit > 0 && transferKfb > currentDeposit) {\r\n            if (!confirm('你的活期存款不足，转账金额将从定期存款里扣除，是否继续？')) {\r\n                return false;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定短消息页面操作按钮点击事件\r\n */\r\nexport const bindMessageActionBtnsClick = function () {\r\n    $('#messageActionBtns').on('click', 'button', function () {\r\n        let $form = $('#messageListForm');\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            Util.selectReverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectCustom') {\r\n            let title = $.trim(\r\n                prompt('请填写所要选择的包含指定字符串的短消息标题（可用|符号分隔多个标题）', '收到了他人转账的KFB|银行汇款通知|您的文章被评分|您的文章被删除')\r\n            );\r\n            if (!title) return;\r\n            $('[name=\"delid[]\"]').prop('checked', false);\r\n            $('a.thread-link').each(function () {\r\n                let $this = $(this);\r\n                for (let key of title.split('|')) {\r\n                    if ($this.text().toLowerCase().includes(key.toLowerCase())) {\r\n                        $this.parent().find('[name=\"delid[]\"]').prop('checked', true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else if (action === 'download') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否下载这${$checked.length}项？`)) {\r\n                $form.attr('action', '/message.php').find('[name=\"action\"]').val('down');\r\n                $form.submit();\r\n            }\r\n        }\r\n        else if (action === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否删除这${$checked.length}项？`)) {\r\n                $form.attr('action', Util.makeUrl('message/job')).find('[name=\"action\"]').val('del');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 验证注册页面字段\r\n */\r\nexport const validateRegisterField = function () {\r\n    $(document).on('change', 'input[name]', function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        let value = $this.val();\r\n        if (!value) {\r\n            Util.showValidationMsg($this, 'clear');\r\n            return;\r\n        }\r\n        if (name === 'regemail') {\r\n            Util.showValidationMsg($this, 'wait', '检查中，请稍等&hellip;');\r\n            $.post(Util.makeUrl('register/check'), 'username=' + value, ({type, msg, username}) => {\r\n                if ($this.val() === username) {\r\n                    Util.showValidationMsg($this, type, msg);\r\n                }\r\n            }).fail(() => {\r\n                Util.showValidationMsg($this, 'error', '响应失败');\r\n            });\r\n        }\r\n        else if (name === 'regpwd') {\r\n            if (value.length > 16 || value.length < 6) {\r\n                Util.showValidationMsg($this, 'error', '密码长度不正确');\r\n            }\r\n            else {\r\n                Util.showValidationMsg($this, 'clear');\r\n                $('[name=\"regpwdrepeat\"]').trigger('change');\r\n            }\r\n        }\r\n        else if (name === 'regpwdrepeat') {\r\n            if (value !== $('[name=\"regpwd\"]').val()) Util.showValidationMsg($this, 'error', '两次输入的密码不相符');\r\n            else Util.showValidationMsg($this, 'clear');\r\n        }\r\n    });\r\n\r\n    $('#registerForm').submit(function () {\r\n        if ($(this).find('.has-danger').length > 0) {\r\n            alert('请正确填写表单');\r\n            return false;\r\n        }\r\n    });\r\n};\r\n","/* 发帖模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport * as Msg from './msg';\r\n\r\n/**\r\n * 处理编辑器按钮\r\n */\r\nexport const handleEditorBtns = function () {\r\n    let textArea = $('#postContent').get(0);\r\n\r\n    // 编辑器按钮\r\n    $(document).on('click', '.editor-btn-group button[data-action]', function () {\r\n        let action = $(this).data('action');\r\n        let value = '';\r\n        switch (action) {\r\n            case 'link':\r\n                value = prompt('请输入链接URL：', 'http://');\r\n                break;\r\n            case 'img':\r\n                value = prompt('请输入图片URL：', 'http://');\r\n                break;\r\n            case 'sell':\r\n                value = prompt('请输入出售金额：', 1);\r\n                break;\r\n            case 'hide':\r\n                value = prompt('请输入神秘等级：', 1);\r\n                break;\r\n            case 'audio': {\r\n                value = prompt('请输入HTML5音频实际地址：\\n（可直接输入网易云音乐或虾米的单曲地址，将自动转换为外链地址）', 'http://');\r\n                let matches = /^https?:\\/\\/music\\.163\\.com\\/(?:#\\/)?song\\?id=(\\d+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/163/${matches[1]}.mp3`;\r\n                matches = /^https?:\\/\\/www\\.xiami\\.com\\/song\\/(\\d+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/xiami/${matches[1]}.mp3`;\r\n            }\r\n                break;\r\n            case 'video': {\r\n                value = prompt('请输入HTML5视频实际地址：\\n（可直接输入YouTube视频页面的地址，将自动转换为外链地址）', 'http://');\r\n                let matches = /^https?:\\/\\/(?:www\\.)?youtube\\.com\\/watch\\?v=([\\w\\-]+)/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n                matches = /^https?:\\/\\/youtu\\.be\\/([\\w\\-]+)$/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n            }\r\n                break;\r\n        }\r\n        if (value === null) return;\r\n\r\n        let selText = '';\r\n        let code = '';\r\n        switch (action) {\r\n            case 'link':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[url=${value}]${selText}[/url]`;\r\n                break;\r\n            case 'img':\r\n                code = `[img]${value}[/img]`;\r\n                break;\r\n            case 'quote':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[quote]${selText}[/quote]`;\r\n                break;\r\n            case 'code':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[code]${selText}[/code]`;\r\n                break;\r\n            case 'sell':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sell=${value}]${selText}[/sell]`;\r\n                break;\r\n            case 'hide':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[hide=${value}]${selText}[/hide]`;\r\n                break;\r\n            case 'bold':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[b]${selText}[/b]`;\r\n                break;\r\n            case 'italic':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[i]${selText}[/i]`;\r\n                break;\r\n            case 'underline':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[u]${selText}[/u]`;\r\n                break;\r\n            case 'strike':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[strike]${selText}[/strike]`;\r\n                break;\r\n            case 'super':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sup]${selText}[/sup]`;\r\n                break;\r\n            case 'sub':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sub]${selText}[/sub]`;\r\n                break;\r\n            case 'horizontal':\r\n                code = `[hr]`;\r\n                break;\r\n            case 'align-left':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=left]${selText}[/align]`;\r\n                break;\r\n            case 'align-center':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=center]${selText}[/align]`;\r\n                break;\r\n            case 'align-right':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=right]${selText}[/align]`;\r\n                break;\r\n            case 'fly':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[fly]${selText}[/fly]`;\r\n                break;\r\n            case 'audio':\r\n                code = `[audio]${value}[/audio]`;\r\n                break;\r\n            case 'video':\r\n                code = `[video]${value}[/video]`;\r\n                break;\r\n        }\r\n        if (!code) return;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // 字号下拉菜单\r\n    $('#fontSizeDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let size = $(this).data('size');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[size=${size}]${selText}[/size]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // 颜色、背景颜色下拉菜单\r\n    $('#colorDropdownMenu, #bgColorDropdownMenu').on('click', 'span', function () {\r\n        let $this = $(this);\r\n        let codeType = $this.parent().is('#bgColorDropdownMenu') ? 'backcolor' : 'color';\r\n        let color = $this.data('color');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[${codeType}=${color}]${selText}[/${codeType}]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 检查发帖表单\r\n */\r\nexport const checkPostForm = function () {\r\n    $('#postForm').submit(function () {\r\n        let $postType = $('#postType');\r\n        if ($postType.length > 0 && !$postType.val()) {\r\n            alert('没有选择主题分类');\r\n            $postType.focus();\r\n            return false;\r\n        }\r\n\r\n        let $postTitle = $('#postTitle');\r\n        if ($postTitle.length > 0) {\r\n            let length = Util.getStrByteLen($postTitle.val());\r\n            if (!length) {\r\n                alert('标题不能为空');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n            else if (length > 100) {\r\n                alert('标题超过最大长度 100 个字节');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $voteItemContent = $('#voteItemContent');\r\n        if ($voteItemContent.length > 0) {\r\n            if (!$voteItemContent.val().trim()) {\r\n                alert('投票选项不能为空');\r\n                $voteItemContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postContent = $('#postContent');\r\n        if ($postContent.length > 0) {\r\n            let length = Util.getStrByteLen($postContent.val().trim());\r\n            if (length < 12) {\r\n                alert('文章内容少于 12 个字节');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n            else if (length > 50000) {\r\n                alert('文章内容大于 50000 个字节');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postGjc = $('#postGjc');\r\n        if ($postGjc.length > 0 && pageInfo.action === 'new' && !$postGjc.val().trim()) {\r\n            alert('请在内容文本框的下方填写关键词，以方便搜索，也可以在标题中选择任意一个词填入');\r\n            $postGjc.focus();\r\n            return false;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理附件按钮\r\n */\r\nexport const handleAttachBtns = function () {\r\n    $(document).on('click', '.attach-area a[data-action]', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let $area = $this.closest('.attach-area');\r\n        let action = $this.data('action');\r\n        let id = $area.data('id');\r\n        if (!id) return;\r\n        if (action === 'insert') {\r\n            let type = $this.data('type');\r\n            let textArea = $('#postContent').get(0);\r\n            let code = `[${type === 'new' ? 'upload' : 'attachment'}=${id}]`;\r\n            Util.addCode(textArea, code);\r\n            textArea.focus();\r\n        }\r\n        else if (action === 'update') {\r\n            $area.find('.attach-info').prop('hidden', true).after(\r\n                `<label><input name=\"replace_${id}\" type=\"file\" aria-label=\"选择附件\"></label>`\r\n            );\r\n            $this.data('action', 'cancel').text('取消').blur();\r\n            if (!$(document).data('attachUpdateAlert')) {\r\n                alert('本反向代理服务器为了提高性能对图片设置了缓存，更新附件图片后可能需等待最多30分钟才能看到效果');\r\n                $(document).data('attachUpdateAlert', true);\r\n            }\r\n        }\r\n        else if (action === 'cancel') {\r\n            $area.find('.attach-info').prop('hidden', false).next('label').remove();\r\n            $this.data('action', 'update').text('更新').blur();\r\n        }\r\n        else if (action === 'delete') {\r\n            $area.remove();\r\n        }\r\n    });\r\n\r\n    $(document).on('change', '[type=\"file\"]', function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png', 'torrent'].includes(matches[1].toLowerCase())) {\r\n            alert('附件类型不匹配');\r\n            return;\r\n        }\r\n\r\n        let type = $this.data('type');\r\n        if (type === 'new') {\r\n            $this.removeData('type').parent().next().prop('hidden', false);\r\n\r\n            let $newAttachArea = $('#newAttachArea');\r\n            let totalNum = $newAttachArea.find('[type=\"file\"]').length;\r\n            if (totalNum >= 5) return;\r\n            let $lastAttachArea = $newAttachArea.find('[type=\"file\"]:last').closest('.attach-area');\r\n            let id = parseInt($lastAttachArea.data('id'));\r\n            if (!id) return;\r\n            id++;\r\n            $(`\r\n<div class=\"form-group row font-size-sm attach-area\" data-id=\"${id}\">\r\n  <div class=\"col-xs-12 col-form-label\">\r\n    <label>\r\n      <input name=\"attachment_${id}\" data-type=\"new\" type=\"file\" aria-label=\"选择附件\">\r\n    </label>\r\n    <span hidden>\r\n      <a data-action=\"insert\" data-type=\"new\" href=\"#\">插入</a>&nbsp;\r\n      <a data-action=\"delete\" href=\"#\">删除</a>\r\n    </span>\r\n  </div>\r\n  <div class=\"col-xs-4\">\r\n    <label class=\"sr-only\" for=\"atc_downrvrc${id}\">神秘系数</label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_downrvrc${id}\" name=\"atc_downrvrc${id}\" data-toggle=\"tooltip\" \r\ntype=\"number\" value=\"0\" min=\"0\" title=\"神秘系数\" placeholder=\"神秘系数\">\r\n  </div>\r\n  <div class=\"col-xs-8\">\r\n    <label class=\"sr-only\" for=\"atc_desc${id}\">描述</label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_desc${id}\" name=\"atc_desc${id}\" data-toggle=\"tooltip\" type=\"text\" \r\ntitle=\"描述\" placeholder=\"描述\">\r\n  </div>\r\n</div>\r\n`).insertAfter($lastAttachArea).find('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 插入表情代码\r\n * @param {jQuery} $node 想要绑定的节点的jQuery对象\r\n */\r\nexport const addSmileCode = function ($node) {\r\n    $('.smile-panel').on('click', 'img', function () {\r\n        $('.smile-panel').addClass('open');\r\n        let textArea = $node.get(0);\r\n        if (!textArea) return;\r\n        let code = `[s:${$(this).data('id')}]`;\r\n        Util.addCode(textArea, code, '');\r\n        textArea.blur();\r\n    }).parent().on('shown.bs.dropdown', function () {\r\n        $('.smile-panel img').each(function () {\r\n            let $this = $(this);\r\n            if (!$this.attr('src')) {\r\n                $this.attr('src', $this.data('src'));\r\n            }\r\n        });\r\n    }).on('hide.bs.dropdown', function (e) {\r\n        let $relatedTarget = $(e.relatedTarget);\r\n        if (!$relatedTarget.data('open')) $relatedTarget.removeData('open');\r\n        else return e.preventDefault();\r\n    });\r\n\r\n    $('#smileDropdownBtn').click(function () {\r\n        let $this = $(this);\r\n        $this.data('open', !$this.data('open'));\r\n    });\r\n};\r\n\r\n/**\r\n * 处理多重回复和多重引用\r\n * @param {number} type 处理类型，1：多重回复；2：多重引用\r\n */\r\nexport const handleMultiQuote = function (type = 1) {\r\n    let data = localStorage[Const.multiQuoteStorageName];\r\n    if (!data) return;\r\n    try {\r\n        data = JSON.parse(data);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) return;\r\n    let {tid, quoteList} = data;\r\n    if (!pageInfo.tid || tid !== pageInfo.tid || $.type(quoteList) !== 'object') return;\r\n    if (type === 2 && !pageInfo.fid) return;\r\n    let list = [];\r\n    for (let data of Object.values(quoteList)) {\r\n        if ($.type(data) !== 'array') continue;\r\n        for (let quote of data) {\r\n            list.push(quote);\r\n        }\r\n    }\r\n    if (!list.length) {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        return;\r\n    }\r\n\r\n    let keywords = new Set();\r\n    let content = '';\r\n    if (type === 2) {\r\n        Msg.wait(`<span class=\"mr-1\">正在获取引用内容中&hellip;</span>剩余：<em class=\"text-warning countdown-num\">${list.length}</em>`);\r\n        $(document).clearQueue('MultiQuote');\r\n    }\r\n    for (let [index, quote] of list.entries()) {\r\n        if (!('floor' in quote) || !('pid' in quote)) continue;\r\n        keywords.add(quote.userName);\r\n        if (type === 2) {\r\n            $(document).queue('MultiQuote', function () {\r\n                $.get(Util.makeUrl(\r\n                    'post/index',\r\n                    `action=quote&fid=${pageInfo.fid}&tid=${tid}&pid=${quote.pid}&article=${quote.floor}&t=${new Date().getTime()}`\r\n                ), function ({postContent}) {\r\n                    content += postContent ? postContent + (index === list.length - 1 ? '' : '\\n') : '';\r\n                    let $countdownNum = $('.countdown-num:last');\r\n                    $countdownNum.text(parseInt($countdownNum.text()) - 1);\r\n                    if (index === list.length - 1) {\r\n                        Msg.destroy();\r\n                        $('#postContent').val(content).focus();\r\n                    }\r\n                    else {\r\n                        setTimeout(function () {\r\n                            $(document).dequeue('MultiQuote');\r\n                        }, 100);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            content += `[quote]回 ${quote.floor}楼(${quote.userName}) 的帖子[/quote]\\n`;\r\n        }\r\n    }\r\n    $('[name=\"diy_guanjianci\"]').val([...keywords].join(','));\r\n    $('#postForm').submit(function () {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n    });\r\n    if (type === 2) $(document).dequeue('MultiQuote');\r\n    else $('#postContent').val(content).focus();\r\n};\r\n\r\n/**\r\n * 处理清除多重引用数据按钮\r\n */\r\nexport const handleClearMultiQuoteDataBtn = function () {\r\n    $('.clear-multi-quote-data-btn').click(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('是否清除多重引用数据？')) return;\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        $('[name=\"diy_guanjianci\"]').val('');\r\n        $('#postContent').val('');\r\n    });\r\n};\r\n","/* 公共模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\nimport * as ConfigDialog from './configDialog';\r\n\r\n/**\r\n * 处理主菜单\r\n */\r\nexport const handleMainMenu = function () {\r\n    $('#mainMenuTogglerBtn').click(function () {\r\n        let maxHeight = document.documentElement.clientHeight - $(this).closest('.navbar').outerHeight();\r\n        if (maxHeight > 0) {\r\n            $('#mainMenu').css('max-height', maxHeight + 'px');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理主菜单链接\r\n */\r\nexport const handleMainMenuLink = function () {\r\n    $('#mainMenu').find('[data-name=\"openConfigDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        $('#mainMenuTogglerBtn').click();\r\n        ConfigDialog.show();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理滚动到页顶/页底按钮\r\n */\r\nexport const handleRollToTopOrBottomBtn = function () {\r\n    $(window).scroll(function () {\r\n        let $btn = $('#rollToTopOrBottom');\r\n        if ($(window).scrollTop() > 640) {\r\n            if ($btn.data('direction') === 'top') return;\r\n            $btn.data('direction', 'top').attr('aria-label', '滚动到页顶')\r\n                .find('i').removeClass('fa-chevron-down').addClass('fa-chevron-up');\r\n        }\r\n        else {\r\n            if ($btn.data('direction') === 'bottom') return;\r\n            $btn.data('direction', 'bottom').attr('aria-label', '滚动到页底')\r\n                .find('i').removeClass('fa-chevron-up').addClass('fa-chevron-down');\r\n        }\r\n    });\r\n\r\n    $('#rollToTopOrBottom').click(function () {\r\n        let scrollTop = $(this).data('direction') === 'bottom' ? $('body').height() : 0;\r\n        $('body, html').animate({scrollTop: scrollTop});\r\n    });\r\n};\r\n\r\n/**\r\n * 处理搜索对话框\r\n */\r\nexport const handleSearchDialog = function () {\r\n    let $searchDialog = $('#searchDialog');\r\n\r\n    $searchDialog.on('shown.bs.modal', function () {\r\n        $('#searchKeyword').select().focus();\r\n    }).find('form').submit(function () {\r\n        let $this = $(this);\r\n        let $searchKeyword = $this.find('#searchKeyword');\r\n        let searchType = $this.find('#searchType').val();\r\n        let keyword = $.trim($searchKeyword.val());\r\n        if (searchType === 'gjc') {\r\n            $this.attr('action', Util.makeUrl('gjc/' + keyword));\r\n        }\r\n        else if (searchType === 'username') {\r\n            $this.attr('action', Util.makeUrl('user/username/' + keyword));\r\n        }\r\n        else {\r\n            $this.attr('action', Util.makeUrl('search'));\r\n            $searchKeyword.attr('name', searchType === 'author' ? 'pwuser' : 'keyword');\r\n            if (searchType === 'title') {\r\n                if (keyword.length && Util.getStrByteLen(keyword) <= 2) {\r\n                    let $method = $this.find('[name=\"method\"]');\r\n                    $method.val('OR');\r\n                    $searchKeyword.val(keyword + ' ' + Math.floor(new Date().getTime() / 1000));\r\n                    setTimeout(() => {\r\n                        $searchKeyword.val(keyword);\r\n                        $method.val('AND');\r\n                    }, 200);\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    $searchDialog.find('[name=\"searchRange\"]').on('click', function () {\r\n        let value = 'all';\r\n        if ($(this).val() === 'current') value = pageInfo.fid;\r\n        $searchDialog.find('[name=\"f_fid\"]').val(value);\r\n    });\r\n\r\n    let $current = $searchDialog.find('[name=\"searchRange\"][value=\"current\"]');\r\n    $searchDialog.find('#searchType').change(function () {\r\n        let searchType = $(this).val();\r\n        if (!$current.data('enabled')) return;\r\n        $current.prop('disabled', searchType === 'gjc' || searchType === 'username');\r\n    });\r\n\r\n    if (pageId === 'threadPage' || pageId === 'readPage') {\r\n        $current.prop('disabled', false).data('enabled', true).click();\r\n    }\r\n};\r\n\r\n/**\r\n * 处理分页导航\r\n */\r\nexport const handlePageInput = function () {\r\n    $(document).on('click', '.page-input', function (e) {\r\n        e.preventDefault();\r\n        if (pageInfo.maxPageNum && pageInfo.maxPageNum <= 1) return;\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let excludeParams = $(this).data('exclude');\r\n        if (excludeParams) excludeParams = excludeParams.split(',');\r\n        else excludeParams = [];\r\n        let num = parseInt(\r\n            prompt(`要跳转到第几页？${pageInfo.maxPageNum ? `（共${pageInfo.maxPageNum}页）` : ''}`, pageInfo.currentPageNum)\r\n        );\r\n        if (num && num > 0) {\r\n            location.href = Util.makeUrl(action, 'page=' + num, true, excludeParams);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定快速提交的快捷键\r\n * @param {jQuery} $node 想要绑定的节点的jQuery对象\r\n */\r\nexport const bindFastSubmitShortcutKey = function ($node) {\r\n    $node.keydown(function (e) {\r\n        if (e.keyCode === 13 && e.ctrlKey) {\r\n            $(this).closest('form').submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 显示编辑常用版块对话框\r\n */\r\nexport const showEditCommonForumDialog = function () {\r\n    $(document).on('click', '.edit-common-forum-btn', function (e) {\r\n        e.preventDefault();\r\n        readConfig();\r\n\r\n        let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n        let commonForumListHtml = '';\r\n        for (let {fid, name} of commonForumList) {\r\n            commonForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n        let availableForumListHtml = '';\r\n        for (let {fid, name} of Const.availableForumList) {\r\n            if (commonForumList.find(elem => elem.fid === fid)) continue;\r\n            availableForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n\r\n        let $dialog = $(`\r\n<div class=\"modal fade\" id=\"editCommonForumDialog\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"editCommonForumDialogTitle\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <button class=\"close\" data-dismiss=\"modal\" type=\"button\" aria-label=\"关闭\">\r\n          <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n        <h4 class=\"modal-title\" id=\"editCommonForumDialogTitle\">常用版块</h4>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <fieldset class=\"fieldset mb-1 p-sm\">\r\n          <legend>常用版块</legend>\r\n          <div class=\"edit-forum-list\" id=\"editCommonForumList\">${commonForumListHtml}</div>\r\n        </fieldset>\r\n        <fieldset class=\"fieldset mb-1 p-sm\">\r\n          <legend>可用版块</legend>\r\n          <div class=\"edit-forum-list\" id=\"editAvailableForumList\">${availableForumListHtml}</div>\r\n        </fieldset>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button class=\"btn btn-primary\" data-action=\"save\" type=\"button\">保存</button>\r\n        <button class=\"btn btn-secondary\" data-dismiss=\"modal\" type=\"button\">取消</button>\r\n        <button class=\"btn btn-danger\" data-action=\"reset\" type=\"button\">重置</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n`).appendTo('body').modal('show');\r\n\r\n        let $dragulaScriptPath = $('[name=\"dragulaScriptPath\"]');\r\n        let dragulaScriptPath = $dragulaScriptPath.val();\r\n        if (dragulaScriptPath) {\r\n            $.getScript(dragulaScriptPath, () => dragula($dialog.find('.edit-forum-list').get(), {revertOnSpill: true}));\r\n            $dragulaScriptPath.val('');\r\n        }\r\n        else dragula($dialog.find('.edit-forum-list').get(), {revertOnSpill: true});\r\n\r\n        $dialog.on('hidden.bs.modal', function () {\r\n            $(this).remove();\r\n        }).find('[data-action=\"save\"]').click(function () {\r\n            Config.commonForumList = [];\r\n            $('#editCommonForumList').children('.btn').each(function () {\r\n                let $this = $(this);\r\n                let fid = parseInt($this.data('fid'));\r\n                let name = $this.text().trim();\r\n                if (!fid || !name) return;\r\n                Config.commonForumList.push({fid: fid, name: name});\r\n            });\r\n            writeConfig();\r\n            alert('设置已保存');\r\n            $dialog.modal('hide');\r\n            location.reload();\r\n        }).end().find('[data-action=\"reset\"]').click(function () {\r\n            if (!confirm('是否重置？')) return;\r\n            Config.commonForumList = [];\r\n            writeConfig();\r\n            alert('设置已重置');\r\n            $dialog.modal('hide');\r\n            location.reload();\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 填充常用版块面板\r\n */\r\nexport const fillCommonForumPanel = function () {\r\n    let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n    let html = '';\r\n    for (let [index, {fid, name}] of commonForumList.entries()) {\r\n        if (index === 0 || index % 3 === 0) html += '<div class=\"row mb-1\">';\r\n        html += `\r\n<div class=\"col-xs-4\">\r\n  <a class=\"btn btn-outline-primary btn-block\" href=\"${Util.makeUrl('thread')}/${fid}\">${name}</a>\r\n</div>\r\n`;\r\n        if (index === commonForumList.length - 1 || index % 3 === 2) html += '</div>';\r\n    }\r\n    $('.common-forum-panel').html(html);\r\n};\r\n\r\n/**\r\n * 在操作进行时阻止关闭页面\r\n */\r\nexport const preventCloseWindow = function () {\r\n    window.addEventListener(\"beforeunload\", function (e) {\r\n        if ($('.mask').length > 0) {\r\n            let msg = '正在进行操作中，确定要关闭页面吗？';\r\n            e.returnValue = msg;\r\n            return msg;\r\n        }\r\n    });\r\n};\r\n","/* 主题模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {write as writeConfig} from './config';\r\nimport * as Msg from './msg';\r\n\r\n/**\r\n * 处理复制楼层跳转链接按钮\r\n */\r\nexport const handleCopyFloorLinkBtn = function () {\r\n    $(document).on('click', '.floor-num', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let link = Util.getHostNameUrl() + $this.attr('href');\r\n        $this.data('copy-text', link);\r\n        if (!Util.copyText($this, $this)) {\r\n            prompt('本楼的跳转链接：', link);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理快速回复按钮\r\n */\r\nexport const handleFastReplyBtn = function () {\r\n    $(document).on('click', '.fast-reply-btn', function (e) {\r\n        e.preventDefault();\r\n        let $article = $(this).closest('article');\r\n        let floor = $article.data('floor');\r\n        let userName = $article.data('username');\r\n        $('#postGjc').val(userName);\r\n        let postContent = $('#postContent').get(0);\r\n        postContent.value = `[quote]回 ${floor}楼(${userName}) 的帖子[/quote]\\n`;\r\n        postContent.selectionStart = postContent.value.length;\r\n        postContent.selectionEnd = postContent.value.length;\r\n        postContent.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理屏蔽回帖按钮\r\n */\r\nexport const handleBlockFloorBtn = function () {\r\n    $(document).on('click', '.block-floor', () => confirm('确认要屏蔽该回帖？本操作不可恢复！（屏蔽后该回帖将对大家不可见）'));\r\n};\r\n\r\n/**\r\n * 处理购买帖子按钮\r\n */\r\nexport const handleBuyThreadBtn = function () {\r\n    $(document).on('click', '.buy-thread-btn', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let pid = $this.data('pid');\r\n        let price = $this.data('price');\r\n        if (price > 5 && !confirm(`此贴售价${price}KFB，是否购买？`)) return;\r\n        let $wait = Msg.wait('正在购买帖子&hellip;');\r\n        $.get(Util.makeUrl('job/buytopic', `tid=${pageInfo.tid}&pid=${pid}&verify=${pageInfo.verify}`),\r\n            function ({msg}) {\r\n                Msg.remove($wait);\r\n                if (msg === '操作完成') {\r\n                    location.reload();\r\n                }\r\n                else if (msg.includes('您已经购买此帖')) {\r\n                    alert('你已经购买过此帖');\r\n                    location.reload();\r\n                }\r\n                else {\r\n                    alert('帖子购买失败');\r\n                }\r\n            });\r\n    });\r\n};\r\n\r\n/**\r\n * 复制购买人名单\r\n */\r\nexport const copyBuyThreadList = function () {\r\n    $(document).on('change', '.buy-thread-list', function () {\r\n        let $this = $(this);\r\n        if ($this.val() !== 'copyList') return;\r\n        let list = $this.find('option').map(function (index) {\r\n            let name = $(this).text();\r\n            if (index === 0 || index === 1 || name === '-'.repeat(11)) return null;\r\n            else return name;\r\n        }).get().join('\\n');\r\n        if (!list) {\r\n            alert('暂时无人购买');\r\n            $this.get(0).selectedIndex = 0;\r\n            return;\r\n        }\r\n        $('#buyThreadListContent').val(list);\r\n        $('#buyThreadListDialog').modal('show');\r\n        $this.get(0).selectedIndex = 0;\r\n    });\r\n\r\n    $('#buyThreadListDialog').on('shown.bs.modal', function () {\r\n        $('#buyThreadListContent').select().focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理楼层内的图片\r\n */\r\nexport const handleFloorImage = function () {\r\n    $(document).on('click', '.img', function () {\r\n        let $this = $(this);\r\n        if ($this.parent().is('a') || this.naturalWidth <= $this.closest('.read-content').width()) return;\r\n        location.href = $this.attr('src');\r\n    });\r\n};\r\n\r\n/**\r\n * 跳转到指定楼层\r\n */\r\nexport const gotoFloor = function () {\r\n    if (pageInfo.floor && pageInfo.floor > 0) {\r\n        let hashName = $(`article[data-floor=\"${pageInfo.floor}\"]`).prev('a').attr('name');\r\n        if (hashName) location.hash = '#' + hashName;\r\n    }\r\n};\r\n\r\n/**\r\n * 处理快速跳转到指定楼层按钮\r\n */\r\nexport const handleFastGotoFloorBtn = function () {\r\n    $('.fast-goto-floor').click(function (e) {\r\n        e.preventDefault();\r\n        if (!Config.perPageFloorNum) {\r\n            let floorNum = parseInt(\r\n                prompt('你的论坛设置里“文章列表每页个数”为多少（10、20、30）？\\n注：如修改了论坛中的此项设置，请访问账号设置页面即可自动同步本地设置', 10)\r\n            );\r\n            if ([10, 20, 30].includes(floorNum)) {\r\n                Config.perPageFloorNum = floorNum;\r\n                writeConfig();\r\n            }\r\n            else return;\r\n        }\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let floor = parseInt(prompt('你要跳转到哪一层楼？'));\r\n        if (!floor || floor <= 0) return;\r\n        location.href = Util.makeUrl(action, `page=${Math.floor(floor / Config.perPageFloorNum) + 1}&floor=${floor}`);\r\n    });\r\n};\r\n\r\n/**\r\n * 处理推帖子按钮\r\n */\r\nexport const handleTuiThreadBtn = function () {\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/diy_read_tui.php',\r\n            data: `tid=${pageInfo.tid}&safeid=${pageInfo.safeId}`,\r\n            success: function (msg) {\r\n                let matches = /<span.+?\\+\\d+!<\\/span>\\s*(\\d+)/i.exec(msg);\r\n                if (matches) {\r\n                    let $num = $this.find('span:first');\r\n                    $num.text('+1');\r\n                    setTimeout(() => {\r\n                        $num.text(matches[1]);\r\n                    }, 1000);\r\n                }\r\n                else if (/已推过/.test(msg)) {\r\n                    alert('已推过');\r\n                }\r\n                else {\r\n                    alert('操作失败');\r\n                }\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 处理复制代码按钮\r\n */\r\nexport const handleCopyCodeBtn = function () {\r\n    $(document).on('click', '.copy-code', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if (Util.copyText($this.next('pre'), $this)) return;\r\n\r\n        let code = $this.data('code');\r\n        if (code) {\r\n            $this.text('复制代码').removeData('code');\r\n            $this.next('textarea').remove();\r\n            $this.after(`<pre class=\"pre-scrollable\">${code}</pre>`);\r\n        }\r\n        else {\r\n            let $pre = $this.next('pre');\r\n            let html = $pre.html();\r\n            $this.text('还原代码').data('code', html);\r\n            html = Util.decodeHtmlSpecialChar(html);\r\n            let height = $pre.height();\r\n            if (height < 50) height = 50;\r\n            if (height > 340) height = 340;\r\n            $pre.remove();\r\n            $(`<textarea class=\"form-control code-textarea\" style=\"height: ${height}px\" wrap=\"off\">${html}</textarea>`)\r\n                .insertAfter($this).select().focus();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 获取当前页面选中的多重引用数据\r\n * @returns {{}[]} 多重引用数据列表\r\n */\r\nconst getCheckedMultiQuoteData = function () {\r\n    let quoteList = [];\r\n    $('.multi-quote-check:checked').each(function () {\r\n        let $article = $(this).closest('article');\r\n        quoteList.push({floor: $article.data('floor'), pid: $article.data('pid'), userName: $article.data('username')});\r\n    });\r\n    return quoteList;\r\n};\r\n\r\n/**\r\n * 绑定多重引用复选框点击事件\r\n */\r\nexport const bindMultiQuoteCheckClick = function () {\r\n    $(document).on('click', '.multi-quote-check', function () {\r\n        let data = localStorage[Const.multiQuoteStorageName];\r\n        if (data) {\r\n            try {\r\n                data = JSON.parse(data);\r\n                if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) data = null;\r\n                else if (!('tid' in data) || data.tid !== pageInfo.tid || $.type(data.quoteList) !== 'object') data = null;\r\n            }\r\n            catch (ex) {\r\n                data = null;\r\n            }\r\n        }\r\n        else {\r\n            data = null;\r\n        }\r\n        let quoteList = getCheckedMultiQuoteData();\r\n        if (!data) {\r\n            localStorage.removeItem(Const.multiQuoteStorageName);\r\n            data = {tid: pageInfo.tid, quoteList: {}};\r\n        }\r\n        if (quoteList.length > 0) data.quoteList[pageInfo.currentPageNum] = quoteList;\r\n        else delete data.quoteList[pageInfo.currentPageNum];\r\n        localStorage[Const.multiQuoteStorageName] = JSON.stringify(data);\r\n    });\r\n};\r\n","/* 其它模块 */\r\n'use strict';\r\n\r\n/**\r\n * 设置Cookie\r\n * @param {string} name Cookie名称\r\n * @param {*} value Cookie值\r\n * @param {?Date} date Cookie有效期，留空则表示有效期为浏览器进程\r\n * @param {string} prefix Cookie名称前缀\r\n */\r\nexport const setCookie = function (name, value, date = null, prefix = pageInfo.cookiePrefix) {\r\n    document.cookie = `${prefix}${name}=${encodeURI(value)}${!date ? '' : ';expires=' + date.toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * 获取Cookie\r\n * @param {string} name Cookie名称\r\n * @param {string} prefix Cookie名称前缀\r\n * @returns {?string} Cookie值\r\n */\r\nexport const getCookie = function (name, prefix = pageInfo.cookiePrefix) {\r\n    let regex = new RegExp(`(^| )${prefix}${name}=([^;]*)(;|$)`);\r\n    let matches = document.cookie.match(regex);\r\n    if (!matches) return null;\r\n    else return decodeURI(matches[2]);\r\n};\r\n\r\n/**\r\n * 删除Cookie\r\n * @param {string} name Cookie名称\r\n * @param {string} prefix Cookie名称前缀\r\n */\r\nexport const deleteCookie = function (name, prefix = pageInfo.cookiePrefix) {\r\n    document.cookie = `${prefix}${name}=;expires=${getDate('-1d').toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * 获取在当前时间的基础上的指定（相对）时间量的Date对象\r\n * @param {string} value 指定（相对）时间量，+或-：之后或之前（相对于当前时间）；无符号：绝对值；Y：完整年份；y：年；M：月；d：天；h：小时；m：分；s：秒；ms：毫秒\r\n * @returns {?Date} 指定（相对）时间量的Date对象\r\n * @example\r\n * Tools.getDate('+2y') 获取2年后的Date对象\r\n * Tools.getDate('+3M') 获取3个月后的Date对象\r\n * Tools.getDate('-4d') 获取4天前的Date对象\r\n * Tools.getDate('5h') 获取今天5点的Date对象（其它时间量与当前时间一致）\r\n * Tools.getDate('2015Y') 获取年份为2015年的Date对象\r\n */\r\nexport const getDate = function (value) {\r\n    let date = new Date();\r\n    let matches = /^(-|\\+)?(\\d+)([a-zA-Z]{1,2})$/.exec(value);\r\n    if (!matches) return null;\r\n    let flag = typeof matches[1] === 'undefined' ? 0 : (matches[1] === '+' ? 1 : -1);\r\n    let increment = flag === -1 ? -parseInt(matches[2]) : parseInt(matches[2]);\r\n    let unit = matches[3];\r\n    switch (unit) {\r\n        case 'Y':\r\n            date.setFullYear(increment);\r\n            break;\r\n        case 'y':\r\n            date.setFullYear(flag === 0 ? increment : date.getFullYear() + increment);\r\n            break;\r\n        case 'M':\r\n            date.setMonth(flag === 0 ? increment : date.getMonth() + increment);\r\n            break;\r\n        case 'd':\r\n            date.setDate(flag === 0 ? increment : date.getDate() + increment);\r\n            break;\r\n        case 'h':\r\n            date.setHours(flag === 0 ? increment : date.getHours() + increment);\r\n            break;\r\n        case 'm':\r\n            date.setMinutes(flag === 0 ? increment : date.getMinutes() + increment);\r\n            break;\r\n        case 's':\r\n            date.setSeconds(flag === 0 ? increment : date.getSeconds() + increment);\r\n            break;\r\n        case 'ms':\r\n            date.setMilliseconds(flag === 0 ? increment : date.getMilliseconds() + increment);\r\n            break;\r\n        default:\r\n            return null;\r\n    }\r\n    return date;\r\n};\r\n\r\n/**\r\n * 获取指定字符串的字节长度（1个GBK字符按2个字节来算）\r\n * @param {string} str 指定字符串\r\n * @returns {number} 字符串的长度\r\n */\r\nexport const getStrByteLen = function (str) {\r\n    let len = 0;\r\n    let cLen = 2;\r\n    for (let i = 0; i < str.length; i++) {\r\n        len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? cLen : 1;\r\n    }\r\n    return len;\r\n};\r\n\r\n/**\r\n * 获取当前域名的URL\r\n * @returns {string} 当前域名的URL\r\n */\r\nexport const getHostNameUrl = function () {\r\n    return location.protocol + '//' + location.host;\r\n};\r\n\r\n/**\r\n * 添加BBCode\r\n * @param textArea 文本框\r\n * @param {string} code BBCode\r\n * @param {string} selText 选择文本\r\n */\r\nexport const addCode = function (textArea, code, selText = '') {\r\n    let startPos = selText === '' ? code.indexOf(']') + 1 : code.indexOf(selText);\r\n    if (typeof textArea.selectionStart !== 'undefined') {\r\n        let prePos = textArea.selectionStart;\r\n        textArea.value = textArea.value.substring(0, prePos) + code + textArea.value.substring(textArea.selectionEnd);\r\n        textArea.selectionStart = prePos + startPos;\r\n        textArea.selectionEnd = prePos + startPos + selText.length;\r\n    }\r\n    else {\r\n        textArea.value += code;\r\n    }\r\n};\r\n\r\n/**\r\n * 获取选择文本\r\n * @param textArea 文本框\r\n * @returns {string} 选择文本\r\n */\r\nexport const getSelText = function (textArea) {\r\n    return textArea.value.substring(textArea.selectionStart, textArea.selectionEnd);\r\n};\r\n\r\n/**\r\n * 从URL查询字符串提取参数对象\r\n * @param {string} str URL查询字符串\r\n * @returns {Map} 参数集合\r\n */\r\nexport const extractQueryStr = function (str) {\r\n    let params = new Map();\r\n    for (let param of str.split('&')) {\r\n        if (!param) continue;\r\n        let [key, value] = param.split('=');\r\n        params.set(key, typeof value !== 'undefined' ? value : '');\r\n    }\r\n    return params;\r\n};\r\n\r\n/**\r\n * 从参数对象中创建URL查询字符串\r\n * @param {Map} map 参数集合\r\n * @returns {string} URL查询字符串\r\n */\r\nexport const buildQueryStr = function (map) {\r\n    let queryStr = '';\r\n    for (let [key, value] of map) {\r\n        if (pageInfo.urlType === 2) {\r\n            queryStr += (queryStr ? '&' : '') + key + '=' + value;\r\n        }\r\n        else {\r\n            queryStr += (queryStr ? '/' : '') + key + '/' + value;\r\n        }\r\n    }\r\n    return queryStr;\r\n};\r\n\r\n/**\r\n * 生成指定的URL\r\n * @param {string} action 控制器（小写）\r\n * @param {string} param 查询参数\r\n * @param {boolean} includeOtherParam 是否包括当前页面的其它查询参数\r\n * @param {[]} excludeParams 要排除当前页面的查询参数列表\r\n * @returns {string} URL 最终的URL\r\n */\r\nexport const makeUrl = function (action, param = '', includeOtherParam = false, excludeParams = []) {\r\n    let url = '';\r\n    let paramList = extractQueryStr(param);\r\n    if (includeOtherParam) {\r\n        paramList = new Map([...extractQueryStr(pageInfo.urlParam).entries(), ...paramList.entries()]);\r\n        for (let i in excludeParams) {\r\n            paramList.delete(excludeParams[i]);\r\n        }\r\n    }\r\n    if (!action.startsWith('/')) {\r\n        if (location.pathname.startsWith(pageInfo.baseFile)) url = pageInfo.baseFile + '/';\r\n        else url = pageInfo.rootPath;\r\n    }\r\n    url += action;\r\n    if (paramList.size > 0) {\r\n        let queryStr = buildQueryStr(paramList);\r\n        if (queryStr) {\r\n            url += (pageInfo.urlType === 2 ? '?' : '/') + queryStr;\r\n        }\r\n    }\r\n    return url;\r\n};\r\n\r\n/**\r\n * 获取URL查询字符串中的指定参数\r\n * @param {string} name 参数名称\r\n * @returns {?string} 参数值\r\n */\r\nexport const getQueryParam = function (name) {\r\n    return extractQueryStr(pageInfo.urlParam).get(name);\r\n};\r\n\r\n/**\r\n * 解码HTML特殊字符\r\n * @param {string} str 待解码的字符串\r\n * @returns {string} 解码后的字符串\r\n */\r\nexport const decodeHtmlSpecialChar = function (str) {\r\n    if (!str.length) return '';\r\n    return str.replace(/<br\\s*\\/?>/gi, '\\n')\r\n        .replace(/&quot;/gi, '\\\"')\r\n        .replace(/&#39;/gi, '\\'')\r\n        .replace(/&nbsp;/gi, ' ')\r\n        .replace(/&gt;/gi, '>')\r\n        .replace(/&lt;/gi, '<')\r\n        .replace(/&amp;/gi, '&');\r\n};\r\n\r\n/**\r\n * 全选\r\n * @param {jQuery} $nodes 想要全选的节点的jQuery对象\r\n */\r\nexport const selectAll = function ($nodes) {\r\n    $nodes.prop('checked', true);\r\n};\r\n\r\n/**\r\n * 反选\r\n * @param {jQuery} $nodes 想要反选的节点的jQuery对象\r\n */\r\nexport const selectReverse = function ($nodes) {\r\n    $nodes.each(function () {\r\n        let $this = $(this);\r\n        $this.prop('checked', !$this.prop('checked'));\r\n    });\r\n};\r\n\r\n/**\r\n * 显示字段验证消息\r\n * @param {jQuery} $node 验证字段的jQuery对象\r\n * @param {string} type 验证类型\r\n * @param {string} msg 验证消息\r\n */\r\nexport const showValidationMsg = function ($node, type, msg = '') {\r\n    if (type === 'error') type = 'danger';\r\n    $node.removeClass('form-control-success form-control-warning form-control-danger');\r\n    let $parent = $node.parent();\r\n    $parent.removeClass('has-success has-warning has-danger');\r\n    if ($.inArray(type, ['success', 'warning', 'danger'] > -1)) {\r\n        $node.addClass('form-control-' + type).parent().addClass('has-' + type);\r\n    }\r\n    let $feedback = $parent.find('.form-control-feedback');\r\n    if (type === 'wait') {\r\n        $feedback.html(`<span class=\"text-muted\"><i class=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i> ${msg}</span>`);\r\n    }\r\n    else {\r\n        $feedback.text(msg);\r\n    }\r\n};\r\n\r\n/**\r\n * 获取对象A在对象B中的相对补集\r\n * @param {Object} a 对象A\r\n * @param {Object} b 对象B\r\n * @returns {Object} 相对补集\r\n */\r\nexport const getDifferenceSetOfObject = function (a, b) {\r\n    let c = {};\r\n    if ($.type(a) !== 'object' || $.type(b) !== 'object') return c;\r\n    $.each(b, (key, data) => {\r\n        if (key in a) {\r\n            if (!deepEqual(a[key], data)) c[key] = data;\r\n        }\r\n    });\r\n    return c;\r\n};\r\n\r\n/**\r\n * 深度比较两个对象是否相等\r\n * @param {*} a\r\n * @param {*} b\r\n * @returns {boolean} 是否相等\r\n */\r\nexport const deepEqual = function (a, b) {\r\n    if (a === b) return true;\r\n    if ($.type(a) !== $.type(b)) return false;\r\n    if (typeof a === 'number' && typeof b === 'number' && isNaN(a) && isNaN(b)) return true;\r\n    if ($.isArray(a) && $.isArray(b) || $.type(a) === 'object' && $.type(b) === 'object') {\r\n        if (a.length !== b.length) return false;\r\n        for (var i in $.extend($.isArray(a) ? [] : {}, a, b)) {\r\n            if (typeof a[i] === 'undefined' || typeof b[i] === 'undefined') return false;\r\n            if (!deepEqual(a[i], b[i])) return false;\r\n        }\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n\r\n/**\r\n * 复制文本\r\n * @param {jQuery} $target 要复制文本的目标元素\r\n * @param {?jQuery} $source 触发事件的源元素\r\n * @returns {boolean} 是否复制成功\r\n */\r\nexport const copyText = function ($target, $source = null) {\r\n    if (!('execCommand' in document) || !$target.length) return false;\r\n    let copyText = $target.data('copy-text');\r\n    if (copyText) {\r\n        $target = $(`<span class=\"text-hide\">${copyText}</span>`).insertAfter($target);\r\n    }\r\n    let s = window.getSelection();\r\n    s.selectAllChildren($target.get(0));\r\n    let result = document.execCommand('copy');\r\n    s.removeAllRanges();\r\n    if (copyText) $target.remove();\r\n    if (result && $source) {\r\n        let msg = $source.data('copy-msg');\r\n        $source.attr('title', msg ? msg : '已复制').on('hidden.bs.tooltip', function () {\r\n            $(this).tooltip('dispose');\r\n        }).tooltip('show');\r\n    }\r\n    return result;\r\n};\r\n"]}
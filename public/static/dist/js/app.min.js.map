{"version":3,"sources":["node_modules/.6.0.1@browser-pack/_prelude.js","public/static/src/js/app.js","public/static/src/js/module/config.js","public/static/src/js/module/configDialog.js","public/static/src/js/module/const.js","public/static/src/js/module/dialog.js","public/static/src/js/module/index.js","public/static/src/js/module/msg.js","public/static/src/js/module/other.js","public/static/src/js/module/post.js","public/static/src/js/module/public.js","public/static/src/js/module/read.js","public/static/src/js/module/util.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_config","_public","Public","_index","Index","_read","Read","_post","Post","_other","Other","window","pageId","$","attr","init","startTime","Date","validateRegisterField","preventCloseWindow","handleMainMenu","handleMainMenuLink","handleRollToTopOrBottomBtn","handleSearchDialog","fillCommonForumPanel","showEditCommonForumDialog","handlePageInput","handleAtTipsBtn","handleIndexThreadPanel","handleSelectBgImage","handleSelectBgColor","handleCustomBgStyle","gotoFloor","handleFastGotoFloorBtn","handleTuiThreadBtn","handleCopyFloorLinkBtn","handleFastReplyBtn","handleBlockFloorBtn","handleBuyThreadBtn","copyBuyThreadList","handleFloorImage","checkPostForm","bindFastSubmitShortcutKey","handleCopyCodeBtn","addSmileCode","bindMultiQuoteCheckClick","handleClearMultiQuoteDataBtn","click","handleMultiQuote","handleEditorBtns","handleAttachBtns","pageInfo","multiQuote","highlightUnReadAtTipsMsg","handleUserPageBtns","handleGameIntroSearchArea","tuiGameIntro","bindFavorPageBtnsClick","bindFriendPageBtnsClick","syncPerPageFloorNum","assignBirthdayField","handleUploadAvatarFileBtn","transferKfbAlert","bindMessageActionBtnsClick","Config","blockUserEnabled","blockUsers","blockThreadEnabled","blockThread","followUserEnabled","followUsers","tooltip","container","console","log","document","ready","_util","Util","name","activeNewReplyPanel","activeTopRecommendPanel","activeForumPanel1","activeForumPanel2","commonForumList","perPageFloorNum","defShowMsgDuration","followUserList","highlightFollowUserThreadInHPEnabled","highlightFollowUserThreadLinkEnabled","blockUserDefaultType","blockUserAtTipsEnabled","blockUserForumType","blockUserFidList","blockUserList","blockThreadDefForumType","blockThreadDefFidList","blockThreadList","read","extend","options","localStorage","JSON","parse","ex","type","isEmptyObject","normalize","write","getDifferenceSetOfObject","stringify","clear","removeItem","settings","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Object","entries","Symbol","iterator","next","done","_step$value","_slicedToArray","value","key","err","return","_dialog","Dialog","show","dialogName","bodyContent","footerContent","$dialog","create","submit","preventDefault","getMainConfigValue","close","on","$this","this","hasClass","data","showFollowUserDialog","showBlockUserDialog","showBlockThreadDialog","find","confirm","alert","location","reload","end","showImportOrExportSettingDialog","setMainConfigValue","each","is","prop","val","Boolean","parseInt","trim","select","focus","$followUserList","addFollowUser","appendTo","inFollowOrBlockUserList","push","$checked","remove","keydown","keyCode","$addUser","split","showCommonImportOrExportConfigDialog","selectAll","selectInverse","closest","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","user","$blockUserList","addBlockUser","Set","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","fid","isNaN","add","concat","_toConsumableArray","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","change","triggerHandler","join","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","$blockThreadList","addBlockThread","keyWord","userType","userList","fidType","fidList","verify","flag","$txtKeyWord","test","eval","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","newObj","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","size","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","html","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_iterator9","_step9","includeUser","excludeUser","includeFid","excludeFid","Const","multiQuoteStorageName","atTipsTimeCookieName","prevAtTipsTimeCookieName","bgStyleCookieName","availableForumList","resize","id","title","arguments","checked","removeClass","addClass","$focus","includes","fadeIn","css","height","outerHeight","fadeOut","parent","off","_const","time","cookieValue","getCookie","_const2","default","setCookie","currentDate","getDate","tab","$target","target","targetPanel","typeName","fileName","path","color","prompt","$bg","toLowerCase","replace","duration","msg","clickable","preventable","$container","isFirst","destroy","$msg","text","hide","stopPropagation","slideDown","setTimeout","wait","slideUp","gjc","userName","timeString","prevString","index","curString","deleteCookie","keyword","searchType","cookieName","url","makeUrl","ajax","success","$num","num","error","complete","removeData","dataType","$form","action","matches","exec","year","month","day","syncConfig","transferKfb","fixedDeposit","currentDeposit","_ret","v","_typeof","_$checked","showValidationMsg","post","_ref","username","fail","trigger","$area","str","splice","_msg","Msg","textArea","get","_matches","selText","getSelText","addCode","codeType","$postType","$postTitle","getStrByteLen","$voteItemContent","$postContent","_length","$postGjc","after","blur","$newAttachArea","totalNum","$lastAttachArea","insertAfter","$node","$relatedTarget","relatedTarget","_data","tid","quoteList","list","values","_data2","quote","keywords","content","clearQueue","_loop","_step2$value","queue","pid","floor","getTime","postContent","$countdownNum","dequeue","_configDialog","ConfigDialog","maxHeight","documentElement","clientHeight","scroll","$btn","scrollTop","animate","$searchDialog","$searchKeyword","$method","Math","$current","$currentBox","disabled","maxPageNum","excludeParams","currentPageNum","href","ctrlKey","commonForumListHtml","availableForumListHtml","elem","$dragulaScriptPath","dragulaScriptPath","getScript","dragula","revertOnSpill","children","_step3$value","_step3$value$","_fid","addEventListener","returnValue","configName","callback","callbackAfterSubmit","regex1","RegExp","regex2","isBlock","_step5$value","regex","$topFloor","getCheckedMultiQuoteData","link","getHostNameUrl","copyText","$article","selectionStart","selectionEnd","price","$wait","map","repeat","selectedIndex","modal","naturalWidth","width","hashName","prev","hash","safeId","$pre","decodeHtmlSpecialChar","date","prefix","cookiePrefix","cookie","encodeURI","toUTCString","match","decodeURI","increment","unit","setFullYear","getFullYear","setMonth","getMonth","setDate","setHours","getHours","setMinutes","getMinutes","setSeconds","getSeconds","setMilliseconds","getMilliseconds","extractQueryStr","len","cLen","charCodeAt","protocol","host","startPos","indexOf","prePos","substring","params","Map","param","_param$split","_param$split2","set","buildQueryStr","queryStr","urlType","deepEqual","includeOtherParam","paramList","urlParam","delete","startsWith","pathname","baseFile","rootPath","getQueryParam","$nodes","$parent","inArray","$feedback","b","c","isArray","$source","getSelection","selectAllChildren","result","execCommand","removeAllRanges","findIndex"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\nimport {init as initConfig} from './module/config';\r\nimport * as Public from './module/public';\r\nimport * as Index from './module/index';\r\nimport * as Read from './module/read';\r\nimport * as Post from './module/post';\r\nimport * as Other from './module/other';\r\n\r\n// 页面ID\r\nwindow.pageId = $('body').attr('id');\r\n\r\n/**\r\n * 初始化\r\n */\r\nconst init = function () {\r\n    let startTime = new Date();\r\n    if (pageId === 'loginPage') return;\r\n    else if (pageId === 'registerPage') {\r\n        Other.validateRegisterField();\r\n        return;\r\n    }\r\n    initConfig();\r\n\r\n    Public.preventCloseWindow();\r\n    Public.handleMainMenu();\r\n    Public.handleMainMenuLink();\r\n    Public.handleRollToTopOrBottomBtn();\r\n    Public.handleSearchDialog();\r\n    Public.fillCommonForumPanel();\r\n    Public.showEditCommonForumDialog();\r\n    if ($('.page-input').length > 0) {\r\n        Public.handlePageInput();\r\n    }\r\n    if (pageId === 'indexPage') {\r\n        Index.handleAtTipsBtn();\r\n        Index.handleIndexThreadPanel();\r\n        Index.handleSelectBgImage();\r\n        Index.handleSelectBgColor();\r\n        Index.handleCustomBgStyle();\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        Read.gotoFloor();\r\n        Read.handleFastGotoFloorBtn();\r\n        Read.handleTuiThreadBtn();\r\n        Read.handleCopyFloorLinkBtn();\r\n        Read.handleFastReplyBtn();\r\n        Read.handleBlockFloorBtn();\r\n        Read.handleBuyThreadBtn();\r\n        Read.copyBuyThreadList();\r\n        Read.handleFloorImage();\r\n        Post.checkPostForm();\r\n        Public.bindFastSubmitShortcutKey($('#postContent'));\r\n        Read.handleCopyCodeBtn();\r\n        Post.addSmileCode($('#postContent'));\r\n        Read.bindMultiQuoteCheckClick();\r\n        Post.handleClearMultiQuoteDataBtn();\r\n        $('.multi-reply-btn').click(() => Post.handleMultiQuote(1));\r\n    }\r\n    else if (pageId === 'postPage') {\r\n        Post.checkPostForm();\r\n        Public.bindFastSubmitShortcutKey($('#postContent'));\r\n        Post.handleEditorBtns();\r\n        Post.addSmileCode($('#postContent'));\r\n        Post.handleAttachBtns();\r\n        Post.handleClearMultiQuoteDataBtn();\r\n        if (pageInfo.multiQuote) Post.handleMultiQuote(2);\r\n    }\r\n    else if (pageId === 'gjcPage') {\r\n        Other.highlightUnReadAtTipsMsg();\r\n    }\r\n    else if (pageId === 'userPage') {\r\n        Other.handleUserPageBtns();\r\n    }\r\n    else if (pageId === 'gameIntroSearchPage') {\r\n        Other.handleGameIntroSearchArea();\r\n    }\r\n    else if (pageId === 'gameIntroPage') {\r\n        Other.tuiGameIntro('game');\r\n    }\r\n    else if (pageId === 'gameIntroCompanyPage') {\r\n        Other.tuiGameIntro('company');\r\n    }\r\n    else if (pageId === 'gameIntroTypePage') {\r\n        Other.tuiGameIntro('type');\r\n    }\r\n    else if (pageId === 'gameIntroPropertyPage') {\r\n        Other.tuiGameIntro('property');\r\n    }\r\n    else if (pageId === 'favorPage') {\r\n        Other.bindFavorPageBtnsClick();\r\n    }\r\n    else if (pageId === 'friendPage') {\r\n        Other.bindFriendPageBtnsClick();\r\n    }\r\n    else if (pageId === 'modifyPage') {\r\n        Other.syncPerPageFloorNum();\r\n        Other.assignBirthdayField();\r\n        Other.handleUploadAvatarFileBtn();\r\n    }\r\n    else if (pageId === 'bankPage') {\r\n        Other.transferKfbAlert();\r\n    }\r\n    else if (pageId === 'messagePage') {\r\n        Other.bindMessageActionBtnsClick();\r\n    }\r\n    else if (pageId === 'readMessagePage') {\r\n        Read.handleFloorImage();\r\n        Read.handleCopyCodeBtn();\r\n    }\r\n    else if (pageId === 'writeMessagePage') {\r\n        Public.bindFastSubmitShortcutKey($('#msgContent'));\r\n        Post.addSmileCode($('#msgContent'));\r\n    }\r\n    else if (pageId === 'messageBannedPage') {\r\n        Public.bindFastSubmitShortcutKey($('[name=\"banidinfo\"]'));\r\n    }\r\n    if (Config.blockUserEnabled) Public.blockUsers();\r\n    if (Config.blockThreadEnabled) Public.blockThread();\r\n    if (Config.followUserEnabled) Public.followUsers();\r\n\r\n    $('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    console.log(`脚本加载完毕，耗时：${new Date() - startTime}ms`);\r\n};\r\n\r\n$(document).ready(init);\r\n","/* 配置模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\n\r\n// 配置名称\r\nconst name = 'kf_config';\r\n\r\n/**\r\n * 配置类\r\n */\r\nexport const Config = {\r\n    // 当前激活的最新回复面板\r\n    activeNewReplyPanel: '#galgameNewReplyPanel',\r\n    // 当前激活的当前推荐面板\r\n    activeTopRecommendPanel: '#galgameTopRecommendPanel',\r\n    // 当前激活的版块列表面板1\r\n    activeForumPanel1: '',\r\n    // 当前激活的版块列表面板2\r\n    activeForumPanel2: '',\r\n    // 常用版块列表\r\n    commonForumList: [],\r\n\r\n    // 主题每页楼层数量\r\n    perPageFloorNum: 10,\r\n\r\n    // 默认的消息显示时间（秒），设置为-1表示永久显示\r\n    defShowMsgDuration: -1,\r\n\r\n    // 是否开启关注用户的功能，true：开启；false：关闭\r\n    followUserEnabled: false,\r\n    // 关注用户列表，格式：[{name:'用户名'}]，例：[{name:'张三'}, {name:'李四'}]\r\n    followUserList: [],\r\n    // 是否高亮所关注用户在首页下的主题链接，true：开启；false：关闭\r\n    highlightFollowUserThreadInHPEnabled: true,\r\n    // 是否高亮所关注用户在主题列表页面下的主题链接，true：开启；false：关闭\r\n    highlightFollowUserThreadLinkEnabled: true,\r\n    // 是否开启屏蔽用户的功能，true：开启；false：关闭\r\n    blockUserEnabled: false,\r\n    // 屏蔽用户的默认屏蔽类型，0：屏蔽主题和回贴；1：仅屏蔽主题；2：仅屏蔽回贴\r\n    blockUserDefaultType: 0,\r\n    // 是否屏蔽被屏蔽用户的@提醒，true：开启；false：关闭\r\n    blockUserAtTipsEnabled: true,\r\n    // 屏蔽用户的版块屏蔽范围，0：所有版块；1：包括指定的版块；2：排除指定的版块\r\n    blockUserForumType: 0,\r\n    // 屏蔽用户的版块ID列表，例：[16, 41, 67, 57, 84, 92, 127, 68, 163, 182, 9]\r\n    blockUserFidList: [],\r\n    // 屏蔽用户列表，格式：[{name:'用户名', type:屏蔽类型}]，例：[{name:'张三', type:0}, {name:'李四', type:1}]\r\n    blockUserList: [],\r\n    // 是否开启屏蔽标题包含指定关键字的主题的功能，true：开启；false：关闭\r\n    blockThreadEnabled: false,\r\n    // 屏蔽主题的默认版块屏蔽范围，0：所有版块；1：包括指定的版块；2：排除指定的版块\r\n    blockThreadDefForumType: 0,\r\n    // 屏蔽主题的默认版块ID列表，例：[16, 41, 67, 57, 84, 92, 127, 68, 163, 182, 9]\r\n    blockThreadDefFidList: [],\r\n    // 屏蔽主题的关键字列表，格式：[{keyWord:'关键字', includeUser:['包括的用户名'], excludeUser:['排除的用户名'], includeFid:[包括指定的版块ID], excludeFid:[排除指定的版块ID]}]\r\n    // 关键字可使用普通字符串或正则表达式（正则表达式请使用'/abc/'的格式），includeUser、excludeUser、includeFid和excludeFid这三项为可选\r\n    // 例：[{keyWord: '标题1'}, {keyWord: '标题2', includeUser:['用户名1', '用户名2'], includeFid: [5, 56]}, {keyWord: '/关键字A.*关键字B/i', excludeFid: [92, 127, 68]}]\r\n    blockThreadList: [],\r\n};\r\n\r\n/**\r\n * 初始化\r\n */\r\nexport const init = function () {\r\n    window.Config = $.extend(true, {}, Config);\r\n    read();\r\n};\r\n\r\n/**\r\n * 读取设置\r\n */\r\nexport const read = function () {\r\n    let options = localStorage[name];\r\n    if (!options) return;\r\n    try {\r\n        options = JSON.parse(options);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!options || $.type(options) !== 'object' || $.isEmptyObject(options)) return;\r\n    options = normalize(options);\r\n    window.Config = $.extend(true, {}, Config, options);\r\n};\r\n\r\n/**\r\n * 写入设置\r\n */\r\nexport const write = function () {\r\n    let options = Util.getDifferenceSetOfObject(Config, window.Config);\r\n    localStorage[name] = JSON.stringify(options);\r\n};\r\n\r\n/**\r\n * 清空设置\r\n */\r\nexport const clear = function () {\r\n    localStorage.removeItem(name);\r\n};\r\n\r\n/**\r\n * 获取经过规范化的Config对象\r\n * @param {{}} options 待处理的Config对象\r\n * @returns {{}} 经过规范化的Config对象\r\n */\r\nexport const normalize = function (options) {\r\n    let settings = {};\r\n    if ($.type(options) !== 'object') return settings;\r\n    for (let [key, value] of Object.entries(options)) {\r\n        if (key in Config && $.type(value) === $.type(Config[key])) {\r\n            settings[key] = value;\r\n        }\r\n    }\r\n    return settings;\r\n};\r\n","/* 设置对话框模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport * as Dialog from './dialog';\r\nimport {\r\n    read as readConfig,\r\n    write as writeConfig,\r\n    clear as clearConfig,\r\n    normalize as normalizeConfig,\r\n    Config as defConfig,\r\n} from './config';\r\nimport * as Public from './public';\r\n\r\n/**\r\n * 显示设置对话框\r\n */\r\nexport const show = function () {\r\n    const dialogName = 'configDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend>主题页面相关</legend>\r\n  <div class=\"form-group mb-2\">\r\n    <label>主题每页楼层数量</label>\r\n    <select class=\"custom-select custom-select-sm\" name=\"perPageFloorNum\">\r\n      <option value=\"10\">10</option><option value=\"20\">20</option><option value=\"30\">30</option>\r\n    </select>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"主题页面中每页的楼层数量（用于电梯直达等功能），如果修改了论坛设置里的“文章列表每页个数”，请在此修改成相同的数目\">[?]</span>\r\n  </div>\r\n</fieldset>\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend>其它设置</legend>\r\n  <div class=\"input-group mb-2\">\r\n    <span class=\"input-group-addon\">消息显示时间</span>\r\n    <input class=\"form-control\" name=\"defShowMsgDuration\" data-toggle=\"tooltip\" type=\"number\" min=\"-1\" required\r\n           title=\"默认的消息显示时间（秒），设置为-1表示永久显示，例：15\">\r\n    <span class=\"input-group-addon\">秒</span>\r\n  </div>\r\n</fieldset>\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend>关注和屏蔽</legend>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"followUserEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openFollowUserDialog]\"> 关注用户\r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"开启关注用户的功能，所关注的用户将被加注记号，请点击详细设置管理关注用户\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openFollowUserDialog\" href=\"#\" role=\"button\">详细设置&raquo;</a>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockUserEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openBlockUserDialog]\"> 屏蔽用户\r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"开启屏蔽用户的功能，你将看不见所屏蔽用户的发言，请点击详细设置管理屏蔽用户\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openBlockUserDialog\" href=\"#\" role=\"button\">详细设置&raquo;</a>\r\n  </div>\r\n  <div class=\"form-check\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockThreadEnabled\" type=\"checkbox\" data-disabled=\"[data-name=openBlockThreadDialog]\"> 屏蔽主题\r\n    </label>\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"开启屏蔽标题中包含指定关键字的主题的功能，请点击详细设置管理屏蔽关键字\">[?]</span>\r\n    <a class=\"ml-3\" data-name=\"openBlockThreadDialog\" href=\"#\" role=\"button\">详细设置&raquo;</a>\r\n  </div>\r\n</fieldset>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImportOrExportSettingDialog\" type=\"button\">导入/导出</button>\r\n<button class=\"btn btn-primary\" type=\"submit\">保存</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>\r\n<button class=\"btn btn-danger\" name=\"reset\" type=\"button\">重置</button>`;\r\n    let $dialog = Dialog.create(dialogName, '助手设置', bodyContent, footerContent);\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        readConfig();\r\n        let options = getMainConfigValue($dialog);\r\n        options = normalizeConfig(options);\r\n        $.extend(Config, options);\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).on('click', 'a[data-name^=\"open\"][href=\"#\"]', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.hasClass('pd_disabled_link')) return;\r\n        let name = $this.data('name');\r\n        if (name === 'openFollowUserDialog') showFollowUserDialog();\r\n        else if (name === 'openBlockUserDialog') showBlockUserDialog();\r\n        else if (name === 'openBlockThreadDialog') showBlockThreadDialog();\r\n    }).find('[name=\"reset\"]').click(function () {\r\n        if (confirm('是否重置所有设置？')) {\r\n            clearConfig();\r\n            alert('设置已重置');\r\n            Dialog.close(dialogName);\r\n            location.reload();\r\n        }\r\n    }).end().find('[name=\"openImportOrExportSettingDialog\"]').click(showImportOrExportSettingDialog);\r\n\r\n    setMainConfigValue($dialog);\r\n    Dialog.show(dialogName);\r\n};\r\n\r\n/**\r\n * 设置主对话框中的字段值\r\n * @param {jQuery} $dialog 助手设置对话框对象\r\n */\r\nconst setMainConfigValue = function ($dialog) {\r\n    $dialog.find('input[name], select[name]').each(function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        if (name in Config) {\r\n            if ($this.is('[type=\"checkbox\"]') && typeof Config[name] === 'boolean') $this.prop('checked', Config[name] === true);\r\n            else $this.val(Config[name]);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 获取主对话框中字段值的Config对象\r\n * @param {jQuery} $dialog 助手设置对话框对象\r\n * @returns {{}} 字段值的Config对象\r\n */\r\nconst getMainConfigValue = function ($dialog) {\r\n    let options = {};\r\n    $dialog.find('input[name], select[name]').each(function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        if (name in Config) {\r\n            if ($this.is('[type=\"checkbox\"]') && typeof Config[name] === 'boolean')\r\n                options[name] = Boolean($this.prop('checked'));\r\n            else if (typeof Config[name] === 'number') {\r\n                options[name] = parseInt($this.val());\r\n            }\r\n            else options[name] = $.trim($this.val());\r\n        }\r\n    });\r\n    return options;\r\n};\r\n\r\n/**\r\n * 显示导入或导出设置对话框\r\n */\r\nconst showImportOrExportSettingDialog = function () {\r\n    const dialogName = 'pdImOrExSettingDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\">\r\n  <b>导入设置：</b>将设置内容粘贴到文本框中并点击保存按钮即可<br>\r\n  <b>导出设置：</b>复制文本框里的内容并粘贴到别处即可\r\n</p>\r\n<div class=\"form-group\">\r\n  <textarea class=\"form-control\" name=\"setting\" rows=\"10\" aria-label=\"设置内容\" style=\"word-break: break-all;\"></textarea>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\">保存</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>`;\r\n    let $dialog = Dialog.create(dialogName, `导入或导出设置`, bodyContent, footerContent);\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('是否导入文本框中的设置？')) return;\r\n        let options = $.trim($dialog.find('[name=\"setting\"]').val());\r\n        if (!options) return;\r\n        try {\r\n            options = JSON.parse(options);\r\n        }\r\n        catch (ex) {\r\n            alert('设置有错误');\r\n            return;\r\n        }\r\n        if (!options || $.type(options) !== 'object') {\r\n            alert('设置有错误');\r\n            return;\r\n        }\r\n        options = normalizeConfig(options);\r\n        window.Config = $.extend(true, {}, defConfig, options);\r\n        writeConfig();\r\n        alert('设置已导入');\r\n        location.reload();\r\n    }).find('[name=\"cancel\"]').click(() => Dialog.close(dialogName));\r\n    Dialog.show(dialogName);\r\n    $dialog.find('[name=\"setting\"]').val(JSON.stringify(Util.getDifferenceSetOfObject(defConfig, Config))).select().focus();\r\n};\r\n\r\n/**\r\n * 显示关注用户对话框\r\n */\r\nconst showFollowUserDialog = function () {\r\n    const dialogName = 'followUserDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    let bodyContent = `\r\n<div class=\"form-check\">\r\n  <label class=\"form-check-label\">\r\n    <input class=\"form-check-input\" name=\"highlightFollowUserThreadInHpEnabled\" type=\"checkbox\"> 高亮所关注用户的首页主题链接\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"高亮所关注用户在首页下的主题链接\">[?]</span>\r\n  </label>\r\n</div>\r\n<div class=\"form-check mb-3\">\r\n  <label class=\"form-check-label\">\r\n    <input class=\"form-check-input\" name=\"highlightFollowUserThreadLinkEnabled\" type=\"checkbox\"> 高亮所关注用户的主题链接\r\n    <span class=\"tips\" data-toggle=\"tooltip\" title=\"高亮所关注用户在版块页面下的主题链接\">[?]</span>\r\n  </label>\r\n</div>\r\n<ul class=\"list-unstyled\" id=\"followUserList\"></ul>\r\n<div class=\"btn-group btn-group-sm mb-3\" role=\"group\">\r\n  <button class=\"btn btn-secondary\" name=\"selectAll\" type=\"button\">全选</button>\r\n  <button class=\"btn btn-secondary\" name=\"selectInverse\" type=\"button\">反选</button>\r\n  <button class=\"btn btn-danger\" name=\"deleteSelect\" type=\"button\">删除</button>\r\n</div>\r\n<div class=\"input-group mb-3\">\r\n  <input class=\"form-control\" name=\"addUser\" data-toggle=\"tooltip\" type=\"text\" title=\"添加多个用户请用英文逗号分隔\" aria-label=\"添加关注用户\">\r\n  <span class=\"input-group-btn\">\r\n    <button class=\"btn btn-success\" name=\"add\" type=\"button\">添加</button>\r\n  </span>\r\n</div>\r\n`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImOrExFollowUserListDialog\" type=\"button\">导入/导出</button>\r\n<button class=\"btn btn-primary\" type=\"submit\">保存</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>`;\r\n    let $dialog = Dialog.create(dialogName, '关注用户', bodyContent, footerContent);\r\n    let $followUserList = $dialog.find('#followUserList');\r\n\r\n    /**\r\n     * 添加关注用户\r\n     * @param {string} name 用户名\r\n     */\r\n    const addFollowUser = function (name) {\r\n        $(`\r\n<li class=\"input-group input-group-sm mb-2\">\r\n  <span class=\"input-group-addon\">\r\n    <input type=\"checkbox\" aria-label=\"选择用户\">\r\n  </span>\r\n  <input class=\"form-control\" name=\"userName\" type=\"text\" value=\"${name}\" maxlength=\"12\" aria-label=\"编辑关注用户\">\r\n  <span class=\"input-group-btn\">\r\n    <button class=\"btn btn-danger\" name=\"delete\" type=\"button\" aria-label=\"删除关注用户\">\r\n      <i class=\"fa fa-trash\" aria-hidden=\"true\"></i>\r\n    </button>\r\n  </span>\r\n</li>\r\n`).appendTo($followUserList);\r\n    };\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        Config.highlightFollowUserThreadInHPEnabled = $dialog.find('[name=\"highlightFollowUserThreadInHpEnabled\"]').prop('checked');\r\n        Config.highlightFollowUserThreadLinkEnabled = $dialog.find('[name=\"highlightFollowUserThreadLinkEnabled\"]').prop('checked');\r\n        Config.followUserList = [];\r\n        $followUserList.find('li').each(function () {\r\n            let $this = $(this);\r\n            let name = $.trim($this.find('[name=\"userName\"]').val());\r\n            if (name !== '' && Util.inFollowOrBlockUserList(name, Config.followUserList) === -1) {\r\n                Config.followUserList.push({name});\r\n            }\r\n        });\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).find('[name=\"deleteSelect\"]').click(function () {\r\n        let $checked = $followUserList.find('li:has([type=\"checkbox\"]:checked)');\r\n        if (!$checked.length) return;\r\n        if (confirm('是否删除所选用户？')) $checked.remove();\r\n    }).end().find('[name=\"addUser\"]').keydown(function (e) {\r\n        if (e.keyCode === 13) {\r\n            e.preventDefault();\r\n            $(this).next().find('button').click();\r\n        }\r\n    }).end().find('[name=\"add\"]').click(function () {\r\n        let $addUser = $dialog.find('[name=\"addUser\"]');\r\n        for (let name of $.trim($addUser.val()).split(',')) {\r\n            name = $.trim(name);\r\n            if (!name) continue;\r\n            if (Util.inFollowOrBlockUserList(name, Config.followUserList) === -1) addFollowUser(name);\r\n        }\r\n        $addUser.val('');\r\n    }).end().find('[name=\"openImOrExFollowUserListDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        Public.showCommonImportOrExportConfigDialog('关注用户', 'followUserList');\r\n    }).end().find('[name=\"selectAll\"]').click(() => Util.selectAll($followUserList.find('[type=\"checkbox\"]')))\r\n        .end().find('[name=\"selectInverse\"]').click(() => Util.selectInverse($followUserList.find('[type=\"checkbox\"]')));\r\n\r\n    $followUserList.on('click', '[name=\"delete\"]', function () {\r\n        $(this).closest('li').remove();\r\n    });\r\n\r\n    $dialog.find('[name=\"highlightFollowUserThreadInHpEnabled\"]').prop('checked', Config.highlightFollowUserThreadInHPEnabled);\r\n    $dialog.find('[name=\"highlightFollowUserThreadLinkEnabled\"]').prop('checked', Config.highlightFollowUserThreadLinkEnabled);\r\n    for (let user of Config.followUserList) {\r\n        addFollowUser(user.name);\r\n    }\r\n    Dialog.show(dialogName);\r\n};\r\n\r\n/**\r\n * 显示屏蔽用户对话框\r\n */\r\nconst showBlockUserDialog = function () {\r\n    const dialogName = 'blockUserDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    let bodyContent = `\r\n<div class=\"form-group mb-2\">\r\n  <label>默认屏蔽类型</label>\r\n  <select class=\"custom-select custom-select-sm\" name=\"blockUserDefaultType\">\r\n    <option value=\"0\">主题和回帖</option><option value=\"1\">主题</option><option value=\"2\">回帖</option>\r\n  </select>\r\n  <div class=\"form-check form-check-inline ml-3\">\r\n    <label class=\"form-check-label\">\r\n      <input class=\"form-check-input\" name=\"blockUserAtTipsEnabled\" type=\"checkbox\"> 屏蔽@提醒\r\n      <span class=\"tips\" data-toggle=\"tooltip\" title=\"屏蔽被屏蔽用户的@提醒\">[?]</span>\r\n    </label>\r\n  </div>\r\n</div>\r\n<div class=\"form-group mb-2\">\r\n  <label>版块屏蔽范围</label>\r\n  <select class=\"custom-select custom-select-sm\" name=\"blockUserForumType\">\r\n    <option value=\"0\">所有版块</option><option value=\"1\">包括指定版块</option><option value=\"2\">排除指定版块</option>\r\n  </select>\r\n</div>\r\n<div class=\"form-group\">\r\n  <label>版块ID列表</label>\r\n  <span class=\"tips\" data-toggle=\"tooltip\" title=\"版块URL中的fid参数，多个ID请用英文逗号分隔\">[?]</span>\r\n  <input class=\"form-control form-control-sm\" name=\"blockUserFidList\" type=\"text\">\r\n</div>\r\n<ul class=\"list-unstyled\" id=\"blockUserList\"></ul>\r\n<div class=\"btn-group btn-group-sm mb-3\" role=\"group\">\r\n  <button class=\"btn btn-secondary\" name=\"selectAll\" type=\"button\">全选</button>\r\n  <button class=\"btn btn-secondary\" name=\"selectInverse\" type=\"button\">反选</button>\r\n  <div class=\"btn-group btn-group-sm dropup\">\r\n    <button class=\"btn btn-info dropdown-toggle\" data-toggle=\"dropdown\" type=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\r\n      修改为\r\n    </button>\r\n    <div class=\"dropdown-menu\" data-name=\"modifyMenu\">\r\n      <a class=\"dropdown-item\" data-value=\"0\" href=\"#\">主题和回帖</a>\r\n      <a class=\"dropdown-item\" data-value=\"1\" href=\"#\">主题</a>\r\n      <a class=\"dropdown-item\" data-value=\"2\" href=\"#\">回帖</a>\r\n    </div>\r\n  </div>\r\n  <button class=\"btn btn-danger\" name=\"deleteSelect\" type=\"button\">删除</button>\r\n</div>\r\n<div class=\"input-group mb-3\">\r\n  <input class=\"form-control\" name=\"addUser\" data-toggle=\"tooltip\" type=\"text\" title=\"添加多个用户请用英文逗号分隔\" aria-label=\"添加屏蔽用户\">\r\n  <span class=\"input-group-btn\">\r\n    <button class=\"btn btn-success\" name=\"add\" type=\"button\">添加</button>\r\n  </span>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImOrExBlockUserListDialog\" type=\"button\">导入/导出</button>\r\n<button class=\"btn btn-primary\" type=\"submit\">保存</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>`;\r\n    let $dialog = Dialog.create(dialogName, '屏蔽用户', bodyContent, footerContent);\r\n    let $blockUserList = $dialog.find('#blockUserList');\r\n\r\n    /**\r\n     * 添加屏蔽用户\r\n     * @param {string} name 用户名\r\n     * @param {number} type 屏蔽类型\r\n     */\r\n    const addBlockUser = function (name, type) {\r\n        $(`\r\n<li class=\"form-group row no-gutters mb-2\">\r\n  <div class=\"col-7 input-group input-group-sm\">\r\n    <span class=\"input-group-addon\">\r\n      <input type=\"checkbox\" aria-label=\"选择用户\">\r\n    </span>\r\n    <input class=\"form-control\" name=\"userName\" type=\"text\" value=\"${name}\" maxlength=\"12\" aria-label=\"编辑屏蔽用户\">\r\n  </div>\r\n  <div class=\"col-5 input-group input-group-sm\">\r\n    <select class=\"form-control\" name=\"blockType\">\r\n      <option value=\"0\">主题和回帖</option><option value=\"1\">主题</option><option value=\"2\">回帖</option>\r\n    </select>\r\n    <span class=\"input-group-btn\">\r\n      <button class=\"btn btn-danger\" name=\"delete\" type=\"button\" aria-label=\"删除屏蔽用户\">\r\n        <i class=\"fa fa-trash\" aria-hidden=\"true\"></i>\r\n      </button>\r\n    </span>\r\n  </div>\r\n</li>\r\n`).appendTo($blockUserList).find('[name=\"blockType\"]').val(type);\r\n    };\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        Config.blockUserDefaultType = parseInt($dialog.find('[name=\"blockUserDefaultType\"]').val());\r\n        Config.blockUserAtTipsEnabled = $dialog.find('[name=\"blockUserAtTipsEnabled\"]').prop('checked');\r\n        Config.blockUserForumType = parseInt($dialog.find('[name=\"blockUserForumType\"]').val());\r\n        let blockUserFidList = new Set();\r\n        for (let fid of $.trim($dialog.find('[name=\"blockUserFidList\"]').val()).split(',')) {\r\n            fid = parseInt(fid);\r\n            if (!isNaN(fid) && fid > 0) blockUserFidList.add(fid);\r\n        }\r\n        Config.blockUserFidList = [...blockUserFidList];\r\n        Config.blockUserList = [];\r\n        $blockUserList.find('li').each(function () {\r\n            let $this = $(this);\r\n            let name = $.trim($this.find('[name=\"userName\"]').val());\r\n            if (name && Util.inFollowOrBlockUserList(name, Config.blockUserList) === -1) {\r\n                let type = parseInt($this.find('[name=\"blockType\"]').val());\r\n                Config.blockUserList.push({name, type});\r\n            }\r\n        });\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).find('[data-name=\"modifyMenu\"]').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let value = parseInt($(this).data('value'));\r\n        $blockUserList.find('li:has([type=\"checkbox\"]:checked) select').val(value);\r\n    }).end().find('[name=\"deleteSelect\"]').click(function () {\r\n        let $checked = $blockUserList.find('li:has([type=\"checkbox\"]:checked)');\r\n        if (!$checked.length) return;\r\n        if (confirm('是否删除所选用户？')) $checked.remove();\r\n    }).end().find('[name=\"addUser\"]').keydown(function (e) {\r\n        if (e.keyCode === 13) {\r\n            e.preventDefault();\r\n            $(this).next().find('button').click();\r\n        }\r\n    }).end().find('[name=\"add\"]').click(function () {\r\n        let $addUser = $dialog.find('[name=\"addUser\"]');\r\n        let type = parseInt($dialog.find('[name=\"blockUserDefaultType\"]').val());\r\n        for (let name of $.trim($addUser.val()).split(',')) {\r\n            name = $.trim(name);\r\n            if (!name) continue;\r\n            if (Util.inFollowOrBlockUserList(name, Config.blockUserList) === -1) addBlockUser(name, type);\r\n        }\r\n        $addUser.val('');\r\n    }).end().find('[name=\"blockUserForumType\"]').change(function () {\r\n        $dialog.find('[name=\"blockUserFidList\"]').prop('disabled', parseInt($(this).val()) === 0);\r\n    }).end().find('[name=\"openImOrExBlockUserListDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        Public.showCommonImportOrExportConfigDialog('屏蔽用户', 'blockUserList');\r\n    }).end().find('[name=\"selectAll\"]').click(() => Util.selectAll($blockUserList.find('[type=\"checkbox\"]')))\r\n        .end().find('[name=\"selectInverse\"]').click(() => Util.selectInverse($blockUserList.find('[type=\"checkbox\"]')));\r\n\r\n    $blockUserList.on('click', '[name=\"delete\"]', function () {\r\n        $(this).closest('li').remove();\r\n    });\r\n\r\n    $dialog.find('[name=\"blockUserDefaultType\"]').val(Config.blockUserDefaultType);\r\n    $dialog.find('[name=\"blockUserAtTipsEnabled\"]').prop('checked', Config.blockUserAtTipsEnabled);\r\n    $dialog.find('[name=\"blockUserForumType\"]').val(Config.blockUserForumType).triggerHandler('change');\r\n    $dialog.find('[name=\"blockUserFidList\"]').val(Config.blockUserFidList.join(','));\r\n    for (let user of Config.blockUserList) {\r\n        addBlockUser(user.name, user.type);\r\n    }\r\n    Dialog.show(dialogName);\r\n};\r\n\r\n/**\r\n * 显示屏蔽主题对话框\r\n */\r\nconst showBlockThreadDialog = function () {\r\n    const dialogName = 'blockThreadDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\">\r\n  标题关键字可使用普通字符串或正则表达式，正则表达式请使用<code>/abc/</code>的格式，例：<code>/关键字A.*关键字B/i</code><br>\r\n  用户名和版块ID为可选项（多个用户名或版块ID请用英文逗号分隔）<br>\r\n</p>\r\n<div class=\"form-group mb-2\">\r\n  <label>默认版块屏蔽范围</label>\r\n  <select class=\"custom-select custom-select-sm\" name=\"blockThreadDefForumType\">\r\n    <option value=\"0\">所有版块</option><option value=\"1\">包括指定版块</option><option value=\"2\">排除指定版块</option>\r\n  </select>\r\n</div>\r\n<div class=\"form-group\">\r\n  <label>默认版块ID列表</label>\r\n  <input class=\"form-control form-control-sm\" name=\"blockThreadDefFidList\" type=\"text\">\r\n</div>\r\n<div class=\"table-responsive\">\r\n  <table class=\"table table-sm table-hover table-center text-nowrap\">\r\n    <thead>\r\n      <tr>\r\n        <th>标题关键字(必填)</th>\r\n        <th>屏蔽用户</th>\r\n        <th>用户名</th>\r\n        <th>屏蔽范围</th>\r\n        <th>版块ID</th>\r\n        <th></th>\r\n      </tr>\r\n    </thead>\r\n    <tbody id=\"blockThreadList\"></tbody>\r\n  </table>\r\n</div>\r\n<div class=\"btn-group btn-group-sm mb-3\" role=\"group\">\r\n  <button class=\"btn btn-success\" name=\"add\" type=\"button\">增加</button>\r\n  <button class=\"btn btn-danger\" name=\"clear\" type=\"button\">清空</button>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-warning mr-auto\" name=\"openImOrExBlockThreadListDialog\" type=\"button\">导入/导出</button>\r\n<button class=\"btn btn-primary\" type=\"submit\">保存</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>`;\r\n    let $dialog = Dialog.create(dialogName, '屏蔽主题', bodyContent, footerContent);\r\n    let $blockThreadList = $dialog.find('#blockThreadList');\r\n\r\n    /**\r\n     * 添加屏蔽主题\r\n     * @param {string} keyWord 标题关键字\r\n     * @param {number} userType 屏蔽用户，0：所有；1：包括；2：排除\r\n     * @param {string[]} userList 用户名\r\n     * @param {number} fidType 屏蔽范围，0：所有；1：包括；2：排除\r\n     * @param {number[]} fidList 版块ID列表\r\n     */\r\n    const addBlockThread = function (keyWord, userType, userList, fidType, fidList) {\r\n        $(`\r\n<tr>\r\n  <td>\r\n    <input class=\"form-control form-control-sm\" name=\"keyWord\" type=\"text\" value=\"${keyWord}\" aria-label=\"标题关键字\" style=\"min-width: 12rem;\">\r\n  </td>\r\n  <td>\r\n    <select class=\"custom-select custom-select-sm w-100\" name=\"userType\" aria-label=\"屏蔽用户类型\">\r\n      <option value=\"0\">所有</option><option value=\"1\">包括</option><option value=\"2\">排除</option>\r\n    </select>\r\n  </td>\r\n  <td>\r\n    <input class=\"form-control form-control-sm\" name=\"userList\" type=\"text\" value=\"${userList.join(',')}\" aria-label=\"用户名\"\r\n           ${userType === 0 ? 'disabled' : ''} style=\"min-width: 12rem;\">\r\n  </td>\r\n  <td>\r\n    <select class=\"custom-select custom-select-sm w-100\" name=\"fidType\" aria-label=\"屏蔽范围\">\r\n      <option value=\"0\">所有</option><option value=\"1\">包括</option><option value=\"2\">排除</option>\r\n    </select>\r\n  </td>\r\n  <td>\r\n    <input class=\"form-control form-control-sm\" name=\"fidList\" type=\"text\" value=\"${fidList.join(',')}\" aria-label=\"版块ID列表\"\r\n           ${fidType === 0 ? 'disabled' : ''} style=\"min-width: 8rem;\">\r\n  </td>\r\n  <td class=\"text-left\">\r\n    <button class=\"btn btn-danger btn-sm\" name=\"delete\" type=\"button\" aria-label=\"删除\">\r\n      <i class=\"fa fa-trash\" aria-hidden=\"true\"></i>\r\n    </button>\r\n  </td>\r\n</tr>\r\n`).appendTo($blockThreadList).find('[name=\"userType\"]').val(userType)\r\n            .end().find('[name=\"fidType\"]').val(fidType);\r\n    };\r\n\r\n    /**\r\n     * 验证设置是否正确\r\n     * @returns {boolean} 是否验证通过\r\n     */\r\n    const verify = function () {\r\n        let flag = true;\r\n        $blockThreadList.find('tr').each(function () {\r\n            let $this = $(this);\r\n            let $txtKeyWord = $this.find('[name=\"keyWord\"]');\r\n            let keyWord = $txtKeyWord.val();\r\n            if (!$.trim(keyWord)) return;\r\n            if (/^\\/.+\\/[gimuy]*$/.test(keyWord)) {\r\n                try {\r\n                    eval(keyWord);\r\n                }\r\n                catch (ex) {\r\n                    alert('正则表达式不正确');\r\n                    $txtKeyWord.select().focus();\r\n                    flag = false;\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n        return flag;\r\n    };\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        if (!verify()) return;\r\n        Config.blockThreadDefForumType = parseInt($dialog.find('[name=\"blockThreadDefForumType\"]').val());\r\n        let blockThreadDefFidList = new Set();\r\n        for (let fid of $.trim($dialog.find('[name=\"blockThreadDefFidList\"]').val()).split(',')) {\r\n            fid = parseInt(fid);\r\n            if (!isNaN(fid) && fid > 0) blockThreadDefFidList.add(fid);\r\n        }\r\n        Config.blockThreadDefFidList = [...blockThreadDefFidList];\r\n        Config.blockThreadList = [];\r\n        $blockThreadList.find('tr').each(function () {\r\n            let $this = $(this);\r\n            let keyWord = $this.find('[name=\"keyWord\"]').val();\r\n            if (!$.trim(keyWord)) return;\r\n            let newObj = {keyWord};\r\n\r\n            let userType = parseInt($this.find('[name=\"userType\"]').val());\r\n            if (userType > 0) {\r\n                let userList = new Set();\r\n                for (let user of $.trim($this.find('[name=\"userList\"]').val()).split(',')) {\r\n                    user = $.trim(user);\r\n                    if (user) userList.add(user);\r\n                }\r\n                if (userList.size > 0) newObj[userType === 2 ? 'excludeUser' : 'includeUser'] = [...userList];\r\n            }\r\n\r\n            let fidType = parseInt($this.find('[name=\"fidType\"]').val());\r\n            if (fidType > 0) {\r\n                let fidList = new Set();\r\n                for (let fid of $.trim($this.find('[name=\"fidList\"]').val()).split(',')) {\r\n                    fid = parseInt(fid);\r\n                    if (!isNaN(fid) && fid > 0) fidList.add(fid);\r\n                }\r\n                if (fidList.size > 0) newObj[fidType === 2 ? 'excludeFid' : 'includeFid'] = [...fidList];\r\n            }\r\n            Config.blockThreadList.push(newObj);\r\n        });\r\n        writeConfig();\r\n        Dialog.close(dialogName);\r\n    }).find('[name=\"clear\"]').click(function () {\r\n        if (confirm('是否清除所有屏蔽关键字？')) $blockThreadList.html('');\r\n    }).end().find('[name=\"add\"]').click(function () {\r\n        addBlockThread(\r\n            '', 0, [],\r\n            parseInt($dialog.find('[name=\"blockThreadDefForumType\"]').val()),\r\n            $.trim($dialog.find('[name=\"blockThreadDefFidList\"]').val()).split(',')\r\n        );\r\n    }).end().find('[name=\"blockThreadDefForumType\"]').change(function () {\r\n        $dialog.find('[name=\"blockThreadDefFidList\"]').prop('disabled', parseInt($(this).val()) === 0);\r\n    }).end().find('[name=\"openImOrExBlockThreadListDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        Public.showCommonImportOrExportConfigDialog('屏蔽主题', 'blockThreadList');\r\n    }).end().find('[name=\"selectAll\"]').click(() => Util.selectAll($blockThreadList.find('[type=\"checkbox\"]')))\r\n        .end().find('[name=\"selectInverse\"]').click(() => Util.selectInverse($blockThreadList.find('[type=\"checkbox\"]')));\r\n\r\n    $blockThreadList.on('change', 'select', function () {\r\n        let $this = $(this);\r\n        $this.closest('td').next('td').find('input').prop('disabled', parseInt($this.val()) === 0);\r\n    }).on('click', '[name=\"delete\"]', function () {\r\n        $(this).closest('tr').remove();\r\n    });\r\n\r\n    $dialog.find('[name=\"blockThreadDefForumType\"]').val(Config.blockThreadDefForumType).triggerHandler('change');\r\n    $dialog.find('[name=\"blockThreadDefFidList\"]').val(Config.blockThreadDefFidList.join(','));\r\n    for (let data of Config.blockThreadList) {\r\n        let {keyWord, includeUser, excludeUser, includeFid, excludeFid} = data;\r\n        let userType = 0;\r\n        let userList = [];\r\n        if (typeof includeUser !== 'undefined') {\r\n            userType = 1;\r\n            userList = includeUser;\r\n        }\r\n        else if (typeof excludeUser !== 'undefined') {\r\n            userType = 2;\r\n            userList = excludeUser;\r\n        }\r\n\r\n        let fidType = 0;\r\n        let fidList = [];\r\n        if (typeof includeFid !== 'undefined') {\r\n            fidType = 1;\r\n            fidList = includeFid;\r\n        }\r\n        else if (typeof excludeFid !== 'undefined') {\r\n            fidType = 2;\r\n            fidList = excludeFid;\r\n        }\r\n        addBlockThread(keyWord, userType, userList, fidType, fidList);\r\n    }\r\n    Dialog.show(dialogName);\r\n};\r\n","/* 常量模块 */\r\n'use strict';\r\n\r\n/**\r\n * 常量类\r\n */\r\nconst Const = {\r\n    // 存储多重引用数据的LocalStorage名称\r\n    multiQuoteStorageName: 'kf_multi_quote',\r\n    // at提醒时间的Cookie名称\r\n    atTipsTimeCookieName: 'at_tips_time',\r\n    // 上一次at提醒时间的Cookie名称\r\n    prevAtTipsTimeCookieName: 'prev_at_tips_time',\r\n    // 背景样式的Cookie名称\r\n    bgStyleCookieName: 'bg_style',\r\n    // 常用版块列表\r\n    commonForumList: [\r\n        {fid: 106, name: '新作动态'},\r\n        {fid: 41, name: '网盘下载'},\r\n        {fid: 16, name: '种子下载'},\r\n        {fid: 52, name: '游戏讨论'},\r\n        {fid: 84, name: '动漫讨论'},\r\n        {fid: 67, name: 'CG下载'},\r\n        {fid: 5, name: '自由讨论'},\r\n        {fid: 56, name: '个人日记'},\r\n        {fid: 57, name: '同人漫本'},\r\n    ],\r\n    // 可用版块列表\r\n    availableForumList: [\r\n        {fid: 106, name: '新作动态'},\r\n        {fid: 52, name: '游戏讨论'},\r\n        {fid: 16, name: '种子下载'},\r\n        {fid: 41, name: '网盘下载'},\r\n        {fid: 67, name: 'CG下载'},\r\n        {fid: 102, name: '游戏推荐'},\r\n        {fid: 24, name: '疑难互助'},\r\n        {fid: 57, name: '同人漫本'},\r\n        {fid: 84, name: '动漫讨论'},\r\n        {fid: 92, name: '动画共享'},\r\n        {fid: 127, name: '漫画小说'},\r\n        {fid: 68, name: '音乐共享'},\r\n        {fid: 163, name: 'LIVE共享'},\r\n        {fid: 182, name: '转载资源'},\r\n        {fid: 94, name: '原创绘画'},\r\n        {fid: 87, name: '宅物交流'},\r\n        {fid: 86, name: '电子产品'},\r\n        {fid: 115, name: '文字作品'},\r\n        {fid: 96, name: '图片来源'},\r\n        {fid: 36, name: '寻求资源'},\r\n        {fid: 5, name: '自由讨论'},\r\n        {fid: 56, name: '个人日记'},\r\n        {fid: 9, name: '我的关注'},\r\n        {fid: 4, name: '意见投诉'},\r\n        {fid: 93, name: '管理组区'},\r\n        {fid: 59, name: '原创组区'},\r\n        {fid: 125, name: '水楼林立'},\r\n        {fid: 181, name: '私人日记'},\r\n        {fid: 42, name: '旧期资料'},\r\n        {fid: 128, name: '作品判定'},\r\n        {fid: 98, name: '日本语版'},\r\n        {fid: 99, name: '意見箱'},\r\n        {fid: 112, name: '掲示板'},\r\n        {fid: 100, name: '創作感想'},\r\n    ],\r\n};\r\n\r\nexport default Const;\r\n","/* 对话框模块 */\r\n'use strict';\r\n\r\n/**\r\n * 创建对话框\r\n * @param {string} id 对话框ID\r\n * @param {string} title 对话框标题\r\n * @param {string} bodyContent 对话框主体内容\r\n * @param {string} footerContent 对话框底部内容\r\n * @returns {jQuery} 对话框的jQuery对象\r\n */\r\nexport const create = function (id, title, bodyContent, footerContent = '') {\r\n    let html = `\r\n<form>\r\n<div class=\"dialog\" id=\"${id}\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\" aria-labelledby=\"${id}Title\">\r\n  <div class=\"container dialog-content\" role=\"document\">\r\n    <div class=\"dialog-header\">\r\n      <h5 class=\"dialog-title\" id=\"${id}Title\">${title}</h5>\r\n      <button class=\"close\" data-dismiss=\"dialog\" type=\"button\" aria-label=\"关闭\">\r\n        <span aria-hidden=\"true\">&times;</span>\r\n      </button>\r\n    </div>\r\n    <div class=\"dialog-body\">${bodyContent}</div>\r\n    <div class=\"dialog-footer\" ${!footerContent ? 'hidden' : ''}>${footerContent}</div>\r\n  </div>\r\n</div>\r\n</form>`;\r\n    let $dialog = $(html).appendTo('body');\r\n    $dialog.on('click', '[data-dismiss=\"dialog\"]', () => close(id))\r\n        .on('click', '.tips', () => false)\r\n        .on('click', '.disabled-link', () => false)\r\n        .keydown(function (e) {\r\n            if (e.keyCode === 27) {\r\n                return close(id);\r\n            }\r\n        })\r\n        .find('legend [type=\"checkbox\"]')\r\n        .click(function () {\r\n            let $this = $(this);\r\n            $this.closest('fieldset').prop('disabled', !$this.prop('checked'));\r\n        }).end()\r\n        .find('input[data-disabled]')\r\n        .click(function () {\r\n            let $this = $(this);\r\n            let checked = $this.prop('checked');\r\n            $($this.data('disabled')).each(function () {\r\n                let $this = $(this);\r\n                if ($this.is('a')) {\r\n                    if (checked) $this.removeClass('disabled-link');\r\n                    else $this.addClass('disabled-link');\r\n                }\r\n                else {\r\n                    $this.prop('disabled', !checked);\r\n                }\r\n            });\r\n        }).end().find('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    $(window).on('resize.' + id, function () {\r\n        let $focus = $(':focus');\r\n        if ($focus.length > 0) {\r\n            if ($focus.is('input') && !['checkbox', 'radio'].includes($focus.attr('type')) || $focus.is('textarea')) return;\r\n        }\r\n        resize(id);\r\n    });\r\n    return $dialog;\r\n};\r\n\r\n/**\r\n * 显示对话框\r\n * @param {string} id 对话框ID\r\n */\r\nexport const show = function (id) {\r\n    let $dialog = $('#' + id);\r\n    if (!$dialog.length) return;\r\n    $dialog.find('legend [type=\"checkbox\"]')\r\n        .each(function () {\r\n            $(this).triggerHandler('click');\r\n        }).end().find('input[data-disabled]')\r\n        .each(function () {\r\n            $(this).triggerHandler('click');\r\n        });\r\n    $dialog.fadeIn('fast').find('.close:first').focus();\r\n    resize(id);\r\n};\r\n\r\n/**\r\n * 调整对话框大小\r\n * @param {string} id 对话框ID\r\n */\r\nexport const resize = function (id) {\r\n    let $dialog = $('#' + id);\r\n    $dialog.find('.dialog-body')\r\n        .css('max-height', $(window).height() - $dialog.find('.dialog-header').outerHeight() - $dialog.find('.dialog-footer').outerHeight());\r\n};\r\n\r\n/**\r\n * 关闭对话框\r\n * @param {string} id 对话框ID\r\n * @returns {boolean} 返回false\r\n */\r\nexport const close = function (id) {\r\n    $('#' + id).fadeOut('fast', function () {\r\n        $(this).parent().remove();\r\n    });\r\n    $(window).off('resize.' + id);\r\n    return false;\r\n};\r\n","/* 首页模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 处理首页的@提醒按钮\r\n */\r\nexport const handleAtTipsBtn = function () {\r\n    $('#atTips').click(function () {\r\n        let $this = $(this);\r\n        let time = $this.data('time');\r\n        let cookieValue = Util.getCookie(Const.atTipsTimeCookieName);\r\n        if (!time || time === cookieValue) return;\r\n        if (!cookieValue) {\r\n            let currentDate = (new Date()).getDate();\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, (currentDate < 10 ? '0' + currentDate : currentDate) + '日00时00分');\r\n        }\r\n        else if (cookieValue !== time) {\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, cookieValue);\r\n        }\r\n        Util.setCookie(Const.atTipsTimeCookieName, time, Util.getDate('+3d'));\r\n        $this.removeClass('btn-outline-danger').addClass('btn-outline-primary');\r\n    });\r\n};\r\n\r\n/**\r\n * 处理首页主题链接面板\r\n */\r\nexport const handleIndexThreadPanel = function () {\r\n    if (Config.activeNewReplyPanel) {\r\n        $(`a[data-toggle=\"tab\"][href=\"${Config.activeNewReplyPanel}\"]`).tab('show');\r\n    }\r\n    if (Config.activeTopRecommendPanel) {\r\n        $(`a[data-toggle=\"tab\"][href=\"${Config.activeTopRecommendPanel}\"]`).tab('show');\r\n    }\r\n\r\n    $(document).on('shown.bs.tab', 'a[data-toggle=\"tab\"]', function (e) {\r\n        let $target = $(e.target);\r\n        let targetPanel = $target.attr('href');\r\n        let typeName = '';\r\n        if (targetPanel.includes('NewReplyPanel')) typeName = 'activeNewReplyPanel';\r\n        else if (targetPanel.includes('TopRecommendPanel')) typeName = 'activeTopRecommendPanel';\r\n        if (typeName && Config[typeName] !== targetPanel) {\r\n            readConfig();\r\n            Config[typeName] = targetPanel;\r\n            writeConfig();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理选择页面背景图片\r\n */\r\nexport const handleSelectBgImage = function () {\r\n    $('#selectBgImage').on('click', '[data-id]', function () {\r\n        let $this = $(this);\r\n        let id = $this.data('id');\r\n        let fileName = $this.data('filename');\r\n        let path = $this.parent().data('path');\r\n        if (!id || !fileName || !path) return;\r\n        if (confirm('是否选择此背景图片？')) {\r\n            Util.setCookie(Const.bgStyleCookieName, id, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background-image', 'url(\"' + path + fileName + '\")');\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理选择页面背景颜色\r\n */\r\nexport const handleSelectBgColor = function () {\r\n    $('#selectBgImage').on('click', '[data-color]', function () {\r\n        let $this = $(this);\r\n        let color = $this.data('color');\r\n        if (!color) return;\r\n        if (confirm('是否选择此背景颜色？')) {\r\n            Util.setCookie(Const.bgStyleCookieName, color, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background', color);\r\n            alert('背景已更换');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理自定义背景样式\r\n */\r\nexport const handleCustomBgStyle = function () {\r\n    $('#customBgStyle').click(function () {\r\n        let value = Util.getCookie(Const.bgStyleCookieName);\r\n        if (!value || parseInt(value)) value = '';\r\n        value = prompt(\r\n            '请输入背景图片URL、颜色代码或CSS样式：\\n（例：http://xxx.com/abc.jpg 或 #fcfcfc，留空表示恢复默认背景）\\n' +\r\n            '（注：建议选择简洁、不花哨、偏浅色系的背景图片或颜色）',\r\n            value\r\n        );\r\n        if (value === null) return;\r\n        let $bg = $('body, .modal-content, .dialog-content');\r\n        if ($.trim(value) === '') {\r\n            Util.setCookie(Const.bgStyleCookieName, '', Util.getDate('-1d'));\r\n            alert('背景已恢复默认');\r\n            location.reload();\r\n        }\r\n        else if (/^https?:\\/\\/[^\"']+/.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $bg.css('background-image', 'url(\"' + value + '\")');\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n        else if (/^#[0-9a-f]{6}$/i.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $bg.css('background', value.toLowerCase());\r\n            alert('背景已更换');\r\n        }\r\n        else if (!/[<>{}]/.test(value)) {\r\n            value = value.replace(';', '');\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $bg.css('background', value);\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n        else {\r\n            alert('格式不正确');\r\n        }\r\n    });\r\n};\r\n","/* 消息模块 */\r\n'use strict';\r\n\r\n/**\r\n * 显示消息\r\n * @param {string|Object} options 消息或设置对象\r\n * @param {string} [options.msg] 消息\r\n * @param {number} [options.duration={@link Config.defShowMsgDuration}] 消息显示时间（秒），-1为永久显示\r\n * @param {boolean} [options.clickable=true] 消息框可否手动点击消除\r\n * @param {boolean} [options.preventable=false] 是否阻止点击网页上的其它元素\r\n * @param {number} [duration] 消息显示时间（秒），-1为永久显示\r\n * @example\r\n * show('<span class=\"mr-3\">使用道具</span><span class=\"text-item\">神秘系数<em class=\"text-warning\">+1</em></span>', -1);\r\n * show({\r\n *   msg: '<span class=\"mr-3\">抽取神秘盒子</span><span class=\"text-item\">KFB<em class=\"text-warning\">+8</em></span>',\r\n *   duration: 20,\r\n *   clickable: false,\r\n * });\r\n * @returns {jQuery} 消息框对象\r\n */\r\nexport const show = function (options, duration) {\r\n    let settings = {\r\n        msg: '',\r\n        duration: Config.defShowMsgDuration,\r\n        clickable: true,\r\n        preventable: false,\r\n    };\r\n    if ($.type(options) === 'object') {\r\n        $.extend(settings, options);\r\n    }\r\n    else {\r\n        settings.msg = options;\r\n        settings.duration = typeof duration === 'undefined' ? Config.defShowMsgDuration : duration;\r\n    }\r\n\r\n    let $container = $('.msg-container');\r\n    let isFirst = $container.length === 0;\r\n    if (!isFirst && !$('.mask').length) {\r\n        if ($container.height() >= $(window).height() * 0.8) {\r\n            destroy();\r\n            isFirst = true;\r\n        }\r\n    }\r\n    if (settings.preventable && !$('.mask').length) {\r\n        $('<div class=\"mask\"></div>').appendTo('body');\r\n    }\r\n    if (isFirst) {\r\n        $container = $('<div class=\"container msg-container\"></div>').appendTo('body');\r\n    }\r\n\r\n    let $msg = $(`<div class=\"msg\">${settings.msg}</div>`).appendTo($container);\r\n    $msg.on('click', '.stop-action', function (e) {\r\n        e.preventDefault();\r\n        $(this).text('正在停止&hellip;').closest('.msg').data('stop', true);\r\n    });\r\n    if (settings.clickable) {\r\n        $msg.css('cursor', 'pointer').click(function () {\r\n            hide($(this));\r\n        }).find('a').click(function (e) {\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n    if (settings.preventable) $msg.attr('preventable', true);\r\n    $msg.slideDown('normal');\r\n    if (settings.duration > -1) {\r\n        setTimeout(() => {\r\n            hide($msg);\r\n        }, settings.duration * 1000);\r\n    }\r\n    return $msg;\r\n};\r\n\r\n/**\r\n * 显示等待消息\r\n * @param {string} msg 消息\r\n * @param {boolean} preventable 是否阻止点击网页上的其它元素\r\n * @returns {jQuery} 消息框对象\r\n */\r\nexport const wait = function (msg, preventable = true) {\r\n    return show({msg, duration: -1, clickable: false, preventable});\r\n};\r\n\r\n/**\r\n * 隐藏指定消息框\r\n * @param {jQuery} $msg 消息框对象\r\n */\r\nexport const hide = function ($msg) {\r\n    $msg.slideUp('normal', function () {\r\n        remove($(this));\r\n    });\r\n};\r\n\r\n/**\r\n * 移除指定消息框\r\n * @param {jQuery} $msg 消息框对象\r\n */\r\nexport const remove = function ($msg) {\r\n    let $container = $msg.parent();\r\n    $msg.remove();\r\n    if (!$('.msg').length) {\r\n        $container.remove();\r\n        $('.mask').remove();\r\n    }\r\n    else if (!$('.msg[preventable]').length) {\r\n        $('.mask').remove();\r\n    }\r\n};\r\n\r\n/**\r\n * 销毁所有消息框\r\n */\r\nexport const destroy = function () {\r\n    $('.msg-container').remove();\r\n    $('.mask').remove();\r\n};\r\n","/* 其它模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 高亮关键词页面中未读的消息\r\n */\r\nexport const highlightUnReadAtTipsMsg = function () {\r\n    if (pageInfo.gjc !== pageInfo.userName) return;\r\n    let timeString = Util.getCookie(Const.prevAtTipsTimeCookieName);\r\n    if (!timeString || !/^\\d+日\\d+时\\d+分$/.test(timeString)) return;\r\n    let prevString = '';\r\n    $('.thread-list-item time').each(function (index) {\r\n        let $this = $(this);\r\n        let curString = $.trim($this.text());\r\n        if (index === 0) prevString = curString;\r\n        if (timeString < curString && prevString >= curString) {\r\n            $this.addClass('text-danger');\r\n            prevString = curString;\r\n        }\r\n        else return false;\r\n    });\r\n\r\n    $(document).on('click', '.thread-list-item .thread-link-item a', function () {\r\n        Util.deleteCookie(Const.prevAtTipsTimeCookieName);\r\n    });\r\n};\r\n\r\n/**\r\n * 处理游戏搜索区域\r\n */\r\nexport const handleGameIntroSearchArea = function () {\r\n    $('#gameSearchKeyword').val(pageInfo.keyword);\r\n    $('#gameSearchType').val(pageInfo.searchType);\r\n};\r\n\r\n/**\r\n * 推游戏介绍\r\n * @param {string} type 页面类型\r\n */\r\nexport const tuiGameIntro = function (type) {\r\n    let cookieName = '';\r\n    if (type === 'company') cookieName = 'g_intro_inc_tui_';\r\n    else if (type === 'type') cookieName = 'g_intro_adv_tui_';\r\n    else if (type === 'property') cookieName = 'g_intro_moe_tui_';\r\n    else cookieName = 'g_intro_tui_';\r\n    cookieName += pageInfo.id;\r\n    let url = Util.makeUrl('game_intro/' + type, `id=${pageInfo.id}&tui=1`);\r\n\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        if (Util.getCookie(cookieName, '')) {\r\n            alert('你在48小时内已经推过');\r\n            return;\r\n        }\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: url,\r\n            success: function () {\r\n                let $num = $this.find('span:first');\r\n                let num = parseInt($num.text());\r\n                $num.text('+1');\r\n                setTimeout(() => {\r\n                    $num.text(++num);\r\n                }, 1000);\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            },\r\n            dataType: 'html'\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定收藏夹页面按钮点击事件\r\n */\r\nexport const bindFavorPageBtnsClick = function () {\r\n    let $form = $('form[name=\"favorForm\"]');\r\n\r\n    $(document).on('click', '.remove-catalog', () => confirm('是否删除该目录？'));\r\n\r\n    $('#addCatalog').click(function (e) {\r\n        e.preventDefault();\r\n        let type = $.trim(prompt('请输入收藏夹目录名称：'));\r\n        if (!type) return;\r\n        $form.find('[name=\"job\"]').val('addtype');\r\n        $form.find('[name=\"type\"]').val(type);\r\n        $form.submit();\r\n    });\r\n\r\n    $('#favorActionBtns').on('click', 'button', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectInverse') {\r\n            Util.selectInverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否删除这${$checked.length}项？`)) {\r\n                $form.find('[name=\"job\"]').val('clear');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n\r\n    $('#convertCatalogDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let type = $(this).data('type');\r\n        let $checked = $('[name=\"delid[]\"]:checked');\r\n        if ($checked.length > 0 && confirm(`是否将这${$checked.length}项转换到指定目录？`)) {\r\n            $form.find('[name=\"job\"]').val('change');\r\n            $form.find('[name=\"type\"]').val(type);\r\n            $form.submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定好友列表页面按钮点击事件\r\n */\r\nexport const bindFriendPageBtnsClick = function () {\r\n    $('#friendActionBtns').on('click', '[type=\"button\"]', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"selid[]\"]'));\r\n        }\r\n        else if (action === 'selectInverse') {\r\n            Util.selectInverse($('[name=\"selid[]\"]'));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 在账号设置页面里为生日字段赋值\r\n */\r\nexport const assignBirthdayField = function () {\r\n    $('#birthday').change(function () {\r\n        let value = $(this).val().trim();\r\n        let matches = /(\\d{4})-(\\d{1,2})-(\\d{1,2})/.exec(value);\r\n        let year = '', month = '', day = '';\r\n        if (matches) {\r\n            year = parseInt(matches[1]);\r\n            month = parseInt(matches[2]);\r\n            day = parseInt(matches[3]);\r\n        }\r\n        $('[name=\"proyear\"]').val(year);\r\n        $('[name=\"promonth\"]').val(month);\r\n        $('[name=\"proday\"]').val(day);\r\n    });\r\n};\r\n\r\n/**\r\n * 同步主题每页楼层数量的设置\r\n */\r\nexport const syncPerPageFloorNum = function () {\r\n    /**\r\n     * 同步设置\r\n     */\r\n    const syncConfig = function () {\r\n        let perPageFloorNum = parseInt($('[name=\"p_num\"]').val());\r\n        if (perPageFloorNum === 0) perPageFloorNum = 10;\r\n        if (!isNaN(perPageFloorNum) && perPageFloorNum !== Config.perPageFloorNum) {\r\n            Config.perPageFloorNum = perPageFloorNum;\r\n            writeConfig();\r\n        }\r\n    };\r\n\r\n    syncConfig();\r\n    $('#creator').submit(function () {\r\n        readConfig();\r\n        syncConfig();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理上传头像文件浏览按钮\r\n */\r\nexport const handleUploadAvatarFileBtn = function () {\r\n    $('#browseAvatar').change(function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png'].includes(matches[1].toLowerCase())) {\r\n            alert('头像图片类型不匹配');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 转账提醒\r\n */\r\nexport const transferKfbAlert = function () {\r\n    $('#transferKfbForm').submit(function () {\r\n        let $this = $(this);\r\n        let transferKfb = parseInt($this.find('[name=\"to_money\"]').val());\r\n        let fixedDeposit = parseInt($('#fixedDeposit').text());\r\n        let currentDeposit = parseInt($('#currentDeposit').text());\r\n        if (transferKfb > 0 && fixedDeposit > 0 && transferKfb > currentDeposit) {\r\n            if (!confirm('你的活期存款不足，转账金额将从定期存款里扣除，是否继续？')) {\r\n                return false;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定短消息页面操作按钮点击事件\r\n */\r\nexport const bindMessageActionBtnsClick = function () {\r\n    $('#messageActionBtns').on('click', 'button', function () {\r\n        let $form = $('#messageListForm');\r\n        let name = $(this).attr('name');\r\n        if (name === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (name === 'selectInverse') {\r\n            Util.selectInverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (name === 'selectCustom') {\r\n            let title = $.trim(\r\n                prompt('请填写所要选择的包含指定字符串的短消息标题（可用|符号分隔多个标题）', '收到了他人转账的KFB|银行汇款通知|您的文章被评分|您的文章被删除')\r\n            );\r\n            if (!title) return;\r\n            $('[name=\"delid[]\"]').prop('checked', false);\r\n            $('a.thread-link').each(function () {\r\n                let $this = $(this);\r\n                for (let key of title.split('|')) {\r\n                    if ($this.text().toLowerCase().includes(key.toLowerCase())) {\r\n                        $this.parent().find('[name=\"delid[]\"]').prop('checked', true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else if (name === 'download') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否下载这${$checked.length}项？`)) {\r\n                $form.attr('action', '/message.php').find('[name=\"action\"]').val('down');\r\n                $form.submit();\r\n            }\r\n        }\r\n        else if (name === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否删除这${$checked.length}项？`)) {\r\n                $form.attr('action', Util.makeUrl('message/job')).find('[name=\"action\"]').val('del');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 验证注册页面字段\r\n */\r\nexport const validateRegisterField = function () {\r\n    $(document).on('change', 'input[name]', function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        let value = $this.val();\r\n        if (!value) {\r\n            Util.showValidationMsg($this, 'clear');\r\n            return;\r\n        }\r\n        if (name === 'regemail') {\r\n            Util.showValidationMsg($this, 'wait', '检查中，请稍等&hellip;');\r\n            $.post(Util.makeUrl('register/check'), 'username=' + value, ({type, msg, username}) => {\r\n                if ($this.val() === username) {\r\n                    Util.showValidationMsg($this, type, msg);\r\n                }\r\n            }).fail(() => {\r\n                Util.showValidationMsg($this, 'error', '响应失败');\r\n            });\r\n        }\r\n        else if (name === 'regpwd') {\r\n            if (value.length > 16 || value.length < 6) {\r\n                Util.showValidationMsg($this, 'error', '密码长度不正确');\r\n            }\r\n            else {\r\n                Util.showValidationMsg($this, 'clear');\r\n                $('[name=\"regpwdrepeat\"]').trigger('change');\r\n            }\r\n        }\r\n        else if (name === 'regpwdrepeat') {\r\n            if (value !== $('[name=\"regpwd\"]').val()) Util.showValidationMsg($this, 'error', '两次输入的密码不相符');\r\n            else Util.showValidationMsg($this, 'clear');\r\n        }\r\n    });\r\n\r\n    $('#registerForm').submit(function () {\r\n        if ($(this).find('.has-danger').length > 0) {\r\n            alert('请正确填写表单');\r\n            return false;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理个人信息页面下的按钮\r\n */\r\nexport const handleUserPageBtns = function () {\r\n    let $area = $('#profileBtns');\r\n    let userName = $area.data('username');\r\n    $area.on('click', '[name=\"followUser\"], [name=\"blockUser\"]', function () {\r\n        readConfig();\r\n        let $this = $(this);\r\n        let str = '关注';\r\n        let userList = Config.followUserList;\r\n        if ($this.attr('name') === 'blockUser') {\r\n            str = '屏蔽';\r\n            userList = Config.blockUserList;\r\n            Config.blockUserEnabled = true;\r\n        }\r\n        else Config.followUserEnabled = true;\r\n        if ($this.text().includes('取消')) {\r\n            let index = Util.inFollowOrBlockUserList(userName, userList);\r\n            if (index > -1) {\r\n                userList.splice(index, 1);\r\n                writeConfig();\r\n            }\r\n            $this.removeClass('btn-outline-danger').addClass('btn-outline-primary').find('span').text(str + '用户');\r\n            alert('该用户已被取消' + str);\r\n        }\r\n        else {\r\n            if (Util.inFollowOrBlockUserList(userName, userList) === -1) {\r\n                if (str === '屏蔽') {\r\n                    let type = Config.blockUserDefaultType;\r\n                    type = prompt('请填写屏蔽类型，0：主题和回帖；1：主题；2：回帖', type);\r\n                    if (type === null) return;\r\n                    type = parseInt(type);\r\n                    if (isNaN(type) || type < 0 || type > 2) type = Config.blockUserDefaultType;\r\n                    userList.push({name: userName, type: type});\r\n                }\r\n                else {\r\n                    userList.push({name: userName});\r\n                }\r\n                writeConfig();\r\n            }\r\n            $this.removeClass('btn-outline-primary').addClass('btn-outline-danger').find('span').text('取消' + str);\r\n            alert('该用户已被' + str);\r\n        }\r\n    }).find('[name=\"followUser\"], [name=\"blockUser\"]').each(function () {\r\n        let $this = $(this);\r\n        let str = '关注';\r\n        let userList = Config.followUserList;\r\n        if ($this.attr('name') === 'blockUser') {\r\n            str = '屏蔽';\r\n            userList = Config.blockUserList;\r\n        }\r\n        if (Util.inFollowOrBlockUserList(userName, userList) > -1) {\r\n            $this.removeClass('btn-outline-primary').addClass('btn-outline-danger').find('span').text('取消' + str);\r\n        }\r\n    });\r\n};\r\n","/* 发帖模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport * as Msg from './msg';\r\n\r\n/**\r\n * 处理编辑器按钮\r\n */\r\nexport const handleEditorBtns = function () {\r\n    let textArea = $('#postContent').get(0);\r\n\r\n    // 编辑器按钮\r\n    $(document).on('click', '.editor-btn-group button[data-action]', function () {\r\n        let action = $(this).data('action');\r\n        let value = '';\r\n        switch (action) {\r\n            case 'link':\r\n                value = prompt('请输入链接URL：', 'http://');\r\n                break;\r\n            case 'img':\r\n                value = prompt('请输入图片URL：', 'http://');\r\n                break;\r\n            case 'sell':\r\n                value = prompt('请输入出售金额：', 1);\r\n                break;\r\n            case 'hide':\r\n                value = prompt('请输入神秘等级：', 1);\r\n                break;\r\n            case 'audio': {\r\n                value = prompt('请输入HTML5音频实际地址：\\n（可直接输入网易云音乐或虾米的单曲地址，将自动转换为外链地址）', 'http://');\r\n                let matches = /^https?:\\/\\/music\\.163\\.com\\/(?:#\\/)?song\\?id=(\\d+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/163/${matches[1]}.mp3`;\r\n                matches = /^https?:\\/\\/www\\.xiami\\.com\\/song\\/(\\d+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/xiami/${matches[1]}.mp3`;\r\n            }\r\n                break;\r\n            case 'video': {\r\n                value = prompt('请输入HTML5视频实际地址：\\n（可直接输入YouTube视频页面的地址，将自动转换为外链地址）', 'http://');\r\n                let matches = /^https?:\\/\\/(?:www\\.)?youtube\\.com\\/watch\\?v=([\\w\\-]+)/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n                matches = /^https?:\\/\\/youtu\\.be\\/([\\w\\-]+)$/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n            }\r\n                break;\r\n        }\r\n        if (value === null) return;\r\n\r\n        let selText = '';\r\n        let code = '';\r\n        switch (action) {\r\n            case 'link':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[url=${value}]${selText}[/url]`;\r\n                break;\r\n            case 'img':\r\n                code = `[img]${value}[/img]`;\r\n                break;\r\n            case 'quote':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[quote]${selText}[/quote]`;\r\n                break;\r\n            case 'code':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[code]${selText}[/code]`;\r\n                break;\r\n            case 'sell':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sell=${value}]${selText}[/sell]`;\r\n                break;\r\n            case 'hide':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[hide=${value}]${selText}[/hide]`;\r\n                break;\r\n            case 'bold':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[b]${selText}[/b]`;\r\n                break;\r\n            case 'italic':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[i]${selText}[/i]`;\r\n                break;\r\n            case 'underline':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[u]${selText}[/u]`;\r\n                break;\r\n            case 'strike':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[strike]${selText}[/strike]`;\r\n                break;\r\n            case 'super':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sup]${selText}[/sup]`;\r\n                break;\r\n            case 'sub':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sub]${selText}[/sub]`;\r\n                break;\r\n            case 'horizontal':\r\n                code = `[hr]`;\r\n                break;\r\n            case 'align-left':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=left]${selText}[/align]`;\r\n                break;\r\n            case 'align-center':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=center]${selText}[/align]`;\r\n                break;\r\n            case 'align-right':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=right]${selText}[/align]`;\r\n                break;\r\n            case 'fly':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[fly]${selText}[/fly]`;\r\n                break;\r\n            case 'audio':\r\n                code = `[audio]${value}[/audio]`;\r\n                break;\r\n            case 'video':\r\n                code = `[video]${value}[/video]`;\r\n                break;\r\n        }\r\n        if (!code) return;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // 字号下拉菜单\r\n    $('#fontSizeDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let size = $(this).data('size');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[size=${size}]${selText}[/size]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // 颜色、背景颜色下拉菜单\r\n    $('#colorDropdownMenu, #bgColorDropdownMenu').on('click', 'span', function () {\r\n        let $this = $(this);\r\n        let codeType = $this.parent().is('#bgColorDropdownMenu') ? 'backcolor' : 'color';\r\n        let color = $this.data('color');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[${codeType}=${color}]${selText}[/${codeType}]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 检查发帖表单\r\n */\r\nexport const checkPostForm = function () {\r\n    $('#postForm').submit(function () {\r\n        let $postType = $('#postType');\r\n        if ($postType.length > 0 && !$postType.val()) {\r\n            alert('没有选择主题分类');\r\n            $postType.focus();\r\n            return false;\r\n        }\r\n\r\n        let $postTitle = $('#postTitle');\r\n        if ($postTitle.length > 0) {\r\n            let length = Util.getStrByteLen($postTitle.val());\r\n            if (!length) {\r\n                alert('标题不能为空');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n            else if (length > 100) {\r\n                alert('标题超过最大长度 100 个字节');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $voteItemContent = $('#voteItemContent');\r\n        if ($voteItemContent.length > 0) {\r\n            if (!$voteItemContent.val().trim()) {\r\n                alert('投票选项不能为空');\r\n                $voteItemContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postContent = $('#postContent');\r\n        if ($postContent.length > 0) {\r\n            let length = Util.getStrByteLen($postContent.val().trim());\r\n            if (length < 12) {\r\n                alert('文章内容少于 12 个字节');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n            else if (length > 50000) {\r\n                alert('文章内容大于 50000 个字节');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postGjc = $('#postGjc');\r\n        if ($postGjc.length > 0 && pageInfo.action === 'new' && !$postGjc.val().trim()) {\r\n            alert('请在内容文本框的下方填写关键词，以方便搜索，也可以在标题中选择任意一个词填入');\r\n            $postGjc.focus();\r\n            return false;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理附件按钮\r\n */\r\nexport const handleAttachBtns = function () {\r\n    $(document).on('click', '.attach-area a[data-action]', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let $area = $this.closest('.attach-area');\r\n        let action = $this.data('action');\r\n        let id = $area.data('id');\r\n        if (!id) return;\r\n        if (action === 'insert') {\r\n            let type = $this.data('type');\r\n            let textArea = $('#postContent').get(0);\r\n            let code = `[${type === 'new' ? 'upload' : 'attachment'}=${id}]`;\r\n            Util.addCode(textArea, code);\r\n            textArea.focus();\r\n        }\r\n        else if (action === 'update') {\r\n            $area.find('.attach-info').prop('hidden', true).after(\r\n                `<label><input name=\"replace_${id}\" type=\"file\" aria-label=\"选择附件\"></label>`\r\n            );\r\n            $this.data('action', 'cancel').text('取消').blur();\r\n            if (!$(document).data('attachUpdateAlert')) {\r\n                alert('本反向代理服务器为了提高性能对图片设置了缓存，更新附件图片后可能需等待最多30分钟才能看到效果');\r\n                $(document).data('attachUpdateAlert', true);\r\n            }\r\n        }\r\n        else if (action === 'cancel') {\r\n            $area.find('.attach-info').prop('hidden', false).next('label').remove();\r\n            $this.data('action', 'update').text('更新').blur();\r\n        }\r\n        else if (action === 'delete') {\r\n            $area.remove();\r\n        }\r\n    });\r\n\r\n    $(document).on('change', '[type=\"file\"]', function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png', 'torrent'].includes(matches[1].toLowerCase())) {\r\n            alert('附件类型不匹配');\r\n            return;\r\n        }\r\n\r\n        let type = $this.data('type');\r\n        if (type === 'new') {\r\n            $this.removeData('type').parent().next().prop('hidden', false);\r\n\r\n            let $newAttachArea = $('#newAttachArea');\r\n            let totalNum = $newAttachArea.find('[type=\"file\"]').length;\r\n            if (totalNum >= 5) return;\r\n            let $lastAttachArea = $newAttachArea.find('[type=\"file\"]:last').closest('.attach-area');\r\n            let id = parseInt($lastAttachArea.data('id'));\r\n            if (!id) return;\r\n            id++;\r\n            $(`\r\n<div class=\"form-group row font-size-sm attach-area\" data-id=\"${id}\">\r\n  <div class=\"col-xs-12 col-form-label\">\r\n    <label>\r\n      <input name=\"attachment_${id}\" data-type=\"new\" type=\"file\" aria-label=\"选择附件\">\r\n    </label>\r\n    <span hidden>\r\n      <a data-action=\"insert\" data-type=\"new\" href=\"#\">插入</a>&nbsp;\r\n      <a data-action=\"delete\" href=\"#\">删除</a>\r\n    </span>\r\n  </div>\r\n  <div class=\"col-xs-4\">\r\n    <label class=\"sr-only\" for=\"atc_downrvrc${id}\">神秘系数</label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_downrvrc${id}\" name=\"atc_downrvrc${id}\" data-toggle=\"tooltip\" \r\ntype=\"number\" value=\"0\" min=\"0\" title=\"神秘系数\" placeholder=\"神秘系数\">\r\n  </div>\r\n  <div class=\"col-xs-8\">\r\n    <label class=\"sr-only\" for=\"atc_desc${id}\">描述</label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_desc${id}\" name=\"atc_desc${id}\" data-toggle=\"tooltip\" type=\"text\" \r\ntitle=\"描述\" placeholder=\"描述\">\r\n  </div>\r\n</div>\r\n`).insertAfter($lastAttachArea).find('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 插入表情代码\r\n * @param {jQuery} $node 想要绑定的节点的jQuery对象\r\n */\r\nexport const addSmileCode = function ($node) {\r\n    $('.smile-panel').on('click', 'img', function () {\r\n        $('.smile-panel').addClass('open');\r\n        let textArea = $node.get(0);\r\n        if (!textArea) return;\r\n        let code = `[s:${$(this).data('id')}]`;\r\n        Util.addCode(textArea, code, '');\r\n        textArea.blur();\r\n    }).parent().on('shown.bs.dropdown', function () {\r\n        $('.smile-panel img').each(function () {\r\n            let $this = $(this);\r\n            if (!$this.attr('src')) {\r\n                $this.attr('src', $this.data('src'));\r\n            }\r\n        });\r\n    }).on('hide.bs.dropdown', function (e) {\r\n        let $relatedTarget = $(e.relatedTarget);\r\n        if (!$relatedTarget.data('open')) $relatedTarget.removeData('open');\r\n        else return e.preventDefault();\r\n    });\r\n\r\n    $('#smileDropdownBtn').click(function () {\r\n        let $this = $(this);\r\n        $this.data('open', !$this.data('open'));\r\n    });\r\n};\r\n\r\n/**\r\n * 处理多重回复和多重引用\r\n * @param {number} type 处理类型，1：多重回复；2：多重引用\r\n */\r\nexport const handleMultiQuote = function (type = 1) {\r\n    let data = localStorage[Const.multiQuoteStorageName];\r\n    if (!data) return;\r\n    try {\r\n        data = JSON.parse(data);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) return;\r\n    let {tid, quoteList} = data;\r\n    if (!pageInfo.tid || tid !== pageInfo.tid || $.type(quoteList) !== 'object') return;\r\n    if (type === 2 && !pageInfo.fid) return;\r\n    let list = [];\r\n    for (let data of Object.values(quoteList)) {\r\n        if ($.type(data) !== 'array') continue;\r\n        for (let quote of data) {\r\n            list.push(quote);\r\n        }\r\n    }\r\n    if (!list.length) {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        return;\r\n    }\r\n\r\n    let keywords = new Set();\r\n    let content = '';\r\n    if (type === 2) {\r\n        Msg.wait(`<span class=\"mr-3\">正在获取引用内容中&hellip;</span>剩余：<em class=\"text-warning countdown-num\">${list.length}</em>`);\r\n        $(document).clearQueue('MultiQuote');\r\n    }\r\n    for (let [index, quote] of list.entries()) {\r\n        if (!('floor' in quote) || !('pid' in quote)) continue;\r\n        keywords.add(quote.userName);\r\n        if (type === 2) {\r\n            $(document).queue('MultiQuote', function () {\r\n                $.get(Util.makeUrl(\r\n                    'post/index',\r\n                    `action=quote&fid=${pageInfo.fid}&tid=${tid}&pid=${quote.pid}&article=${quote.floor}&t=${new Date().getTime()}`\r\n                ), function ({postContent}) {\r\n                    content += postContent ? postContent + (index === list.length - 1 ? '' : '\\n') : '';\r\n                    let $countdownNum = $('.countdown-num:last');\r\n                    $countdownNum.text(parseInt($countdownNum.text()) - 1);\r\n                    if (index === list.length - 1) {\r\n                        Msg.destroy();\r\n                        $('#postContent').val(content).focus();\r\n                    }\r\n                    else {\r\n                        setTimeout(function () {\r\n                            $(document).dequeue('MultiQuote');\r\n                        }, 100);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            content += `[quote]回 ${quote.floor}楼(${quote.userName}) 的帖子[/quote]\\n`;\r\n        }\r\n    }\r\n    $('[name=\"diy_guanjianci\"]').val([...keywords].join(','));\r\n    $('#postForm').submit(function () {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n    });\r\n    if (type === 2) $(document).dequeue('MultiQuote');\r\n    else $('#postContent').val(content).focus();\r\n};\r\n\r\n/**\r\n * 处理清除多重引用数据按钮\r\n */\r\nexport const handleClearMultiQuoteDataBtn = function () {\r\n    $('.clear-multi-quote-data-btn').click(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('是否清除多重引用数据？')) return;\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        $('[name=\"diy_guanjianci\"]').val('');\r\n        $('#postContent').val('');\r\n    });\r\n};\r\n","/* 公共模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport * as Dialog from './dialog';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\nimport * as ConfigDialog from './configDialog';\r\n\r\n/**\r\n * 处理主菜单\r\n */\r\nexport const handleMainMenu = function () {\r\n    $('#mainMenuTogglerBtn').click(function () {\r\n        let maxHeight = document.documentElement.clientHeight - $(this).closest('.navbar').outerHeight();\r\n        if (maxHeight > 0) {\r\n            $('#mainMenu').css('max-height', maxHeight + 'px');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理主菜单链接\r\n */\r\nexport const handleMainMenuLink = function () {\r\n    $('#mainMenu').find('[data-name=\"openConfigDialog\"]').click(function (e) {\r\n        e.preventDefault();\r\n        $('#mainMenuTogglerBtn').click();\r\n        ConfigDialog.show();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理滚动到页顶/页底按钮\r\n */\r\nexport const handleRollToTopOrBottomBtn = function () {\r\n    $(window).scroll(function () {\r\n        let $btn = $('#rollToTopOrBottom');\r\n        if ($(window).scrollTop() > 640) {\r\n            if ($btn.data('direction') === 'top') return;\r\n            $btn.data('direction', 'top').attr('aria-label', '滚动到页顶')\r\n                .find('i').removeClass('fa-chevron-down').addClass('fa-chevron-up');\r\n        }\r\n        else {\r\n            if ($btn.data('direction') === 'bottom') return;\r\n            $btn.data('direction', 'bottom').attr('aria-label', '滚动到页底')\r\n                .find('i').removeClass('fa-chevron-up').addClass('fa-chevron-down');\r\n        }\r\n    });\r\n\r\n    $('#rollToTopOrBottom').click(function () {\r\n        let scrollTop = $(this).data('direction') === 'bottom' ? $('body').height() : 0;\r\n        $('body, html').animate({scrollTop: scrollTop});\r\n    });\r\n};\r\n\r\n/**\r\n * 处理搜索对话框\r\n */\r\nexport const handleSearchDialog = function () {\r\n    let $searchDialog = $('#searchDialog');\r\n\r\n    $searchDialog.on('shown.bs.modal', function () {\r\n        $('#searchKeyword').select().focus();\r\n    }).find('form').submit(function () {\r\n        let $this = $(this);\r\n        let $searchKeyword = $this.find('#searchKeyword');\r\n        let searchType = $this.find('#searchType').val();\r\n        let keyword = $.trim($searchKeyword.val());\r\n        if (searchType === 'gjc') {\r\n            $this.attr('action', Util.makeUrl('gjc/' + keyword));\r\n        }\r\n        else if (searchType === 'username') {\r\n            $this.attr('action', Util.makeUrl('user/username/' + keyword));\r\n        }\r\n        else {\r\n            $this.attr('action', Util.makeUrl('search'));\r\n            $searchKeyword.attr('name', searchType === 'author' ? 'pwuser' : 'keyword');\r\n            if (searchType === 'title') {\r\n                if (keyword.length && Util.getStrByteLen(keyword) <= 2) {\r\n                    let $method = $this.find('[name=\"method\"]');\r\n                    $method.val('OR');\r\n                    $searchKeyword.val(keyword + ' ' + Math.floor(new Date().getTime() / 1000));\r\n                    setTimeout(() => {\r\n                        $searchKeyword.val(keyword);\r\n                        $method.val('AND');\r\n                    }, 200);\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    $searchDialog.find('[name=\"searchRange\"]').on('click', function () {\r\n        let value = 'all';\r\n        if ($(this).val() === 'current') value = pageInfo.fid;\r\n        $searchDialog.find('[name=\"f_fid\"]').val(value);\r\n    });\r\n\r\n    let $current = $searchDialog.find('[name=\"searchRange\"][value=\"current\"]');\r\n    let $currentBox = $current.closest('.form-check-inline');\r\n    $searchDialog.find('#searchType').change(function () {\r\n        let searchType = $(this).val();\r\n        if (!$current.data('enabled')) return;\r\n        let disabled = searchType === 'gjc' || searchType === 'username';\r\n        $current.prop('disabled', disabled);\r\n        if (disabled) $currentBox.addClass('disabled');\r\n        else $currentBox.removeClass('disabled');\r\n    });\r\n\r\n    if (pageId === 'threadPage' || pageId === 'readPage') {\r\n        $current.prop('disabled', false).data('enabled', true).click();\r\n        $currentBox.removeClass('disabled');\r\n    }\r\n};\r\n\r\n/**\r\n * 处理分页导航\r\n */\r\nexport const handlePageInput = function () {\r\n    $(document).on('click', '.page-input', function (e) {\r\n        e.preventDefault();\r\n        if (pageInfo.maxPageNum && pageInfo.maxPageNum <= 1) return;\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let excludeParams = $(this).data('exclude');\r\n        if (excludeParams) excludeParams = excludeParams.split(',');\r\n        else excludeParams = [];\r\n        let num = parseInt(\r\n            prompt(`要跳转到第几页？${pageInfo.maxPageNum ? `（共${pageInfo.maxPageNum}页）` : ''}`, pageInfo.currentPageNum)\r\n        );\r\n        if (num && num > 0) {\r\n            location.href = Util.makeUrl(action, 'page=' + num, true, excludeParams);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定快速提交的快捷键\r\n * @param {jQuery} $node 想要绑定的节点的jQuery对象\r\n */\r\nexport const bindFastSubmitShortcutKey = function ($node) {\r\n    $node.keydown(function (e) {\r\n        if (e.keyCode === 13 && e.ctrlKey) {\r\n            $(this).closest('form').submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 显示编辑常用版块对话框\r\n */\r\nexport const showEditCommonForumDialog = function () {\r\n    $(document).on('click', '.edit-common-forum-btn', function (e) {\r\n        e.preventDefault();\r\n        const dialogName = 'editCommonForumDialog';\r\n        if ($('#' + dialogName).length > 0) return;\r\n        readConfig();\r\n\r\n        let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n        let commonForumListHtml = '';\r\n        for (let {fid, name} of commonForumList) {\r\n            commonForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n        let availableForumListHtml = '';\r\n        for (let {fid, name} of Const.availableForumList) {\r\n            if (commonForumList.find(elem => elem.fid === fid)) continue;\r\n            availableForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n\r\n        let bodyContent = `\r\n<p class=\"font-size-sm text-muted\">\r\n  请将可用版块内的版块按钮拖拽到常用版块内（或相反）\r\n</p>\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend>常用版块</legend>\r\n  <div class=\"edit-forum-list d-flex flex-wrap\" id=\"editCommonForumList\">${commonForumListHtml}</div>\r\n</fieldset>\r\n<fieldset class=\"fieldset mb-3 py-2\">\r\n  <legend>可用版块</legend>\r\n  <div class=\"edit-forum-list d-flex flex-wrap\" id=\"editAvailableForumList\">${availableForumListHtml}</div>\r\n</fieldset>`;\r\n        let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\">保存</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>\r\n<button class=\"btn btn-danger\" name=\"reset\" type=\"button\">重置</button>`;\r\n        let $dialog = Dialog.create(dialogName, '编辑常用版块', bodyContent, footerContent);\r\n\r\n        let $dragulaScriptPath = $('[name=\"dragulaScriptPath\"]');\r\n        let dragulaScriptPath = $dragulaScriptPath.val();\r\n        if (dragulaScriptPath) {\r\n            $.getScript(dragulaScriptPath, () => dragula($dialog.find('.edit-forum-list').get(), {revertOnSpill: true}));\r\n            $dragulaScriptPath.val('');\r\n        }\r\n        else dragula($dialog.find('.edit-forum-list').get(), {revertOnSpill: true});\r\n\r\n        $dialog.submit(function (e) {\r\n            e.preventDefault();\r\n            Config.commonForumList = [];\r\n            $('#editCommonForumList').children('.btn').each(function () {\r\n                let $this = $(this);\r\n                let fid = parseInt($this.data('fid'));\r\n                let name = $this.text().trim();\r\n                if (!fid || !name) return;\r\n                Config.commonForumList.push({fid: fid, name: name});\r\n            });\r\n            writeConfig();\r\n            alert('设置已保存');\r\n            Dialog.close(dialogName);\r\n            location.reload();\r\n        }).find('[name=\"reset\"]').click(function () {\r\n            if (!confirm('是否重置？')) return;\r\n            Config.commonForumList = [];\r\n            writeConfig();\r\n            alert('设置已重置');\r\n            Dialog.close(dialogName);\r\n            location.reload();\r\n        });\r\n\r\n        Dialog.show(dialogName);\r\n    });\r\n};\r\n\r\n/**\r\n * 填充常用版块面板\r\n */\r\nexport const fillCommonForumPanel = function () {\r\n    let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n    let html = '';\r\n    for (let [index, {fid, name}] of commonForumList.entries()) {\r\n        if (index === 0 || index % 3 === 0) html += '<div class=\"row mb-3\">';\r\n        html += `\r\n<div class=\"col-4\">\r\n  <a class=\"btn btn-outline-primary btn-block\" href=\"${Util.makeUrl('thread')}/${fid}\">${name}</a>\r\n</div>`;\r\n        if (index === commonForumList.length - 1 || index % 3 === 2) html += '</div>';\r\n    }\r\n    $('.common-forum-panel').html(html);\r\n};\r\n\r\n/**\r\n * 在操作进行时阻止关闭页面\r\n */\r\nexport const preventCloseWindow = function () {\r\n    window.addEventListener(\"beforeunload\", function (e) {\r\n        if ($('.mask').length > 0) {\r\n            let msg = '正在进行操作中，确定要关闭页面吗？';\r\n            e.returnValue = msg;\r\n            return msg;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 显示通用的导入/导出设置对话框\r\n * @param {string} title 对话框标题\r\n * @param {string} configName 设置名称\r\n * @param {?function} [callback] 回调方法\r\n * @param {?function} [callbackAfterSubmit] 在提交之后的回调方法\r\n */\r\nexport const showCommonImportOrExportConfigDialog = function (title, configName, callback, callbackAfterSubmit) {\r\n    const dialogName = 'pdCommonImOrExConfigDialog';\r\n    if ($('#' + dialogName).length > 0) return;\r\n    readConfig();\r\n    let bodyContent = `\r\n<p class=\"font-size-sm\">\r\n  <b>导入设置：</b>将设置内容粘贴到文本框中并点击保存按钮即可<br>\r\n  <b>导出设置：</b>复制文本框里的内容并粘贴到别处即可\r\n</p>\r\n<div class=\"form-group\">\r\n  <textarea class=\"form-control\" name=\"commonConfig\" rows=\"10\" aria-label=\"设置内容\" style=\"word-break: break-all;\"></textarea>\r\n</div>`;\r\n    let footerContent = `\r\n<button class=\"btn btn-primary\" type=\"submit\">保存</button>\r\n<button class=\"btn btn-secondary\" data-dismiss=\"dialog\" type=\"button\">取消</button>`;\r\n    let $dialog = Dialog.create(dialogName, `导入或导出${title}`, bodyContent, footerContent);\r\n\r\n    $dialog.submit(function (e) {\r\n        e.preventDefault();\r\n        if (!confirm('是否导入文本框中的设置？')) return;\r\n        let options = $.trim($dialog.find('[name=\"commonConfig\"]').val());\r\n        if (!options) return;\r\n        try {\r\n            options = JSON.parse(options);\r\n        }\r\n        catch (ex) {\r\n            alert('设置有错误');\r\n            return;\r\n        }\r\n        if (!options || $.type(options) !== $.type(Config[configName])) {\r\n            alert('设置有错误');\r\n            return;\r\n        }\r\n        Config[configName] = options;\r\n        writeConfig();\r\n        alert('设置已导入');\r\n        Dialog.close(dialogName);\r\n        if (typeof callbackAfterSubmit === 'function') callbackAfterSubmit();\r\n        else location.reload();\r\n    }).find('[name=\"cancel\"]').click(() => Dialog.close(dialogName));\r\n    Dialog.show(dialogName);\r\n    $dialog.find('[name=\"commonConfig\"]').val(JSON.stringify(Config[configName])).select().focus();\r\n    if (typeof callback === 'function') callback($dialog);\r\n};\r\n\r\n/**\r\n * 关注用户\r\n */\r\nexport const followUsers = function () {\r\n    if (!Config.followUserList.length) return;\r\n    if (pageId === 'indexPage' && Config.highlightFollowUserThreadInHPEnabled) {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.followUserList) > -1) {\r\n                $this.addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'threadPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.followUserList) > -1) {\r\n                $this.closest('.thread-list-item').find('.thread-item-footer a:first').addClass('text-danger');\r\n                //if (Config.highlightFollowUserThreadLinkEnabled) $this.addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        $('.read-floor').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('username'), Config.followUserList) > -1) {\r\n                $this.find('.floor-num').addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'gjcPage' || pageId === 'sharePage' || pageId === 'searchPage') {\r\n        $('.thread-list-group').find('a[data-author]').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.followUserList) > -1) {\r\n                $this.addClass('text-danger');\r\n            }\r\n        });\r\n    }\r\n};\r\n\r\n/**\r\n * 屏蔽用户\r\n */\r\nexport const blockUsers = function () {\r\n    if (!Config.blockUserList.length) return;\r\n    let num = 0;\r\n    if (pageId === 'indexPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            let index = Util.inFollowOrBlockUserList($this.data('author'), Config.blockUserList);\r\n            if (index > -1 && Config.blockUserList[index].type <= 1) {\r\n                num++;\r\n                $this.closest('.thread-link-group').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'threadPage') {\r\n        if (Config.blockUserForumType === 1 && !Config.blockUserFidList.includes(pageInfo.fid)) return;\r\n        else if (Config.blockUserForumType === 2 && Config.blockUserFidList.includes(pageInfo.fid)) return;\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            let index = Util.inFollowOrBlockUserList($this.data('author'), Config.blockUserList);\r\n            if (index > -1 && Config.blockUserList[index].type <= 1) {\r\n                num++;\r\n                $this.closest('.thread-list-item').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        if (Config.blockUserForumType === 1 && !Config.blockUserFidList.includes(pageInfo.fid)) return;\r\n        else if (Config.blockUserForumType === 2 && Config.blockUserFidList.includes(pageInfo.fid)) return;\r\n        $('.read-floor').each(function () {\r\n            let $this = $(this);\r\n            let index = Util.inFollowOrBlockUserList($this.data('username'), Config.blockUserList);\r\n            if (index > -1) {\r\n                let floor = parseInt($this.data('floor'));\r\n                if (Config.blockUserList[index].type === 2 && floor === 0) return;\r\n                else if (Config.blockUserList[index].type === 1 && floor > 0) return;\r\n                num++;\r\n                $this.closest('.read-floor').remove();\r\n            }\r\n        });\r\n        $('.read-content').find('.blockquote > p').each(function () {\r\n            let $this = $(this);\r\n            let content = $this.text().trim();\r\n            for (let data of Config.blockUserList) {\r\n                if (data.type === 1) continue;\r\n                try {\r\n                    let regex1 = new RegExp(`^引用(第\\\\d+楼|楼主)${data.name}于`, 'i');\r\n                    let regex2 = new RegExp(`^回\\\\s*\\\\d+楼\\\\(${data.name}\\\\)\\\\s*的帖子`, 'i');\r\n                    if (regex1.test(content) || regex2.test(content)) {\r\n                        $this.html(`<mark class=\"help\" data-toggle=\"tooltip\" title=\"被屏蔽用户：${data.name}\">该用户已被屏蔽</mark>`);\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                }\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'gjcPage' && Config.blockUserAtTipsEnabled) {\r\n        $('.thread-list-group').find('a[data-author]').each(function () {\r\n            let $this = $(this);\r\n            if (Util.inFollowOrBlockUserList($this.data('author'), Config.blockUserList) > -1) {\r\n                num++;\r\n                $this.closest('.thread-list-item').remove();\r\n            }\r\n        });\r\n    }\r\n    if (num > 0) console.log(`【屏蔽用户】共有${num}个主题或回复被屏蔽`);\r\n};\r\n\r\n/**\r\n * 屏蔽主题\r\n */\r\nexport const blockThread = function () {\r\n    if (!Config.blockThreadList.length) return;\r\n\r\n    /**\r\n     * 是否屏蔽主题\r\n     * @param {string} title 主题标题\r\n     * @param {string} userName 用户名\r\n     * @param {number} fid 版块ID\r\n     * @returns {boolean} 是否屏蔽\r\n     */\r\n    const isBlock = function (title, userName, fid = 0) {\r\n        for (let {keyWord, includeUser, excludeUser, includeFid, excludeFid} of Config.blockThreadList) {\r\n            let regex = null;\r\n            if (/^\\/.+\\/[gimuy]*$/.test(keyWord)) {\r\n                try {\r\n                    regex = eval(keyWord);\r\n                }\r\n                catch (ex) {\r\n                    console.log(ex);\r\n                    continue;\r\n                }\r\n            }\r\n            if (userName) {\r\n                if (includeUser) {\r\n                    if (!includeUser.includes(userName)) continue;\r\n                }\r\n                else if (excludeUser) {\r\n                    if (excludeUser.includes(userName)) continue;\r\n                }\r\n            }\r\n            if (fid) {\r\n                if (includeFid) {\r\n                    if (!includeFid.includes(fid)) continue;\r\n                }\r\n                else if (excludeFid) {\r\n                    if (excludeFid.includes(fid)) continue;\r\n                }\r\n            }\r\n            if (regex) {\r\n                if (regex.test(title)) return true;\r\n            }\r\n            else {\r\n                if (title.toLowerCase().includes(keyWord.toLowerCase())) return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n\r\n    let num = 0;\r\n    if (pageId === 'indexPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (isBlock($this.text().trim(), $this.data('author'))) {\r\n                num++;\r\n                $this.closest('.thread-link-group').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'threadPage') {\r\n        $('.thread-link').each(function () {\r\n            let $this = $(this);\r\n            if (isBlock($this.text().trim(), $this.data('author'), pageInfo.fid)) {\r\n                num++;\r\n                $this.closest('.thread-list-item').remove();\r\n            }\r\n        });\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        if (pageInfo.currentPageNum !== 1) return;\r\n        let $topFloor = $('.read-floor[data-floor=\"0\"]');\r\n        if (!$topFloor.length) return;\r\n        if (isBlock($('.thread-title').text().trim(), $topFloor.data('username'), pageInfo.fid)) {\r\n            num++;\r\n            $topFloor.remove();\r\n        }\r\n    }\r\n    if (num > 0) console.log(`【屏蔽主题】共有${num}个主题被屏蔽`);\r\n};\r\n","/* 主题模块 */\r\n'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {write as writeConfig} from './config';\r\nimport * as Msg from './msg';\r\n\r\n/**\r\n * 处理复制楼层跳转链接按钮\r\n */\r\nexport const handleCopyFloorLinkBtn = function () {\r\n    $(document).on('click', '.floor-num', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let link = Util.getHostNameUrl() + $this.attr('href');\r\n        $this.data('copy-text', link);\r\n        if (!Util.copyText($this, $this)) {\r\n            prompt('本楼的跳转链接：', link);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理快速回复按钮\r\n */\r\nexport const handleFastReplyBtn = function () {\r\n    $(document).on('click', '.fast-reply-btn', function (e) {\r\n        e.preventDefault();\r\n        let $article = $(this).closest('article');\r\n        let floor = $article.data('floor');\r\n        let userName = $article.data('username');\r\n        $('#postGjc').val(userName);\r\n        let postContent = $('#postContent').get(0);\r\n        postContent.value = `[quote]回 ${floor}楼(${userName}) 的帖子[/quote]\\n`;\r\n        postContent.selectionStart = postContent.value.length;\r\n        postContent.selectionEnd = postContent.value.length;\r\n        postContent.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理屏蔽回帖按钮\r\n */\r\nexport const handleBlockFloorBtn = function () {\r\n    $(document).on('click', '.block-floor', () => confirm('确认要屏蔽该回帖？本操作不可恢复！（屏蔽后该回帖将对大家不可见）'));\r\n};\r\n\r\n/**\r\n * 处理购买帖子按钮\r\n */\r\nexport const handleBuyThreadBtn = function () {\r\n    $(document).on('click', '.buy-thread-btn', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let pid = $this.data('pid');\r\n        let price = $this.data('price');\r\n        if (price > 5 && !confirm(`此贴售价${price}KFB，是否购买？`)) return;\r\n        let $wait = Msg.wait('正在购买帖子&hellip;');\r\n        $.get(Util.makeUrl('job/buytopic', `tid=${pageInfo.tid}&pid=${pid}&verify=${pageInfo.verify}`),\r\n            function ({msg}) {\r\n                Msg.remove($wait);\r\n                if (msg === '操作完成') {\r\n                    location.reload();\r\n                }\r\n                else if (msg.includes('您已经购买此帖')) {\r\n                    alert('你已经购买过此帖');\r\n                    location.reload();\r\n                }\r\n                else {\r\n                    alert('帖子购买失败');\r\n                }\r\n            });\r\n    });\r\n};\r\n\r\n/**\r\n * 复制购买人名单\r\n */\r\nexport const copyBuyThreadList = function () {\r\n    $(document).on('change', '.buy-thread-list', function () {\r\n        let $this = $(this);\r\n        if ($this.val() !== 'copyList') return;\r\n        let list = $this.find('option').map(function (index) {\r\n            let name = $(this).text();\r\n            if (index === 0 || index === 1 || name === '-'.repeat(11)) return null;\r\n            else return name;\r\n        }).get().join('\\n');\r\n        if (!list) {\r\n            alert('暂时无人购买');\r\n            $this.get(0).selectedIndex = 0;\r\n            return;\r\n        }\r\n        $('#buyThreadListContent').val(list);\r\n        $('#buyThreadListDialog').modal('show');\r\n        $this.get(0).selectedIndex = 0;\r\n    });\r\n\r\n    $('#buyThreadListDialog').on('shown.bs.modal', function () {\r\n        $('#buyThreadListContent').select().focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理楼层内的图片\r\n */\r\nexport const handleFloorImage = function () {\r\n    $(document).on('click', '.img', function () {\r\n        let $this = $(this);\r\n        if ($this.parent().is('a') || this.naturalWidth <= $this.closest('.read-content').width()) return;\r\n        location.href = $this.attr('src');\r\n    });\r\n};\r\n\r\n/**\r\n * 跳转到指定楼层\r\n */\r\nexport const gotoFloor = function () {\r\n    if (pageInfo.floor && pageInfo.floor > 0) {\r\n        let hashName = $(`article[data-floor=\"${pageInfo.floor}\"]`).prev('a').attr('name');\r\n        if (hashName) location.hash = '#' + hashName;\r\n    }\r\n};\r\n\r\n/**\r\n * 处理快速跳转到指定楼层按钮\r\n */\r\nexport const handleFastGotoFloorBtn = function () {\r\n    $('.fast-goto-floor').click(function (e) {\r\n        e.preventDefault();\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let floor = parseInt(prompt('你要跳转到哪一层楼？'));\r\n        if (!floor || floor <= 0) return;\r\n        location.href = Util.makeUrl(action, `page=${Math.floor(floor / Config.perPageFloorNum) + 1}&floor=${floor}`);\r\n    });\r\n};\r\n\r\n/**\r\n * 处理推帖子按钮\r\n */\r\nexport const handleTuiThreadBtn = function () {\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/diy_read_tui.php',\r\n            data: `tid=${pageInfo.tid}&safeid=${pageInfo.safeId}`,\r\n            success: function (msg) {\r\n                let matches = /<span.+?\\+\\d+!<\\/span>\\s*(\\d+)/i.exec(msg);\r\n                if (matches) {\r\n                    let $num = $this.find('span:first');\r\n                    $num.text('+1');\r\n                    setTimeout(() => {\r\n                        $num.text(matches[1]);\r\n                    }, 1000);\r\n                }\r\n                else if (/已推过/.test(msg)) {\r\n                    alert('已推过');\r\n                }\r\n                else {\r\n                    alert('操作失败');\r\n                }\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 处理复制代码按钮\r\n */\r\nexport const handleCopyCodeBtn = function () {\r\n    $(document).on('click', '.copy-code', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if (Util.copyText($this.next('pre'), $this)) return;\r\n\r\n        let code = $this.data('code');\r\n        if (code) {\r\n            $this.text('复制代码').removeData('code');\r\n            $this.next('textarea').remove();\r\n            $this.after(`<pre class=\"pre-scrollable\">${code}</pre>`);\r\n        }\r\n        else {\r\n            let $pre = $this.next('pre');\r\n            let html = $pre.html();\r\n            $this.text('还原代码').data('code', html);\r\n            html = Util.decodeHtmlSpecialChar(html);\r\n            let height = $pre.height();\r\n            if (height < 50) height = 50;\r\n            if (height > 340) height = 340;\r\n            $pre.remove();\r\n            $(`<textarea class=\"form-control code-textarea\" style=\"height: ${height}px\" wrap=\"off\">${html}</textarea>`)\r\n                .insertAfter($this).select().focus();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 获取当前页面选中的多重引用数据\r\n * @returns {{}[]} 多重引用数据列表\r\n */\r\nconst getCheckedMultiQuoteData = function () {\r\n    let quoteList = [];\r\n    $('.multi-quote-check:checked').each(function () {\r\n        let $article = $(this).closest('article');\r\n        quoteList.push({floor: $article.data('floor'), pid: $article.data('pid'), userName: $article.data('username')});\r\n    });\r\n    return quoteList;\r\n};\r\n\r\n/**\r\n * 绑定多重引用复选框点击事件\r\n */\r\nexport const bindMultiQuoteCheckClick = function () {\r\n    $(document).on('click', '.multi-quote-check', function () {\r\n        let data = localStorage[Const.multiQuoteStorageName];\r\n        if (data) {\r\n            try {\r\n                data = JSON.parse(data);\r\n                if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) data = null;\r\n                else if (!('tid' in data) || data.tid !== pageInfo.tid || $.type(data.quoteList) !== 'object') data = null;\r\n            }\r\n            catch (ex) {\r\n                data = null;\r\n            }\r\n        }\r\n        else {\r\n            data = null;\r\n        }\r\n        let quoteList = getCheckedMultiQuoteData();\r\n        if (!data) {\r\n            localStorage.removeItem(Const.multiQuoteStorageName);\r\n            data = {tid: pageInfo.tid, quoteList: {}};\r\n        }\r\n        if (quoteList.length > 0) data.quoteList[pageInfo.currentPageNum] = quoteList;\r\n        else delete data.quoteList[pageInfo.currentPageNum];\r\n        localStorage[Const.multiQuoteStorageName] = JSON.stringify(data);\r\n    });\r\n};\r\n","/* 其它模块 */\r\n'use strict';\r\n\r\n/**\r\n * 设置Cookie\r\n * @param {string} name Cookie名称\r\n * @param {*} value Cookie值\r\n * @param {?Date} date Cookie有效期，留空则表示有效期为浏览器进程\r\n * @param {string} prefix Cookie名称前缀\r\n */\r\nexport const setCookie = function (name, value, date = null, prefix = pageInfo.cookiePrefix) {\r\n    document.cookie = `${prefix}${name}=${encodeURI(value)}${!date ? '' : ';expires=' + date.toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * 获取Cookie\r\n * @param {string} name Cookie名称\r\n * @param {string} prefix Cookie名称前缀\r\n * @returns {?string} Cookie值\r\n */\r\nexport const getCookie = function (name, prefix = pageInfo.cookiePrefix) {\r\n    let regex = new RegExp(`(^| )${prefix}${name}=([^;]*)(;|$)`);\r\n    let matches = document.cookie.match(regex);\r\n    if (!matches) return null;\r\n    else return decodeURI(matches[2]);\r\n};\r\n\r\n/**\r\n * 删除Cookie\r\n * @param {string} name Cookie名称\r\n * @param {string} prefix Cookie名称前缀\r\n */\r\nexport const deleteCookie = function (name, prefix = pageInfo.cookiePrefix) {\r\n    document.cookie = `${prefix}${name}=;expires=${getDate('-1d').toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * 获取在当前时间的基础上的指定（相对）时间量的Date对象\r\n * @param {string} value 指定（相对）时间量，+或-：之后或之前（相对于当前时间）；无符号：绝对值；Y：完整年份；y：年；M：月；d：天；h：小时；m：分；s：秒；ms：毫秒\r\n * @returns {?Date} 指定（相对）时间量的Date对象\r\n * @example\r\n * Tools.getDate('+2y') 获取2年后的Date对象\r\n * Tools.getDate('+3M') 获取3个月后的Date对象\r\n * Tools.getDate('-4d') 获取4天前的Date对象\r\n * Tools.getDate('5h') 获取今天5点的Date对象（其它时间量与当前时间一致）\r\n * Tools.getDate('2015Y') 获取年份为2015年的Date对象\r\n */\r\nexport const getDate = function (value) {\r\n    let date = new Date();\r\n    let matches = /^(-|\\+)?(\\d+)([a-zA-Z]{1,2})$/.exec(value);\r\n    if (!matches) return null;\r\n    let flag = typeof matches[1] === 'undefined' ? 0 : (matches[1] === '+' ? 1 : -1);\r\n    let increment = flag === -1 ? -parseInt(matches[2]) : parseInt(matches[2]);\r\n    let unit = matches[3];\r\n    switch (unit) {\r\n        case 'Y':\r\n            date.setFullYear(increment);\r\n            break;\r\n        case 'y':\r\n            date.setFullYear(flag === 0 ? increment : date.getFullYear() + increment);\r\n            break;\r\n        case 'M':\r\n            date.setMonth(flag === 0 ? increment : date.getMonth() + increment);\r\n            break;\r\n        case 'd':\r\n            date.setDate(flag === 0 ? increment : date.getDate() + increment);\r\n            break;\r\n        case 'h':\r\n            date.setHours(flag === 0 ? increment : date.getHours() + increment);\r\n            break;\r\n        case 'm':\r\n            date.setMinutes(flag === 0 ? increment : date.getMinutes() + increment);\r\n            break;\r\n        case 's':\r\n            date.setSeconds(flag === 0 ? increment : date.getSeconds() + increment);\r\n            break;\r\n        case 'ms':\r\n            date.setMilliseconds(flag === 0 ? increment : date.getMilliseconds() + increment);\r\n            break;\r\n        default:\r\n            return null;\r\n    }\r\n    return date;\r\n};\r\n\r\n/**\r\n * 获取指定字符串的字节长度（1个GBK字符按2个字节来算）\r\n * @param {string} str 指定字符串\r\n * @returns {number} 字符串的长度\r\n */\r\nexport const getStrByteLen = function (str) {\r\n    let len = 0;\r\n    let cLen = 2;\r\n    for (let i = 0; i < str.length; i++) {\r\n        len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? cLen : 1;\r\n    }\r\n    return len;\r\n};\r\n\r\n/**\r\n * 获取当前域名的URL\r\n * @returns {string} 当前域名的URL\r\n */\r\nexport const getHostNameUrl = function () {\r\n    return location.protocol + '//' + location.host;\r\n};\r\n\r\n/**\r\n * 添加BBCode\r\n * @param textArea 文本框\r\n * @param {string} code BBCode\r\n * @param {string} selText 选择文本\r\n */\r\nexport const addCode = function (textArea, code, selText = '') {\r\n    let startPos = selText === '' ? code.indexOf(']') + 1 : code.indexOf(selText);\r\n    if (typeof textArea.selectionStart !== 'undefined') {\r\n        let prePos = textArea.selectionStart;\r\n        textArea.value = textArea.value.substring(0, prePos) + code + textArea.value.substring(textArea.selectionEnd);\r\n        textArea.selectionStart = prePos + startPos;\r\n        textArea.selectionEnd = prePos + startPos + selText.length;\r\n    }\r\n    else {\r\n        textArea.value += code;\r\n    }\r\n};\r\n\r\n/**\r\n * 获取选择文本\r\n * @param textArea 文本框\r\n * @returns {string} 选择文本\r\n */\r\nexport const getSelText = function (textArea) {\r\n    return textArea.value.substring(textArea.selectionStart, textArea.selectionEnd);\r\n};\r\n\r\n/**\r\n * 从URL查询字符串提取参数对象\r\n * @param {string} str URL查询字符串\r\n * @returns {Map} 参数集合\r\n */\r\nexport const extractQueryStr = function (str) {\r\n    let params = new Map();\r\n    for (let param of str.split('&')) {\r\n        if (!param) continue;\r\n        let [key, value] = param.split('=');\r\n        params.set(key, typeof value !== 'undefined' ? value : '');\r\n    }\r\n    return params;\r\n};\r\n\r\n/**\r\n * 从参数对象中创建URL查询字符串\r\n * @param {Map} map 参数集合\r\n * @returns {string} URL查询字符串\r\n */\r\nexport const buildQueryStr = function (map) {\r\n    let queryStr = '';\r\n    for (let [key, value] of map) {\r\n        if (pageInfo.urlType === 2) {\r\n            queryStr += (queryStr ? '&' : '') + key + '=' + value;\r\n        }\r\n        else {\r\n            queryStr += (queryStr ? '/' : '') + key + '/' + value;\r\n        }\r\n    }\r\n    return queryStr;\r\n};\r\n\r\n/**\r\n * 生成指定的URL\r\n * @param {string} action 控制器（小写）\r\n * @param {string} param 查询参数\r\n * @param {boolean} includeOtherParam 是否包括当前页面的其它查询参数\r\n * @param {[]} excludeParams 要排除当前页面的查询参数列表\r\n * @returns {string} URL 最终的URL\r\n */\r\nexport const makeUrl = function (action, param = '', includeOtherParam = false, excludeParams = []) {\r\n    let url = '';\r\n    let paramList = extractQueryStr(param);\r\n    if (includeOtherParam) {\r\n        paramList = new Map([...extractQueryStr(pageInfo.urlParam).entries(), ...paramList.entries()]);\r\n        for (let i in excludeParams) {\r\n            paramList.delete(excludeParams[i]);\r\n        }\r\n    }\r\n    if (!action.startsWith('/')) {\r\n        if (location.pathname.startsWith(pageInfo.baseFile)) url = pageInfo.baseFile + '/';\r\n        else url = pageInfo.rootPath;\r\n    }\r\n    url += action;\r\n    if (paramList.size > 0) {\r\n        let queryStr = buildQueryStr(paramList);\r\n        if (queryStr) {\r\n            url += (pageInfo.urlType === 2 ? '?' : '/') + queryStr;\r\n        }\r\n    }\r\n    return url;\r\n};\r\n\r\n/**\r\n * 获取URL查询字符串中的指定参数\r\n * @param {string} name 参数名称\r\n * @returns {?string} 参数值\r\n */\r\nexport const getQueryParam = function (name) {\r\n    return extractQueryStr(pageInfo.urlParam).get(name);\r\n};\r\n\r\n/**\r\n * 解码HTML特殊字符\r\n * @param {string} str 待解码的字符串\r\n * @returns {string} 解码后的字符串\r\n */\r\nexport const decodeHtmlSpecialChar = function (str) {\r\n    if (!str.length) return '';\r\n    return str.replace(/<br\\s*\\/?>/gi, '\\n')\r\n        .replace(/&quot;/gi, '\\\"')\r\n        .replace(/&#39;/gi, '\\'')\r\n        .replace(/&nbsp;/gi, ' ')\r\n        .replace(/&gt;/gi, '>')\r\n        .replace(/&lt;/gi, '<')\r\n        .replace(/&amp;/gi, '&');\r\n};\r\n\r\n/**\r\n * 全选\r\n * @param {jQuery} $nodes 想要全选的节点的jQuery对象\r\n */\r\nexport const selectAll = function ($nodes) {\r\n    $nodes.prop('checked', true);\r\n};\r\n\r\n/**\r\n * 反选\r\n * @param {jQuery} $nodes 想要反选的节点的jQuery对象\r\n */\r\nexport const selectInverse = function ($nodes) {\r\n    $nodes.each(function () {\r\n        let $this = $(this);\r\n        $this.prop('checked', !$this.prop('checked'));\r\n    });\r\n};\r\n\r\n/**\r\n * 显示字段验证消息\r\n * @param {jQuery} $node 验证字段的jQuery对象\r\n * @param {string} type 验证类型\r\n * @param {string} msg 验证消息\r\n */\r\nexport const showValidationMsg = function ($node, type, msg = '') {\r\n    if (type === 'error') type = 'danger';\r\n    $node.removeClass('form-control-success form-control-warning form-control-danger');\r\n    let $parent = $node.parent();\r\n    $parent.removeClass('has-success has-warning has-danger');\r\n    if ($.inArray(type, ['success', 'warning', 'danger'] > -1)) {\r\n        $node.addClass('form-control-' + type).parent().addClass('has-' + type);\r\n    }\r\n    let $feedback = $parent.find('.form-control-feedback');\r\n    if (type === 'wait') {\r\n        $feedback.html(`<span class=\"text-muted\"><i class=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i> ${msg}</span>`);\r\n    }\r\n    else {\r\n        $feedback.text(msg);\r\n    }\r\n};\r\n\r\n/**\r\n * 获取对象A在对象B中的相对补集\r\n * @param {Object} a 对象A\r\n * @param {Object} b 对象B\r\n * @returns {Object} 相对补集\r\n */\r\nexport const getDifferenceSetOfObject = function (a, b) {\r\n    let c = {};\r\n    if ($.type(a) !== 'object' || $.type(b) !== 'object') return c;\r\n    $.each(b, (key, data) => {\r\n        if (key in a) {\r\n            if (!deepEqual(a[key], data)) c[key] = data;\r\n        }\r\n    });\r\n    return c;\r\n};\r\n\r\n/**\r\n * 深度比较两个对象是否相等\r\n * @param {*} a\r\n * @param {*} b\r\n * @returns {boolean} 是否相等\r\n */\r\nexport const deepEqual = function (a, b) {\r\n    if (a === b) return true;\r\n    if ($.type(a) !== $.type(b)) return false;\r\n    if (typeof a === 'number' && typeof b === 'number' && isNaN(a) && isNaN(b)) return true;\r\n    if ($.isArray(a) && $.isArray(b) || $.type(a) === 'object' && $.type(b) === 'object') {\r\n        if (a.length !== b.length) return false;\r\n        for (var i in $.extend($.isArray(a) ? [] : {}, a, b)) {\r\n            if (typeof a[i] === 'undefined' || typeof b[i] === 'undefined') return false;\r\n            if (!deepEqual(a[i], b[i])) return false;\r\n        }\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n\r\n/**\r\n * 复制文本\r\n * @param {jQuery} $target 要复制文本的目标元素\r\n * @param {?jQuery} $source 触发事件的源元素\r\n * @returns {boolean} 是否复制成功\r\n */\r\nexport const copyText = function ($target, $source = null) {\r\n    if (!('execCommand' in document) || !$target.length) return false;\r\n    let copyText = $target.data('copy-text');\r\n    if (copyText) {\r\n        $target = $(`<span class=\"text-hide\">${copyText}</span>`).insertAfter($target);\r\n    }\r\n    let s = window.getSelection();\r\n    s.selectAllChildren($target.get(0));\r\n    let result = document.execCommand('copy');\r\n    s.removeAllRanges();\r\n    if (copyText) $target.remove();\r\n    if (result && $source) {\r\n        let msg = $source.data('copy-msg');\r\n        $source.attr('title', msg ? msg : '已复制').on('hidden.bs.tooltip', function () {\r\n            $(this).tooltip('dispose');\r\n        }).tooltip('show');\r\n    }\r\n    return result;\r\n};\r\n\r\n/**\r\n * 获取指定用户名在关注或屏蔽列表中的索引号\r\n * @param {string} name 指定用户名\r\n * @param {Array} list 指定列表\r\n * @returns {number} 指定用户在列表中的索引号，-1表示不在该列表中\r\n */\r\nexport const inFollowOrBlockUserList = (name, list) => list.findIndex(data => data.name && data.name === name);\r\n"]}
{"version":3,"sources":["node_modules/.6.0.1@browser-pack/_prelude.js","public/static/src/js/app.js","public/static/src/js/module/config.js","public/static/src/js/module/const.js","public/static/src/js/module/index.js","public/static/src/js/module/other.js","public/static/src/js/module/post.js","public/static/src/js/module/public.js","public/static/src/js/module/read.js","public/static/src/js/module/util.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_config","_public","_index","_read","_post","_other","window","pageId","$","attr","validateRegisterField","init","handleRollToTopOrBottomBtn","handleSearchDialog","fillCommonForumPanel","showEditCommonForumDialog","handlePageInput","handleAtTipsBtn","handleIndexThreadPanel","handleSelectBgImage","handleSelectBgColor","handleCustomBgStyle","fastGotoFloor","tuiThread","showFloorLink","handleFastReplyBtn","handleBlockFloorBtn","handleBuyThreadBtn","copyBuyThreadList","handleFloorImage","checkPostForm","bindFastSubmitShortcutKey","copyCode","bindMultiQuoteCheckClick","handleClearMultiQuoteDataBtn","addSmileCode","highlightUnReadAtTipsMsg","handleGameIntroSearchArea","tuiGameIntro","randomSelectSmBox","bindFavorPageBtnsClick","bindFriendPageBtnsClick","syncPerPageFloorNum","assignBirthdayField","handleUploadAvatarFileBtn","transferKfbAlert","bindMessageActionBtnsClick","handleEditorBtns","handleAttachBtns","tooltip","container","_util","Util","name","Config","perPageFloorNum","activeNewReplyPanel","activeTopRecommendPanel","activeForumPanel1","activeForumPanel2","commonForumList","read","extend","options","localStorage","JSON","parse","ex","type","isEmptyObject","normalize","write","getDifferenceSetOfObject","stringify","clear","removeItem","settings","each","key","value","Const","multiQuoteStorageName","atTipsTimeCookieName","prevAtTipsTimeCookieName","bgStyleCookieName","fid","availableForumList","_const","click","$this","this","time","data","cookieValue","getCookie","_const2","default","setCookie","currentDate","Date","getDate","removeClass","addClass","tab","document","on","$target","target","targetPanel","typeName","includes","id","fileName","path","parent","confirm","css","alert","color","parseInt","prompt","trim","location","reload","test","toLowerCase","replace","pageInfo","gjc","userName","timeString","prevString","index","curString","text","deleteCookie","val","keyword","searchType","cookieName","url","makeUrl","preventDefault","ajax","success","$num","find","num","setTimeout","error","complete","removeData","dataType","$boxes","number","Math","floor","random","html","off","href","eq","$form","submit","action","selectAll","selectReverse","$checked","change","matches","exec","year","month","day","syncConfig","isNaN","transferKfb","fixedDeposit","currentDeposit","_ret","title","prop","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","split","Symbol","iterator","next","done","err","return","v","_typeof","_$checked","showValidationMsg","post","_ref","msg","username","fail","trigger","textArea","get","selText","getSelText","addCode","focus","size","codeType","is","$postType","$postTitle","getStrByteLen","$voteItemContent","$postContent","_length","$postGjc","$area","closest","after","blur","remove","$newAttachArea","totalNum","$lastAttachArea","insertAfter","$node","$relatedTarget","relatedTarget","scroll","$btn","scrollTop","height","animate","$searchDialog","select","$searchKeyword","$method","getTime","$current","maxPageNum","excludeParams","currentPageNum","keydown","keyCode","ctrlKey","commonForumListHtml","_step$value","availableForumListHtml","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_loop","_step2$value","elem","_iterator2","$dialog","appendTo","modal","dragula","revertOnSpill","children","push","end","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","entries","_step3$value","_slicedToArray","_step3$value$","_fid","getCheckedMultiQuoteData","getHostNameUrl","$article","postContent","selectionStart","selectionEnd","pid","price","tid","verify","list","map","repeat","join","selectedIndex","naturalWidth","width","floorNum","hashName","prev","hash","safeId","$pre","decodeHtmlSpecialChar","quoteList","handleMultiQuote","arguments","_data","Object","values","_data2","quote","keywords","Set","content","_quote","add","concat","_toConsumableArray","date","prefix","cookiePrefix","cookie","encodeURI","toUTCString","regex","RegExp","match","decodeURI","flag","increment","unit","setFullYear","getFullYear","setMonth","getMonth","setDate","setHours","getHours","setMinutes","getMinutes","setSeconds","getSeconds","setMilliseconds","getMilliseconds","extractQueryStr","str","len","cLen","charCodeAt","protocol","host","startPos","indexOf","prePos","substring","params","Map","param","_param$split","_param$split2","set","buildQueryStr","queryStr","urlType","deepEqual","includeOtherParam","paramList","urlParam","delete","startsWith","pathname","baseFile","rootPath","$nodes","$parent","inArray","$feedback","b","c","isArray"],"mappings":"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","file":"app.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\r\nimport {init as initConfig} from './module/config';\r\n\r\nimport {\r\n    handleRollToTopOrBottomBtn,\r\n    handleSearchDialog,\r\n    handlePageInput,\r\n    bindFastSubmitShortcutKey,\r\n    showEditCommonForumDialog,\r\n    fillCommonForumPanel\r\n} from './module/public';\r\n\r\nimport {\r\n    handleAtTipsBtn,\r\n    handleIndexThreadPanel,\r\n    handleSelectBgImage,\r\n    handleSelectBgColor,\r\n    handleCustomBgStyle\r\n} from './module/index';\r\n\r\nimport {\r\n    fastGotoFloor,\r\n    tuiThread,\r\n    showFloorLink,\r\n    handleFastReplyBtn,\r\n    handleBlockFloorBtn,\r\n    handleBuyThreadBtn,\r\n    copyBuyThreadList,\r\n    handleFloorImage,\r\n    copyCode,\r\n    bindMultiQuoteCheckClick,\r\n    handleClearMultiQuoteDataBtn,\r\n} from './module/read';\r\n\r\nimport {\r\n    checkPostForm,\r\n    addSmileCode,\r\n    handleEditorBtns,\r\n    handleAttachBtns,\r\n} from './module/post';\r\n\r\nimport {\r\n    highlightUnReadAtTipsMsg,\r\n    validateRegisterField,\r\n    handleGameIntroSearchArea,\r\n    tuiGameIntro,\r\n    randomSelectSmBox,\r\n    bindFavorPageBtnsClick,\r\n    bindFriendPageBtnsClick,\r\n    syncPerPageFloorNum,\r\n    assignBirthdayField,\r\n    handleUploadAvatarFileBtn,\r\n    transferKfbAlert,\r\n    bindMessageActionBtnsClick,\r\n} from './module/other';\r\n\r\n// 页面ID\r\nwindow.pageId = $('body').attr('id');\r\n\r\n/**\r\n * 初始化\r\n */\r\n$(function () {\r\n    if (pageId === 'loginPage') return;\r\n    else if (pageId === 'registerPage') {\r\n        validateRegisterField();\r\n        return;\r\n    }\r\n    initConfig();\r\n\r\n    handleRollToTopOrBottomBtn();\r\n    handleSearchDialog();\r\n    fillCommonForumPanel();\r\n    showEditCommonForumDialog();\r\n    if ($('.page-input').length > 0) {\r\n        handlePageInput();\r\n    }\r\n    if (pageId === 'indexPage') {\r\n        handleAtTipsBtn();\r\n        handleIndexThreadPanel();\r\n        handleSelectBgImage();\r\n        handleSelectBgColor();\r\n        handleCustomBgStyle();\r\n    }\r\n    else if (pageId === 'readPage') {\r\n        fastGotoFloor();\r\n        tuiThread();\r\n        showFloorLink();\r\n        handleFastReplyBtn();\r\n        handleBlockFloorBtn();\r\n        handleBuyThreadBtn();\r\n        copyBuyThreadList();\r\n        handleFloorImage();\r\n        checkPostForm();\r\n        bindFastSubmitShortcutKey($('#postContent'));\r\n        copyCode();\r\n        bindMultiQuoteCheckClick();\r\n        handleClearMultiQuoteDataBtn(1);\r\n        addSmileCode($('#postContent'));\r\n    }\r\n    else if (pageId === 'gjcPage') {\r\n        highlightUnReadAtTipsMsg();\r\n    }\r\n    else if (pageId === 'gameIntroSearchPage') {\r\n        handleGameIntroSearchArea();\r\n    }\r\n    else if (pageId === 'gameIntroPage') {\r\n        tuiGameIntro('game');\r\n    }\r\n    else if (pageId === 'gameIntroCompanyPage') {\r\n        tuiGameIntro('company');\r\n    }\r\n    else if (pageId === 'gameIntroTypePage') {\r\n        tuiGameIntro('type');\r\n    }\r\n    else if (pageId === 'gameIntroPropertyPage') {\r\n        tuiGameIntro('property');\r\n    }\r\n    else if (pageId === 'smBoxPage') {\r\n        randomSelectSmBox();\r\n    }\r\n    else if (pageId === 'favorPage') {\r\n        bindFavorPageBtnsClick();\r\n    }\r\n    else if (pageId === 'friendPage') {\r\n        bindFriendPageBtnsClick();\r\n    }\r\n    else if (pageId === 'modifyPage') {\r\n        syncPerPageFloorNum();\r\n        assignBirthdayField();\r\n        handleUploadAvatarFileBtn();\r\n    }\r\n    else if (pageId === 'bankPage') {\r\n        transferKfbAlert();\r\n    }\r\n    else if (pageId === 'messagePage') {\r\n        bindMessageActionBtnsClick();\r\n    }\r\n    else if (pageId === 'readMessagePage') {\r\n        handleFloorImage();\r\n        copyCode();\r\n    }\r\n    else if (pageId === 'writeMessagePage') {\r\n        bindFastSubmitShortcutKey($('#msgContent'));\r\n        addSmileCode($('#msgContent'));\r\n    }\r\n    else if (pageId === 'messageBannedPage') {\r\n        bindFastSubmitShortcutKey($('[name=\"banidinfo\"]'));\r\n    }\r\n    else if (pageId === 'postPage') {\r\n        checkPostForm();\r\n        bindFastSubmitShortcutKey($('#postContent'));\r\n        handleEditorBtns();\r\n        addSmileCode($('#postContent'));\r\n        handleAttachBtns();\r\n    }\r\n\r\n    //let tooltipStartTime = new Date();\r\n    $('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    //console.log(`tooltip初始化耗时：${new Date() - tooltipStartTime}ms`);\r\n});\r\n","'use strict';\r\nimport * as Util from './util';\r\n\r\n// 配置名称\r\nconst name = 'kf_config';\r\n\r\n/**\r\n * 配置类\r\n */\r\nexport const Config = {\r\n    // 主题每页楼层数量\r\n    perPageFloorNum: 0,\r\n    // 当前激活的最新回复面板\r\n    activeNewReplyPanel: '#galgameNewReplyPanel',\r\n    // 当前激活的当前推荐面板\r\n    activeTopRecommendPanel: '#galgameTopRecommendPanel',\r\n    // 当前激活的版块列表面板1\r\n    activeForumPanel1: '',\r\n    // 当前激活的版块列表面板2\r\n    activeForumPanel2: '',\r\n    // 常用版块列表\r\n    commonForumList: [],\r\n};\r\n\r\n/**\r\n * 初始化\r\n */\r\nexport const init = function () {\r\n    window.Config = $.extend(true, {}, Config);\r\n    read();\r\n};\r\n\r\n/**\r\n * 读取设置\r\n */\r\nexport const read = function () {\r\n    let options = localStorage[name];\r\n    if (!options) return;\r\n    try {\r\n        options = JSON.parse(options);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!options || $.type(options) !== 'object' || $.isEmptyObject(options)) return;\r\n    options = normalize(options);\r\n    window.Config = $.extend(true, {}, Config, options);\r\n};\r\n\r\n/**\r\n * 写入设置\r\n */\r\nexport const write = function () {\r\n    let options = Util.getDifferenceSetOfObject(Config, window.Config);\r\n    localStorage[name] = JSON.stringify(options);\r\n};\r\n\r\n/**\r\n * 清空设置\r\n */\r\nexport const clear = function () {\r\n    localStorage.removeItem(name);\r\n};\r\n\r\n/**\r\n * 获取经过规范化的Config对象\r\n * @param {{}} options 待处理的Config对象\r\n * @returns {{}} 经过规范化的Config对象\r\n */\r\nconst normalize = function (options) {\r\n    var settings = {};\r\n    if ($.type(options) !== 'object') return settings;\r\n    $.each(options, (key, value) => {\r\n        if (key in Config && $.type(value) === $.type(Config[key])) {\r\n            settings[key] = value;\r\n        }\r\n    });\r\n    return settings;\r\n};\r\n","'use strict';\r\n\r\n/**\r\n * 配置常量类\r\n */\r\nconst Const = {\r\n    // 存储多重引用数据的LocalStorage名称\r\n    multiQuoteStorageName: 'kf_multi_quote',\r\n    // at提醒时间的Cookie名称\r\n    atTipsTimeCookieName: 'at_tips_time',\r\n    // 上一次at提醒时间的Cookie名称\r\n    prevAtTipsTimeCookieName: 'prev_at_tips_time',\r\n    // 背景样式的Cookie名称\r\n    bgStyleCookieName: 'bg_style',\r\n    // 常用版块列表\r\n    commonForumList: [\r\n        {fid: 106, name: '新作动态'},\r\n        {fid: 41, name: '网盘下载'},\r\n        {fid: 16, name: '种子下载'},\r\n        {fid: 52, name: '游戏讨论'},\r\n        {fid: 84, name: '动漫讨论'},\r\n        {fid: 67, name: 'CG下载'},\r\n        {fid: 5, name: '自由讨论'},\r\n        {fid: 56, name: '个人日记'},\r\n        {fid: 57, name: '同人漫本'},\r\n    ],\r\n    // 可用版块列表\r\n    availableForumList: [\r\n        {fid: 106, name: '新作动态'},\r\n        {fid: 52, name: '游戏讨论'},\r\n        {fid: 16, name: '种子下载'},\r\n        {fid: 41, name: '网盘下载'},\r\n        {fid: 67, name: 'CG下载'},\r\n        {fid: 102, name: '游戏推荐'},\r\n        {fid: 24, name: '疑难互助'},\r\n        {fid: 57, name: '同人漫本'},\r\n        {fid: 84, name: '动漫讨论'},\r\n        {fid: 92, name: '动画共享'},\r\n        {fid: 127, name: '漫画小说'},\r\n        {fid: 68, name: '音乐共享'},\r\n        {fid: 163, name: 'LIVE共享'},\r\n        {fid: 182, name: '转载资源'},\r\n        {fid: 94, name: '原创绘画'},\r\n        {fid: 87, name: '宅物交流'},\r\n        {fid: 86, name: '电子产品'},\r\n        {fid: 115, name: '文字作品'},\r\n        {fid: 96, name: '图片来源'},\r\n        {fid: 36, name: '寻求资源'},\r\n        {fid: 5, name: '自由讨论'},\r\n        {fid: 56, name: '个人日记'},\r\n        {fid: 9, name: '我的关注'},\r\n        {fid: 4, name: '意见投诉'},\r\n        {fid: 93, name: '管理组区'},\r\n        {fid: 59, name: '原创组区'},\r\n        {fid: 125, name: '水楼林立'},\r\n        {fid: 181, name: '私人日记'},\r\n        {fid: 42, name: '旧期资料'},\r\n        {fid: 128, name: '作品判定'},\r\n        {fid: 98, name: '日本语版'},\r\n        {fid: 99, name: '意見箱'},\r\n        {fid: 112, name: '掲示板'},\r\n        {fid: 100, name: '創作感想'},\r\n    ],\r\n};\r\n\r\nexport default Const;\r\n","'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 处理首页的@提醒按钮\r\n */\r\nexport const handleAtTipsBtn = function () {\r\n    $('#atTips').click(function () {\r\n        let $this = $(this);\r\n        let time = $this.data('time');\r\n        let cookieValue = Util.getCookie(Const.atTipsTimeCookieName);\r\n        if (!time || time === cookieValue) return;\r\n        if (!cookieValue) {\r\n            let currentDate = (new Date()).getDate();\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, (currentDate < 10 ? '0' + currentDate : currentDate) + '日00时00分');\r\n        }\r\n        else if (cookieValue !== time) {\r\n            Util.setCookie(Const.prevAtTipsTimeCookieName, cookieValue);\r\n        }\r\n        Util.setCookie(Const.atTipsTimeCookieName, time, Util.getDate('+3d'));\r\n        $this.removeClass('btn-outline-danger').addClass('btn-outline-primary');\r\n    });\r\n};\r\n\r\n/**\r\n * 处理首页主题链接面板\r\n */\r\nexport const handleIndexThreadPanel = function () {\r\n    if (Config.activeNewReplyPanel) {\r\n        $(`a[data-toggle=\"tab\"][href=\"${Config.activeNewReplyPanel}\"]`).tab('show');\r\n    }\r\n    if (Config.activeTopRecommendPanel) {\r\n        $(`a[data-toggle=\"tab\"][href=\"${Config.activeTopRecommendPanel}\"]`).tab('show');\r\n    }\r\n\r\n    $(document).on('shown.bs.tab', 'a[data-toggle=\"tab\"]', function (e) {\r\n        let $target = $(e.target);\r\n        let targetPanel = $target.attr('href');\r\n        let typeName = '';\r\n        if (targetPanel.includes('NewReplyPanel')) typeName = 'activeNewReplyPanel';\r\n        else if (targetPanel.includes('TopRecommendPanel')) typeName = 'activeTopRecommendPanel';\r\n        if (typeName && Config[typeName] !== targetPanel) {\r\n            readConfig();\r\n            Config[typeName] = targetPanel;\r\n            writeConfig();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理选择页面背景图片\r\n */\r\nexport const handleSelectBgImage = function () {\r\n    $('#selectBgImage').on('click', '[data-id]', function () {\r\n        let $this = $(this);\r\n        let id = $this.data('id');\r\n        let fileName = $this.data('filename');\r\n        let path = $this.parent().data('path');\r\n        if (!id || !fileName || !path) return;\r\n        if (confirm('是否选择此背景图片？')) {\r\n            Util.setCookie(Const.bgStyleCookieName, id, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background-image', 'url(\"' + path + fileName + '\")');\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理选择页面背景颜色\r\n */\r\nexport const handleSelectBgColor = function () {\r\n    $('#selectBgImage').on('click', '[data-color]', function () {\r\n        let $this = $(this);\r\n        let color = $this.data('color');\r\n        if (!color) return;\r\n        if (confirm('是否选择此背景颜色？')) {\r\n            Util.setCookie(Const.bgStyleCookieName, color, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background', color);\r\n            alert('背景已更换');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理自定义背景样式\r\n */\r\nexport const handleCustomBgStyle = function () {\r\n    $('#customBgStyle').click(function () {\r\n        let value = Util.getCookie(Const.bgStyleCookieName);\r\n        if (!value || parseInt(value)) value = '';\r\n        value = prompt(\r\n            '请输入背景图片URL、颜色代码或CSS样式：\\n（例：http://xxx.com/abc.jpg 或 #fcfcfc，留空表示恢复默认背景）\\n' +\r\n            '（注：建议选择简洁、不花哨、偏浅色系的背景图片或颜色）',\r\n            value\r\n        );\r\n        if (value === null) return;\r\n        if ($.trim(value) === '') {\r\n            Util.setCookie(Const.bgStyleCookieName, '', Util.getDate('-1d'));\r\n            alert('背景已恢复默认');\r\n            location.reload();\r\n        }\r\n        else if (/^https?:\\/\\/[^\"']+/.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background-image', 'url(\"' + value + '\")');\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n        else if (/^#[0-9a-f]{6}$/i.test(value)) {\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background', value.toLowerCase());\r\n            alert('背景已更换');\r\n        }\r\n        else if (!/[<>{}]/.test(value)) {\r\n            value = value.replace(';', '');\r\n            Util.setCookie(Const.bgStyleCookieName, value, Util.getDate('+1y'));\r\n            $('body, .modal-content').css('background', value);\r\n            alert('背景已更换（图片可能需要一定时间加载）');\r\n        }\r\n        else {\r\n            alert('格式不正确');\r\n        }\r\n    });\r\n};\r\n","'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 高亮关键词页面中未读的消息\r\n */\r\nexport const highlightUnReadAtTipsMsg = function () {\r\n    if (pageInfo.gjc !== pageInfo.userName) return;\r\n    let timeString = Util.getCookie(Const.prevAtTipsTimeCookieName);\r\n    if (!timeString || !/^\\d+日\\d+时\\d+分$/.test(timeString)) return;\r\n    let prevString = '';\r\n    $('.thread-list-item time').each(function (index) {\r\n        let $this = $(this);\r\n        let curString = $.trim($this.text());\r\n        if (index === 0) prevString = curString;\r\n        if (timeString < curString && prevString >= curString) {\r\n            $this.addClass('text-danger');\r\n            prevString = curString;\r\n        }\r\n        else return false;\r\n    });\r\n\r\n    $(document).on('click', '.thread-list-item .thread-link-item a', function () {\r\n        Util.deleteCookie(Const.prevAtTipsTimeCookieName);\r\n    });\r\n};\r\n\r\n/**\r\n * 处理游戏搜索区域\r\n */\r\nexport const handleGameIntroSearchArea = function () {\r\n    $('#gameSearchKeyword').val(pageInfo.keyword);\r\n    $('#gameSearchType').val(pageInfo.searchType);\r\n};\r\n\r\n/**\r\n * 推游戏介绍\r\n * @param {string} type 页面类型\r\n */\r\nexport const tuiGameIntro = function (type) {\r\n    let cookieName = '';\r\n    if (type === 'company') cookieName = 'g_intro_inc_tui_';\r\n    else if (type === 'type') cookieName = 'g_intro_adv_tui_';\r\n    else if (type === 'property') cookieName = 'g_intro_moe_tui_';\r\n    else cookieName = 'g_intro_tui_';\r\n    cookieName += pageInfo.id;\r\n    let url = Util.makeUrl('game_intro/' + type, `id=${pageInfo.id}&tui=1`);\r\n\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        if (Util.getCookie(cookieName, '')) {\r\n            alert('你在48小时内已经推过');\r\n            return;\r\n        }\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: url,\r\n            success: function () {\r\n                let $num = $this.find('span:first');\r\n                let num = parseInt($num.text());\r\n                $num.text('+1');\r\n                setTimeout(() => {\r\n                    $num.text(++num);\r\n                }, 1000);\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            },\r\n            dataType: 'html'\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 随机选择神秘盒子\r\n */\r\nexport const randomSelectSmBox = function () {\r\n    $('#smBoxRandom').click(function () {\r\n        let $boxes = $('#smBoxPanel .table a');\r\n        let number = Math.floor(Math.random() * $boxes.length);\r\n        $(this).html(`你选择了<b>No. ${number}</b>`).off('click');\r\n        setTimeout(() => {\r\n            location.href = $boxes.eq(number).attr('href');\r\n        }, 1000);\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定收藏夹页面按钮点击事件\r\n */\r\nexport const bindFavorPageBtnsClick = function () {\r\n    let $form = $('form[name=\"favorForm\"]');\r\n\r\n    $(document).on('click', '.remove-catalog', () => confirm('是否删除该目录？'));\r\n\r\n    $('#addCatalog').click(function (e) {\r\n        e.preventDefault();\r\n        let type = $.trim(prompt('请输入收藏夹目录名称：'));\r\n        if (!type) return;\r\n        $form.find('[name=\"job\"]').val('addtype');\r\n        $form.find('[name=\"type\"]').val(type);\r\n        $form.submit();\r\n    });\r\n\r\n    $('#favorActionBtns').on('click', 'button', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            Util.selectReverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否删除这${$checked.length}项？`)) {\r\n                $form.find('[name=\"job\"]').val('clear');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n\r\n    $('#convertCatalogDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let type = $(this).data('type');\r\n        let $checked = $('[name=\"delid[]\"]:checked');\r\n        if ($checked.length > 0 && confirm(`是否将这${$checked.length}项转换到指定目录？`)) {\r\n            $form.find('[name=\"job\"]').val('change');\r\n            $form.find('[name=\"type\"]').val(type);\r\n            $form.submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定好友列表页面按钮点击事件\r\n */\r\nexport const bindFriendPageBtnsClick = function () {\r\n    $('#friendActionBtns').on('click', '[type=\"button\"]', function () {\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"selid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            Util.selectReverse($('[name=\"selid[]\"]'));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 在账号设置页面里为生日字段赋值\r\n */\r\nexport const assignBirthdayField = function () {\r\n    $('#birthday').change(function () {\r\n        let value = $(this).val().trim();\r\n        let matches = /(\\d{4})-(\\d{1,2})-(\\d{1,2})/.exec(value);\r\n        let year = '', month = '', day = '';\r\n        if (matches) {\r\n            year = parseInt(matches[1]);\r\n            month = parseInt(matches[2]);\r\n            day = parseInt(matches[3]);\r\n        }\r\n        $('[name=\"proyear\"]').val(year);\r\n        $('[name=\"promonth\"]').val(month);\r\n        $('[name=\"proday\"]').val(day);\r\n    });\r\n};\r\n\r\n/**\r\n * 同步主题每页楼层数量的设置\r\n */\r\nexport const syncPerPageFloorNum = function () {\r\n    /**\r\n     * 同步设置\r\n     */\r\n    const syncConfig = function () {\r\n        let perPageFloorNum = parseInt($('[name=\"p_num\"]').val());\r\n        if (perPageFloorNum === 0) perPageFloorNum = 10;\r\n        if (!isNaN(perPageFloorNum) && perPageFloorNum !== Config.perPageFloorNum) {\r\n            Config.perPageFloorNum = perPageFloorNum;\r\n            writeConfig();\r\n        }\r\n    };\r\n\r\n    syncConfig();\r\n    $('#creator').submit(function () {\r\n        readConfig();\r\n        syncConfig();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理上传头像文件浏览按钮\r\n */\r\nexport const handleUploadAvatarFileBtn = function () {\r\n    $('#browseAvatar').change(function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png'].includes(matches[1].toLowerCase())) {\r\n            alert('头像图片类型不匹配');\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 转账提醒\r\n */\r\nexport const transferKfbAlert = function () {\r\n    $('#transferKfbForm').submit(function () {\r\n        let $this = $(this);\r\n        let transferKfb = parseInt($this.find('[name=\"to_money\"]').val());\r\n        let fixedDeposit = parseInt($('#fixedDeposit').text());\r\n        let currentDeposit = parseInt($('#currentDeposit').text());\r\n        if (transferKfb > 0 && fixedDeposit > 0 && transferKfb > currentDeposit) {\r\n            if (!confirm('你的活期存款不足，转账金额将从定期存款里扣除，是否继续？')) {\r\n                return false;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定短消息页面操作按钮点击事件\r\n */\r\nexport const bindMessageActionBtnsClick = function () {\r\n    $('#messageActionBtns').on('click', 'button', function () {\r\n        let $form = $('#messageListForm');\r\n        let action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            Util.selectAll($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            Util.selectReverse($('[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectCustom') {\r\n            let title = $.trim(\r\n                prompt('请填写所要选择的包含指定字符串的短消息标题（可用|符号分隔多个标题）', '收到了他人转账的KFB|银行汇款通知|您的文章被评分|您的文章被删除')\r\n            );\r\n            if (!title) return;\r\n            $('[name=\"delid[]\"]').prop('checked', false);\r\n            $('a.thread-link').each(function () {\r\n                let $this = $(this);\r\n                for (let key of title.split('|')) {\r\n                    if ($this.text().toLowerCase().includes(key.toLowerCase())) {\r\n                        $this.parent().find('[name=\"delid[]\"]').prop('checked', true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else if (action === 'download') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否下载这${$checked.length}项？`)) {\r\n                $form.attr('action', '/message.php').find('[name=\"action\"]').val('down');\r\n                $form.submit();\r\n            }\r\n        }\r\n        else if (action === 'delete') {\r\n            let $checked = $('[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && confirm(`是否删除这${$checked.length}项？`)) {\r\n                $form.attr('action', Util.makeUrl('message/job')).find('[name=\"action\"]').val('del');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 验证注册页面字段\r\n */\r\nexport const validateRegisterField = function () {\r\n    $(document).on('change', 'input[name]', function () {\r\n        let $this = $(this);\r\n        let name = $this.attr('name');\r\n        let value = $this.val();\r\n        if (!value) {\r\n            Util.showValidationMsg($this, 'clear');\r\n            return;\r\n        }\r\n        if (name === 'regemail') {\r\n            Util.showValidationMsg($this, 'wait', '检查中，请稍等&hellip;');\r\n            $.post(Util.makeUrl('register/check'), 'username=' + value, ({type, msg, username}) => {\r\n                if ($this.val() === username) {\r\n                    Util.showValidationMsg($this, type, msg);\r\n                }\r\n            }).fail(() => {\r\n                Util.showValidationMsg($this, 'error', '响应失败');\r\n            });\r\n        }\r\n        else if (name === 'regpwd') {\r\n            if (value.length > 16 || value.length < 6) {\r\n                Util.showValidationMsg($this, 'error', '密码长度不正确');\r\n            }\r\n            else {\r\n                Util.showValidationMsg($this, 'clear');\r\n                $('[name=\"regpwdrepeat\"]').trigger('change');\r\n            }\r\n        }\r\n        else if (name === 'regpwdrepeat') {\r\n            if (value !== $('[name=\"regpwd\"]').val()) Util.showValidationMsg($this, 'error', '两次输入的密码不相符');\r\n            else Util.showValidationMsg($this, 'clear');\r\n        }\r\n    });\r\n\r\n    $('#registerForm').submit(function () {\r\n        if ($(this).find('.has-danger').length > 0) {\r\n            alert('请正确填写表单');\r\n            return false;\r\n        }\r\n    });\r\n};\r\n","'use strict';\r\nimport * as Util from './util';\r\n\r\n/**\r\n * 处理编辑器按钮\r\n */\r\nexport const handleEditorBtns = function () {\r\n    let textArea = $('#postContent').get(0);\r\n\r\n    // 编辑器按钮\r\n    $(document).on('click', '.editor-btn-group button[data-action]', function () {\r\n        let action = $(this).data('action');\r\n        let value = '';\r\n        let matches = null;\r\n        switch (action) {\r\n            case 'link':\r\n                value = prompt('请输入链接URL：', 'http://');\r\n                break;\r\n            case 'img':\r\n                value = prompt('请输入图片URL：', 'http://');\r\n                break;\r\n            case 'sell':\r\n                value = prompt('请输入出售金额：', 1);\r\n                break;\r\n            case 'hide':\r\n                value = prompt('请输入神秘等级：', 1);\r\n                break;\r\n            case 'audio':\r\n                value = prompt('请输入HTML5音频实际地址：\\n（可直接输入网易云音乐或虾米的单曲地址，将自动转换为外链地址）', 'http://');\r\n                matches = /^https?:\\/\\/music\\.163\\.com\\/(?:#\\/)?song\\?id=(\\d+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/163/${matches[1]}.mp3`;\r\n                matches = /^https?:\\/\\/www\\.xiami\\.com\\/song\\/(\\d+)/i.exec(value);\r\n                if (matches) value = `http://music.miaola.info/xiami/${matches[1]}.mp3`;\r\n                break;\r\n            case 'video':\r\n                value = prompt('请输入HTML5视频实际地址：\\n（可直接输入YouTube视频页面的地址，将自动转换为外链地址）', 'http://');\r\n                matches = /^https?:\\/\\/(?:www\\.)?youtube\\.com\\/watch\\?v=([\\w\\-]+)/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n                matches = /^https?:\\/\\/youtu\\.be\\/([\\w\\-]+)$/i.exec(value);\r\n                if (matches) value = `http://video.miaola.info/youtube/${matches[1]}`;\r\n                break;\r\n        }\r\n        if (value === null) return;\r\n\r\n        let selText = '';\r\n        let code = '';\r\n        switch (action) {\r\n            case 'link':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[url=${value}]${selText}[/url]`;\r\n                break;\r\n            case 'img':\r\n                code = `[img]${value}[/img]`;\r\n                break;\r\n            case 'quote':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[quote]${selText}[/quote]`;\r\n                break;\r\n            case 'code':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[code]${selText}[/code]`;\r\n                break;\r\n            case 'sell':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sell=${value}]${selText}[/sell]`;\r\n                break;\r\n            case 'hide':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[hide=${value}]${selText}[/hide]`;\r\n                break;\r\n            case 'bold':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[b]${selText}[/b]`;\r\n                break;\r\n            case 'italic':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[i]${selText}[/i]`;\r\n                break;\r\n            case 'underline':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[u]${selText}[/u]`;\r\n                break;\r\n            case 'strike':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[strike]${selText}[/strike]`;\r\n                break;\r\n            case 'super':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sup]${selText}[/sup]`;\r\n                break;\r\n            case 'sub':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[sub]${selText}[/sub]`;\r\n                break;\r\n            case 'horizontal':\r\n                code = `[hr]`;\r\n                break;\r\n            case 'align-left':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=left]${selText}[/align]`;\r\n                break;\r\n            case 'align-center':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=center]${selText}[/align]`;\r\n                break;\r\n            case 'align-right':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[align=right]${selText}[/align]`;\r\n                break;\r\n            case 'fly':\r\n                selText = Util.getSelText(textArea);\r\n                code = `[fly]${selText}[/fly]`;\r\n                break;\r\n            case 'audio':\r\n                code = `[audio]${value}[/audio]`;\r\n                break;\r\n            case 'video':\r\n                code = `[video]${value}[/video]`;\r\n                break;\r\n        }\r\n        if (!code) return;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // 字号下拉菜单\r\n    $('#fontSizeDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        let size = $(this).data('size');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[size=${size}]${selText}[/size]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n\r\n    // 颜色、背景颜色下拉菜单\r\n    $('#colorDropdownMenu, #bgColorDropdownMenu').on('click', 'span', function () {\r\n        let $this = $(this);\r\n        let codeType = $this.parent().is('#bgColorDropdownMenu') ? 'backcolor' : 'color';\r\n        let color = $this.data('color');\r\n        let selText = Util.getSelText(textArea);\r\n        let code = `[${codeType}=${color}]${selText}[/${codeType}]`;\r\n        Util.addCode(textArea, code, selText);\r\n        textArea.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 检查发帖表单\r\n */\r\nexport const checkPostForm = function () {\r\n    $('#postForm').submit(function () {\r\n        let $postType = $('#postType');\r\n        if ($postType.length > 0 && !$postType.val()) {\r\n            alert('没有选择主题分类');\r\n            $postType.focus();\r\n            return false;\r\n        }\r\n\r\n        let $postTitle = $('#postTitle');\r\n        if ($postTitle.length > 0) {\r\n            let length = Util.getStrByteLen($postTitle.val());\r\n            if (!length) {\r\n                alert('标题不能为空');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n            else if (length > 100) {\r\n                alert('标题超过最大长度 100 个字节');\r\n                $postTitle.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $voteItemContent = $('#voteItemContent');\r\n        if ($voteItemContent.length > 0) {\r\n            if (!$voteItemContent.val().trim()) {\r\n                alert('投票选项不能为空');\r\n                $voteItemContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postContent = $('#postContent');\r\n        if ($postContent.length > 0) {\r\n            let length = Util.getStrByteLen($postContent.val().trim());\r\n            if (length < 12) {\r\n                alert('文章内容少于 12 个字节');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n            else if (length > 50000) {\r\n                alert('文章内容大于 50000 个字节');\r\n                $postContent.focus();\r\n                return false;\r\n            }\r\n        }\r\n\r\n        let $postGjc = $('#postGjc');\r\n        if ($postGjc.length > 0 && pageInfo.action === 'new' && !$postGjc.val().trim()) {\r\n            alert('请在内容文本框的下方填写关键词，以方便搜索，也可以在标题中选择任意一个词填入');\r\n            $postGjc.focus();\r\n            return false;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理附件按钮\r\n */\r\nexport const handleAttachBtns = function () {\r\n    $(document).on('click', '.attach-area a[data-action]', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let $area = $this.closest('.attach-area');\r\n        let action = $this.data('action');\r\n        let id = $area.data('id');\r\n        if (!id) return;\r\n        if (action === 'insert') {\r\n            let type = $this.data('type');\r\n            let textArea = $('#postContent').get(0);\r\n            let code = `[${type === 'new' ? 'upload' : 'attachment'}=${id}]`;\r\n            Util.addCode(textArea, code);\r\n            textArea.focus();\r\n        }\r\n        else if (action === 'update') {\r\n            $area.find('.attach-info').prop('hidden', true).after(\r\n                `<label><input name=\"replace_${id}\" type=\"file\" aria-label=\"选择附件\"></label>`\r\n            );\r\n            $this.data('action', 'cancel').text('取消').blur();\r\n            if (!$(document).data('attachUpdateAlert')) {\r\n                alert('本反向代理服务器为了提高性能对图片设置了缓存，更新附件图片后可能需等待最多30分钟才能看到效果');\r\n                $(document).data('attachUpdateAlert', true);\r\n            }\r\n        }\r\n        else if (action === 'cancel') {\r\n            $area.find('.attach-info').prop('hidden', false).next('label').remove();\r\n            $this.data('action', 'update').text('更新').blur();\r\n        }\r\n        else if (action === 'delete') {\r\n            $area.remove();\r\n        }\r\n    });\r\n\r\n    $(document).on('change', '[type=\"file\"]', function () {\r\n        let $this = $(this);\r\n        let matches = /\\.(\\w+)$/.exec($this.val());\r\n        if (!matches || !['jpg', 'gif', 'png', 'torrent'].includes(matches[1].toLowerCase())) {\r\n            alert('附件类型不匹配');\r\n            return;\r\n        }\r\n\r\n        let type = $this.data('type');\r\n        if (type === 'new') {\r\n            $this.removeData('type').parent().next().prop('hidden', false);\r\n\r\n            let $newAttachArea = $('#newAttachArea');\r\n            let totalNum = $newAttachArea.find('[type=\"file\"]').length;\r\n            if (totalNum >= 5) return;\r\n            let $lastAttachArea = $newAttachArea.find('[type=\"file\"]:last').closest('.attach-area');\r\n            let id = parseInt($lastAttachArea.data('id'));\r\n            if (!id) return;\r\n            id++;\r\n            $(`\r\n<div class=\"form-group row font-size-sm attach-area\" data-id=\"${id}\">\r\n  <div class=\"col-xs-12 col-form-label\">\r\n    <label>\r\n      <input name=\"attachment_${id}\" data-type=\"new\" type=\"file\" aria-label=\"选择附件\">\r\n    </label>\r\n    <span hidden>\r\n      <a data-action=\"insert\" data-type=\"new\" href=\"#\">插入</a>&nbsp;\r\n      <a data-action=\"delete\" href=\"#\">删除</a>\r\n    </span>\r\n  </div>\r\n  <div class=\"col-xs-4\">\r\n    <label class=\"sr-only\" for=\"atc_downrvrc${id}\">神秘系数</label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_downrvrc${id}\" name=\"atc_downrvrc${id}\" data-toggle=\"tooltip\" \r\ntype=\"number\" value=\"0\" min=\"0\" title=\"神秘系数\" placeholder=\"神秘系数\">\r\n  </div>\r\n  <div class=\"col-xs-8\">\r\n    <label class=\"sr-only\" for=\"atc_desc${id}\">描述</label>\r\n    <input class=\"form-control form-control-sm\" id=\"atc_desc${id}\" name=\"atc_desc${id}\" data-toggle=\"tooltip\" type=\"text\" \r\ntitle=\"描述\" placeholder=\"描述\">\r\n  </div>\r\n</div>\r\n`).insertAfter($lastAttachArea).find('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 插入表情代码\r\n * @param {jQuery} $node 想要绑定的节点的jQuery对象\r\n */\r\nexport const addSmileCode = function ($node) {\r\n    $('.smile-panel').on('click', 'img', function () {\r\n        $('.smile-panel').addClass('open');\r\n        let textArea = $node.get(0);\r\n        if (!textArea) return;\r\n        let code = `[s:${$(this).data('id')}]`;\r\n        Util.addCode(textArea, code, '');\r\n        textArea.blur();\r\n    }).parent().on('shown.bs.dropdown', function () {\r\n        $('.smile-panel img').each(function () {\r\n            let $this = $(this);\r\n            if (!$this.attr('src')) {\r\n                $this.attr('src', $this.data('src'));\r\n            }\r\n        });\r\n    }).on('hide.bs.dropdown', function (e) {\r\n        let $relatedTarget = $(e.relatedTarget);\r\n        if (!$relatedTarget.data('open')) $relatedTarget.removeData('open');\r\n        else return e.preventDefault();\r\n    });\r\n\r\n    $('#smileDropdownBtn').click(function () {\r\n        let $this = $(this);\r\n        $this.data('open', !$this.data('open'));\r\n    });\r\n};\r\n","'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {read as readConfig, write as writeConfig} from './config';\r\n\r\n/**\r\n * 处理滚动到页顶/页底按钮\r\n */\r\nexport const handleRollToTopOrBottomBtn = function () {\r\n    $(window).scroll(function () {\r\n        let $btn = $('#rollToTopOrBottom');\r\n        if ($(window).scrollTop() > 640) {\r\n            if ($btn.data('direction') === 'top') return;\r\n            $btn.data('direction', 'top').attr('aria-label', '滚动到页顶')\r\n                .find('i').removeClass('fa-chevron-down').addClass('fa-chevron-up');\r\n        }\r\n        else {\r\n            if ($btn.data('direction') === 'bottom') return;\r\n            $btn.data('direction', 'bottom').attr('aria-label', '滚动到页底')\r\n                .find('i').removeClass('fa-chevron-up').addClass('fa-chevron-down');\r\n        }\r\n    });\r\n\r\n    $('#rollToTopOrBottom').click(function () {\r\n        let scrollTop = $(this).data('direction') === 'bottom' ? $('body').height() : 0;\r\n        $('body, html').animate({scrollTop: scrollTop});\r\n    });\r\n};\r\n\r\n/**\r\n * 处理搜索对话框\r\n */\r\nexport const handleSearchDialog = function () {\r\n    let $searchDialog = $('#searchDialog');\r\n\r\n    $searchDialog.on('shown.bs.modal', function () {\r\n        $('#searchKeyword').select().focus();\r\n    }).find('form').submit(function () {\r\n        let $this = $(this);\r\n        let $searchKeyword = $this.find('#searchKeyword');\r\n        let searchType = $this.find('#searchType').val();\r\n        let keyword = $.trim($searchKeyword.val());\r\n        if (searchType === 'gjc') {\r\n            $this.attr('action', Util.makeUrl('gjc/' + keyword));\r\n        }\r\n        else if (searchType === 'username') {\r\n            $this.attr('action', Util.makeUrl('user/username/' + keyword));\r\n        }\r\n        else {\r\n            $this.attr('action', Util.makeUrl('search'));\r\n            $searchKeyword.attr('name', searchType === 'author' ? 'pwuser' : 'keyword');\r\n            if (searchType === 'title') {\r\n                if (keyword.length && Util.getStrByteLen(keyword) <= 2) {\r\n                    let $method = $this.find('[name=\"method\"]');\r\n                    $method.val('OR');\r\n                    $searchKeyword.val(keyword + ' ' + Math.floor(new Date().getTime() / 1000));\r\n                    setTimeout(() => {\r\n                        $searchKeyword.val(keyword);\r\n                        $method.val('AND');\r\n                    }, 200);\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    $searchDialog.find('[name=\"searchRange\"]').on('click', function () {\r\n        let value = 'all';\r\n        if ($(this).val() === 'current') value = pageInfo.fid;\r\n        $searchDialog.find('[name=\"f_fid\"]').val(value);\r\n    });\r\n\r\n    let $current = $searchDialog.find('[name=\"searchRange\"][value=\"current\"]');\r\n    $searchDialog.find('#searchType').change(function () {\r\n        let searchType = $(this).val();\r\n        if (!$current.data('enabled')) return;\r\n        $current.prop('disabled', searchType === 'gjc' || searchType === 'username');\r\n    });\r\n\r\n    if (pageId === 'threadPage' || pageId === 'readPage') {\r\n        $current.prop('disabled', false).data('enabled', true).click();\r\n    }\r\n};\r\n\r\n/**\r\n * 处理分页导航\r\n */\r\nexport const handlePageInput = function () {\r\n    $(document).on('click', '.page-input', function (e) {\r\n        e.preventDefault();\r\n        if (pageInfo.maxPageNum && pageInfo.maxPageNum <= 1) return;\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let excludeParams = $(this).data('exclude');\r\n        if (excludeParams) excludeParams = excludeParams.split(',');\r\n        else excludeParams = [];\r\n        let num = parseInt(\r\n            prompt(`要跳转到第几页？${pageInfo.maxPageNum ? `（共${pageInfo.maxPageNum}页）` : ''}`, pageInfo.currentPageNum)\r\n        );\r\n        if (num && num > 0) {\r\n            location.href = Util.makeUrl(action, 'page=' + num, true, excludeParams);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定快速提交的快捷键\r\n * @param {jQuery} $node 想要绑定的节点的jQuery对象\r\n */\r\nexport const bindFastSubmitShortcutKey = function ($node) {\r\n    $node.keydown(function (e) {\r\n        if (e.keyCode === 13 && e.ctrlKey) {\r\n            $(this).closest('form').submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 显示编辑常用版块对话框\r\n */\r\nexport const showEditCommonForumDialog = function () {\r\n    $(document).on('click', '.edit-common-forum-btn', function (e) {\r\n        e.preventDefault();\r\n        readConfig();\r\n\r\n        let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n        let commonForumListHtml = '';\r\n        for (let {fid, name} of commonForumList) {\r\n            commonForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n        let availableForumListHtml = '';\r\n        for (let {fid, name} of Const.availableForumList) {\r\n            if (commonForumList.find(elem => elem.fid === fid)) continue;\r\n            availableForumListHtml += `<span class=\"btn btn-outline-primary\" data-fid=\"${fid}\">${name}</span>`;\r\n        }\r\n\r\n        let $dialog = $(`\r\n<div class=\"modal fade\" id=\"editCommonForumDialog\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"editCommonForumDialogTitle\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\" role=\"document\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <button class=\"close\" data-dismiss=\"modal\" type=\"button\" aria-label=\"关闭\">\r\n          <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n        <h4 class=\"modal-title\" id=\"editCommonForumDialogTitle\">常用版块</h4>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <fieldset class=\"fieldset mb-1 p-sm\">\r\n          <legend>常用版块</legend>\r\n          <div class=\"edit-forum-list\" id=\"editCommonForumList\">${commonForumListHtml}</div>\r\n        </fieldset>\r\n        <fieldset class=\"fieldset mb-1 p-sm\">\r\n          <legend>可用版块</legend>\r\n          <div class=\"edit-forum-list\" id=\"editAvailableForumList\">${availableForumListHtml}</div>\r\n        </fieldset>\r\n      </div>\r\n      <div class=\"modal-footer\">\r\n        <button class=\"btn btn-primary\" data-action=\"save\" type=\"button\">保存</button>\r\n        <button class=\"btn btn-secondary\" data-dismiss=\"modal\" type=\"button\">取消</button>\r\n        <button class=\"btn btn-danger\" data-action=\"reset\" type=\"button\">重置</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n`).appendTo('body').modal('show');\r\n\r\n        dragula(\r\n            $dialog.find('.edit-forum-list').get(),\r\n            {revertOnSpill: true}\r\n        );\r\n\r\n        $dialog.on('hidden.bs.modal', function () {\r\n            $(this).remove();\r\n        }).find('[data-action=\"save\"]').click(function () {\r\n            Config.commonForumList = [];\r\n            $('#editCommonForumList').children('.btn').each(function () {\r\n                let $this = $(this);\r\n                let fid = parseInt($this.data('fid'));\r\n                let name = $this.text().trim();\r\n                if (!fid || !name) return;\r\n                Config.commonForumList.push({fid: fid, name: name});\r\n            });\r\n            writeConfig();\r\n            alert('设置已保存');\r\n            $dialog.modal('hide');\r\n            location.reload();\r\n        }).end().find('[data-action=\"reset\"]').click(function () {\r\n            if (!confirm('是否重置？')) return;\r\n            Config.commonForumList = [];\r\n            writeConfig();\r\n            alert('设置已重置');\r\n            $dialog.modal('hide');\r\n            location.reload();\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 填充常用版块面板\r\n */\r\nexport const fillCommonForumPanel = function () {\r\n    let commonForumList = Config.commonForumList.length > 0 ? Config.commonForumList : Const.commonForumList;\r\n    let html = '';\r\n    for (let [index, {fid, name}] of commonForumList.entries()) {\r\n        if (index === 0 || index % 3 === 0) html += '<div class=\"row mb-1\">';\r\n        html += `\r\n<div class=\"col-xs-4\">\r\n  <a class=\"btn btn-outline-primary btn-block\" href=\"${Util.makeUrl('thread')}/${fid}\">${name}</a>\r\n</div>\r\n`;\r\n        if (index === commonForumList.length - 1 || index % 3 === 2) html += '</div>';\r\n    }\r\n    $('.common-forum-panel').html(html);\r\n};\r\n","'use strict';\r\nimport * as Util from './util';\r\nimport Const from './const';\r\nimport {write as writeConfig} from './config';\r\n\r\n/**\r\n * 显示楼层跳转链接\r\n */\r\nexport const showFloorLink = function () {\r\n    $(document).on('click', '.floor-num', function (e) {\r\n        e.preventDefault();\r\n        prompt('本楼的跳转链接：', Util.getHostNameUrl() + $(this).attr('href'));\r\n    });\r\n};\r\n\r\n/**\r\n * 处理快速回复按钮\r\n */\r\nexport const handleFastReplyBtn = function () {\r\n    $(document).on('click', '.fast-reply-btn', function (e) {\r\n        e.preventDefault();\r\n        let $article = $(this).closest('article');\r\n        let floor = $article.data('floor');\r\n        let userName = $article.data('username');\r\n        $('#postGjc').val(userName);\r\n        let postContent = $('#postContent').get(0);\r\n        postContent.value = `[quote]回 ${floor}楼(${userName}) 的帖子[/quote]\\n`;\r\n        postContent.selectionStart = postContent.value.length;\r\n        postContent.selectionEnd = postContent.value.length;\r\n        postContent.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理屏蔽回帖按钮\r\n */\r\nexport const handleBlockFloorBtn = function () {\r\n    $(document).on('click', '.block-floor', () => confirm('确认要屏蔽该回帖？本操作不可恢复！（屏蔽后该回帖将对大家不可见）'));\r\n};\r\n\r\n/**\r\n * 处理购买帖子按钮\r\n */\r\nexport const handleBuyThreadBtn = function () {\r\n    $(document).on('click', '.buy-thread-btn', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let pid = $this.data('pid');\r\n        let price = $this.data('price');\r\n        if (price > 5 && !confirm(`此贴售价${price}KFB，是否购买？`)) return;\r\n        location.href = Util.makeUrl('job/buytopic', `tid=${pageInfo.tid}&pid=${pid}&verify=${pageInfo.verify}`);\r\n    });\r\n};\r\n\r\n/**\r\n * 复制购买人名单\r\n */\r\nexport const copyBuyThreadList = function () {\r\n    $(document).on('change', '.buy-thread-list', function () {\r\n        let $this = $(this);\r\n        if ($this.val() !== 'copyList') return;\r\n        let list = $this.find('option').map(function (index) {\r\n            let name = $(this).text();\r\n            if (index === 0 || index === 1 || name === '-'.repeat(11)) return null;\r\n            else return name;\r\n        }).get().join('\\n');\r\n        if (!list) {\r\n            alert('暂时无人购买');\r\n            $this.get(0).selectedIndex = 0;\r\n            return;\r\n        }\r\n        $('#buyThreadListContent').val(list);\r\n        $('#buyThreadListDialog').modal('show');\r\n        $this.get(0).selectedIndex = 0;\r\n    });\r\n\r\n    $('#buyThreadListDialog').on('shown.bs.modal', function () {\r\n        $('#buyThreadListContent').select().focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理楼层内的图片\r\n */\r\nexport const handleFloorImage = function () {\r\n    $(document).on('click', '.img', function () {\r\n        let $this = $(this);\r\n        if ($this.parent().is('a') || this.naturalWidth <= $this.closest('.read-content').width()) return;\r\n        location.href = $this.attr('src');\r\n    });\r\n};\r\n\r\n/**\r\n * 快速跳转到指定楼层\r\n */\r\nexport const fastGotoFloor = function () {\r\n    $('.fast-goto-floor').click(function (e) {\r\n        e.preventDefault();\r\n        if (!Config.perPageFloorNum) {\r\n            let floorNum = parseInt(\r\n                prompt('你的论坛设置里“文章列表每页个数”为多少（10、20、30）？\\n注：如修改了论坛中的此项设置，请访问账号设置页面即可自动同步本地设置', 10)\r\n            );\r\n            if ([10, 20, 30].includes(floorNum)) {\r\n                Config.perPageFloorNum = floorNum;\r\n                writeConfig();\r\n            }\r\n            else return;\r\n        }\r\n        let action = $(this).data('url');\r\n        if (!action) return;\r\n        let floor = parseInt(prompt('你要跳转到哪一层楼？'));\r\n        if (!floor || floor <= 0) return;\r\n        location.href = Util.makeUrl(\r\n            action,\r\n            `page=${Math.floor(floor / Config.perPageFloorNum) + 1}&floor=${floor}`\r\n        );\r\n    });\r\n\r\n    if (pageInfo.floor && pageInfo.floor > 0) {\r\n        let hashName = $(`article[data-floor=\"${pageInfo.floor}\"]`).prev('a').attr('name');\r\n        if (hashName) {\r\n            location.hash = '#' + hashName;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * 推帖子\r\n */\r\nexport const tuiThread = function () {\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/diy_read_tui.php',\r\n            data: `tid=${pageInfo.tid}&safeid=${pageInfo.safeId}`,\r\n            success: function (msg) {\r\n                let matches = /<span.+?\\+\\d+!<\\/span>\\s*(\\d+)/i.exec(msg);\r\n                if (matches) {\r\n                    let $num = $this.find('span:first');\r\n                    $num.text('+1');\r\n                    setTimeout(() => {\r\n                        $num.text(matches[1]);\r\n                    }, 1000);\r\n                }\r\n                else if (/已推过/.test(msg)) {\r\n                    alert('已推过');\r\n                }\r\n                else {\r\n                    alert('操作失败');\r\n                }\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 复制代码\r\n */\r\nexport const copyCode = function () {\r\n    $(document).on('click', '.copy-code', function (e) {\r\n        e.preventDefault();\r\n        let $this = $(this);\r\n        let code = $this.data('code');\r\n        if (code) {\r\n            $this.text('复制代码').removeData('code');\r\n            $this.next('textarea').remove();\r\n            $this.after(`<pre class=\"pre-scrollable\">${code}</pre>`);\r\n        }\r\n        else {\r\n            let $pre = $this.next('pre');\r\n            let html = $pre.html();\r\n            $this.text('还原代码').data('code', html);\r\n            html = Util.decodeHtmlSpecialChar(html);\r\n            let height = $pre.height();\r\n            if (height < 50) height = 50;\r\n            if (height > 340) height = 340;\r\n            $pre.remove();\r\n            $(`<textarea class=\"form-control code-textarea\" style=\"height: ${height}px\" wrap=\"off\">${html}</textarea>`)\r\n                .insertAfter($this).select().focus();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 获取当前页面选中的多重引用数据\r\n * @returns {{}[]} 多重引用数据列表\r\n */\r\nconst getCheckedMultiQuoteData = function () {\r\n    let quoteList = [];\r\n    $('.multi-quote-check:checked').each(function () {\r\n        let $article = $(this).closest('article');\r\n        quoteList.push({floor: $article.data('floor'), pid: $article.data('pid'), userName: $article.data('username')});\r\n    });\r\n    return quoteList;\r\n};\r\n\r\n/**\r\n * 绑定多重引用复选框点击事件\r\n */\r\nexport const bindMultiQuoteCheckClick = function () {\r\n    $(document).on('click', '.multi-quote-check', function () {\r\n        let data = localStorage[Const.multiQuoteStorageName];\r\n        if (data) {\r\n            try {\r\n                data = JSON.parse(data);\r\n                if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) data = null;\r\n                else if (!('tid' in data) || data.tid !== pageInfo.tid || $.type(data.quoteList) !== 'object') data = null;\r\n            }\r\n            catch (ex) {\r\n                data = null;\r\n            }\r\n        }\r\n        else {\r\n            data = null;\r\n        }\r\n        let quoteList = getCheckedMultiQuoteData();\r\n        if (!data) {\r\n            localStorage.removeItem(Const.multiQuoteStorageName);\r\n            data = {tid: pageInfo.tid, quoteList: {}};\r\n        }\r\n        if (quoteList.length > 0) data.quoteList[pageInfo.currentPageNum] = quoteList;\r\n        else delete data.quoteList[pageInfo.currentPageNum];\r\n        localStorage[Const.multiQuoteStorageName] = JSON.stringify(data);\r\n    });\r\n\r\n    $('.multi-reply-btn').click(function (e) {\r\n        e.preventDefault();\r\n        handleMultiQuote(1);\r\n    });\r\n};\r\n\r\n/**\r\n * 处理多重回复和多重引用\r\n * @param {number} type 处理类型，1：多重回复；2：多重引用\r\n */\r\nconst handleMultiQuote = function (type = 1) {\r\n    let data = localStorage[Const.multiQuoteStorageName];\r\n    if (!data) return;\r\n    try {\r\n        data = JSON.parse(data);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) return;\r\n    let {tid, quoteList} = data;\r\n    if (!pageInfo.tid || tid !== pageInfo.tid || $.type(quoteList) !== 'object') return;\r\n    if (type === 2 && !pageInfo.fid) return;\r\n    let list = [];\r\n    for (let data of Object.values(quoteList)) {\r\n        if ($.type(data) !== 'array') continue;\r\n        for (let quote of data) {\r\n            list.push(quote);\r\n        }\r\n    }\r\n    if (!list.length) {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        return;\r\n    }\r\n\r\n    let keywords = new Set();\r\n    let content = '';\r\n    if (type === 2) {\r\n        // 显示多重引用等待消息\r\n    }\r\n    for (let quote of list) {\r\n        if (!('floor' in quote) || !('pid' in quote)) continue;\r\n        keywords.add(quote.userName);\r\n        if (type === 2) {\r\n            // 处理多重引用\r\n        }\r\n        else {\r\n            content += `[quote]回 ${quote.floor}楼(${quote.userName}) 的帖子[/quote]\\n`;\r\n        }\r\n    }\r\n    $('input[name=\"diy_guanjianci\"]').val([...keywords].join(','));\r\n    $('#postForm').submit(function () {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n    });\r\n    if (type === 1) $('#postContent').val(content).focus();\r\n};\r\n\r\n/**\r\n * 处理清除多重引用数据按钮\r\n * @param {number} type 处理类型，1：多重回复；2：多重引用\r\n */\r\nexport const handleClearMultiQuoteDataBtn = function (type = 1) {\r\n    $('.clear-multi-quote-data-btn').click(function (e) {\r\n        e.preventDefault();\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        $('[name=\"diy_guanjianci\"]').val('');\r\n        if (type === 2) $('#textarea').val('');\r\n        else $('#postContent').val('');\r\n        alert('多重引用数据已被清除');\r\n    });\r\n};\r\n","'use strict';\r\n\r\n/**\r\n * 设置Cookie\r\n * @param {string} name Cookie名称\r\n * @param {*} value Cookie值\r\n * @param {?Date} date Cookie有效期，留空则表示有效期为浏览器进程\r\n * @param {string} prefix Cookie名称前缀\r\n */\r\nexport const setCookie = function (name, value, date = null, prefix = pageInfo.cookiePrefix) {\r\n    document.cookie = `${prefix}${name}=${encodeURI(value)}${!date ? '' : ';expires=' + date.toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * 获取Cookie\r\n * @param {string} name Cookie名称\r\n * @param {string} prefix Cookie名称前缀\r\n * @returns {?string} Cookie值\r\n */\r\nexport const getCookie = function (name, prefix = pageInfo.cookiePrefix) {\r\n    let regex = new RegExp(`(^| )${prefix}${name}=([^;]*)(;|$)`);\r\n    let matches = document.cookie.match(regex);\r\n    if (!matches) return null;\r\n    else return decodeURI(matches[2]);\r\n};\r\n\r\n/**\r\n * 删除Cookie\r\n * @param {string} name Cookie名称\r\n * @param {string} prefix Cookie名称前缀\r\n */\r\nexport const deleteCookie = function (name, prefix = pageInfo.cookiePrefix) {\r\n    document.cookie = `${prefix}${name}=;expires=${getDate('-1d').toUTCString()};path=/;`;\r\n};\r\n\r\n/**\r\n * 获取在当前时间的基础上的指定（相对）时间量的Date对象\r\n * @param {string} value 指定（相对）时间量，+或-：之后或之前（相对于当前时间）；无符号：绝对值；Y：完整年份；y：年；M：月；d：天；h：小时；m：分；s：秒；ms：毫秒\r\n * @returns {?Date} 指定（相对）时间量的Date对象\r\n * @example\r\n * Tools.getDate('+2y') 获取2年后的Date对象\r\n * Tools.getDate('+3M') 获取3个月后的Date对象\r\n * Tools.getDate('-4d') 获取4天前的Date对象\r\n * Tools.getDate('5h') 获取今天5点的Date对象（其它时间量与当前时间一致）\r\n * Tools.getDate('2015Y') 获取年份为2015年的Date对象\r\n */\r\nexport const getDate = function (value) {\r\n    let date = new Date();\r\n    let matches = /^(-|\\+)?(\\d+)([a-zA-Z]{1,2})$/.exec(value);\r\n    if (!matches) return null;\r\n    let flag = typeof matches[1] === 'undefined' ? 0 : (matches[1] === '+' ? 1 : -1);\r\n    let increment = flag === -1 ? -parseInt(matches[2]) : parseInt(matches[2]);\r\n    let unit = matches[3];\r\n    switch (unit) {\r\n        case 'Y':\r\n            date.setFullYear(increment);\r\n            break;\r\n        case 'y':\r\n            date.setFullYear(flag === 0 ? increment : date.getFullYear() + increment);\r\n            break;\r\n        case 'M':\r\n            date.setMonth(flag === 0 ? increment : date.getMonth() + increment);\r\n            break;\r\n        case 'd':\r\n            date.setDate(flag === 0 ? increment : date.getDate() + increment);\r\n            break;\r\n        case 'h':\r\n            date.setHours(flag === 0 ? increment : date.getHours() + increment);\r\n            break;\r\n        case 'm':\r\n            date.setMinutes(flag === 0 ? increment : date.getMinutes() + increment);\r\n            break;\r\n        case 's':\r\n            date.setSeconds(flag === 0 ? increment : date.getSeconds() + increment);\r\n            break;\r\n        case 'ms':\r\n            date.setMilliseconds(flag === 0 ? increment : date.getMilliseconds() + increment);\r\n            break;\r\n        default:\r\n            return null;\r\n    }\r\n    return date;\r\n};\r\n\r\n/**\r\n * 获取指定字符串的字节长度（1个GBK字符按2个字节来算）\r\n * @param {string} str 指定字符串\r\n * @returns {number} 字符串的长度\r\n */\r\nexport const getStrByteLen = function (str) {\r\n    let len = 0;\r\n    let cLen = 2;\r\n    for (let i = 0; i < str.length; i++) {\r\n        len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? cLen : 1;\r\n    }\r\n    return len;\r\n};\r\n\r\n/**\r\n * 获取当前域名的URL\r\n * @returns {string} 当前域名的URL\r\n */\r\nexport const getHostNameUrl = function () {\r\n    return location.protocol + '//' + location.host;\r\n};\r\n\r\n/**\r\n * 添加BBCode\r\n * @param textArea 文本框\r\n * @param {string} code BBCode\r\n * @param {string} selText 选择文本\r\n */\r\nexport const addCode = function (textArea, code, selText = '') {\r\n    let startPos = selText === '' ? code.indexOf(']') + 1 : code.indexOf(selText);\r\n    if (typeof textArea.selectionStart !== 'undefined') {\r\n        let prePos = textArea.selectionStart;\r\n        textArea.value = textArea.value.substring(0, prePos) + code + textArea.value.substring(textArea.selectionEnd);\r\n        textArea.selectionStart = prePos + startPos;\r\n        textArea.selectionEnd = prePos + startPos + selText.length;\r\n    }\r\n    else {\r\n        textArea.value += code;\r\n    }\r\n};\r\n\r\n/**\r\n * 获取选择文本\r\n * @param textArea 文本框\r\n * @returns {string} 选择文本\r\n */\r\nexport const getSelText = function (textArea) {\r\n    return textArea.value.substring(textArea.selectionStart, textArea.selectionEnd);\r\n};\r\n\r\n/**\r\n * 从URL查询字符串提取参数对象\r\n * @param {string} str URL查询字符串\r\n * @returns {Map} 参数集合\r\n */\r\nexport const extractQueryStr = function (str) {\r\n    let params = new Map();\r\n    for (let param of str.split('&')) {\r\n        if (!param) continue;\r\n        let [key, value] = param.split('=');\r\n        params.set(key, value !== undefined ? value : '');\r\n    }\r\n    return params;\r\n};\r\n\r\n/**\r\n * 从参数对象中创建URL查询字符串\r\n * @param {Map} map 参数集合\r\n * @returns {string} URL查询字符串\r\n */\r\nexport const buildQueryStr = function (map) {\r\n    let queryStr = '';\r\n    for (let [key, value] of map) {\r\n        if (pageInfo.urlType === 2) {\r\n            queryStr += (queryStr ? '&' : '') + key + '=' + value;\r\n        }\r\n        else {\r\n            queryStr += (queryStr ? '/' : '') + key + '/' + value;\r\n        }\r\n    }\r\n    return queryStr;\r\n};\r\n\r\n/**\r\n * 生成指定的URL\r\n * @param {string} action 控制器（小写）\r\n * @param {string} param 查询参数\r\n * @param {boolean} includeOtherParam 是否包括当前页面的其它查询参数\r\n * @param {[]} excludeParams 要排除当前页面的查询参数列表\r\n * @returns {string} URL 最终的URL\r\n */\r\nexport const makeUrl = function (action, param = '', includeOtherParam = false, excludeParams = []) {\r\n    let url = '';\r\n    let paramList = extractQueryStr(param);\r\n    if (includeOtherParam) {\r\n        paramList = new Map([...extractQueryStr(pageInfo.urlParam).entries(), ...paramList.entries()]);\r\n        for (let i in excludeParams) {\r\n            paramList.delete(excludeParams[i]);\r\n        }\r\n    }\r\n    if (!action.startsWith('/')) {\r\n        if (location.pathname.startsWith(pageInfo.baseFile)) url = pageInfo.baseFile + '/';\r\n        else url = pageInfo.rootPath;\r\n    }\r\n    url += action;\r\n    if (paramList.size > 0) {\r\n        let queryStr = buildQueryStr(paramList);\r\n        if (queryStr) {\r\n            url += (pageInfo.urlType === 2 ? '?' : '/') + queryStr;\r\n        }\r\n    }\r\n    return url;\r\n};\r\n\r\n/**\r\n * 解码HTML特殊字符\r\n * @param {string} str 待解码的字符串\r\n * @returns {string} 解码后的字符串\r\n */\r\nexport const decodeHtmlSpecialChar = function (str) {\r\n    if (!str.length) return '';\r\n    return str.replace(/<br\\s*\\/?>/gi, '\\n')\r\n        .replace(/&quot;/gi, '\\\"')\r\n        .replace(/&#39;/gi, '\\'')\r\n        .replace(/&nbsp;/gi, ' ')\r\n        .replace(/&gt;/gi, '>')\r\n        .replace(/&lt;/gi, '<')\r\n        .replace(/&amp;/gi, '&');\r\n};\r\n\r\n/**\r\n * 全选\r\n * @param {jQuery} $nodes 想要全选的节点的jQuery对象\r\n */\r\nexport const selectAll = function ($nodes) {\r\n    $nodes.prop('checked', true);\r\n};\r\n\r\n/**\r\n * 反选\r\n * @param {jQuery} $nodes 想要反选的节点的jQuery对象\r\n */\r\nexport const selectReverse = function ($nodes) {\r\n    $nodes.each(function () {\r\n        let $this = $(this);\r\n        $this.prop('checked', !$this.prop('checked'));\r\n    });\r\n};\r\n\r\n/**\r\n * 显示字段验证消息\r\n * @param {jQuery} $node 验证字段的jQuery对象\r\n * @param {string} type 验证类型\r\n * @param {string} msg 验证消息\r\n */\r\nexport const showValidationMsg = function ($node, type, msg = '') {\r\n    if (type === 'error') type = 'danger';\r\n    $node.removeClass('form-control-success form-control-warning form-control-danger');\r\n    let $parent = $node.parent();\r\n    $parent.removeClass('has-success has-warning has-danger');\r\n    if ($.inArray(type, ['success', 'warning', 'danger'] > -1)) {\r\n        $node.addClass('form-control-' + type).parent().addClass('has-' + type);\r\n    }\r\n    let $feedback = $parent.find('.form-control-feedback');\r\n    if (type === 'wait') {\r\n        $feedback.html(`<span class=\"text-muted\"><i class=\"fa fa-spinner fa-spin\" aria-hidden=\"true\"></i> ${msg}</span>`);\r\n    }\r\n    else {\r\n        $feedback.text(msg);\r\n    }\r\n};\r\n\r\n/**\r\n * 获取对象A在对象B中的相对补集\r\n * @param {Object} a 对象A\r\n * @param {Object} b 对象B\r\n * @returns {Object} 相对补集\r\n */\r\nexport const getDifferenceSetOfObject = function (a, b) {\r\n    let c = {};\r\n    if ($.type(a) !== 'object' || $.type(b) !== 'object') return c;\r\n    $.each(b, (key, data) => {\r\n        if (key in a) {\r\n            if (!deepEqual(a[key], data)) c[key] = data;\r\n        }\r\n    });\r\n    return c;\r\n};\r\n\r\n/**\r\n * 深度比较两个对象是否相等\r\n * @param {*} a\r\n * @param {*} b\r\n * @returns {boolean} 是否相等\r\n */\r\nexport const deepEqual = function (a, b) {\r\n    if (a === b) return true;\r\n    if ($.type(a) !== $.type(b)) return false;\r\n    if (typeof a === 'number' && typeof b === 'number' && isNaN(a) && isNaN(b)) return true;\r\n    if ($.isArray(a) && $.isArray(b) || $.type(a) === 'object' && $.type(b) === 'object') {\r\n        if (a.length !== b.length) return false;\r\n        for (var i in $.extend($.isArray(a) ? [] : {}, a, b)) {\r\n            if (typeof a[i] === 'undefined' || typeof b[i] === 'undefined') return false;\r\n            if (!deepEqual(a[i], b[i])) return false;\r\n        }\r\n        return true;\r\n    }\r\n    return false;\r\n};\r\n"]}
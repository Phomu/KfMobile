!function e(t,n,a){function o(r,l){if(!n[r]){if(!t[r]){var s="function"==typeof require&&require;if(!l&&s)return s(r,!0);if(i)return i(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){var n=t[r][1][e];return o(n?n:e)},c,c.exports,e,t,n,a)}return n[r].exports}for(var i="function"==typeof require&&require,r=0;r<a.length;r++)o(a[r]);return o}({1:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var i=e("./module/Config"),r=e("./module/util"),l=(o(r),e("./module/const")),s=(a(l),e("./module/msg")),d=(o(s),e("./module/dialog")),c=(o(d),e("./module/public")),u=o(c),f=e("./module/index"),m=o(f),p=e("./module/read"),g=o(p),h=e("./module/post"),b=o(h),v=e("./module/other"),y=o(v),k=e("./module/configDialog");o(k);window.pageId=$("body").attr("id");var w=function(){try{window.Util=e("./module/Util"),window.Const=e("./module/Const").default,window.Msg=e("./module/Msg"),window.Dialog=e("./module/Dialog"),window.Public=e("./module/Public"),window.Index=e("./module/Index"),window.Read=e("./module/Read"),window.Post=e("./module/Post"),window.Other=e("./module/Other");var t=e("./module/Config");window.readConfig=t.read,window.writeConfig=t.write}catch(e){console.log(e)}},C=function(){if("loginPage"!==pageId){var e=new Date;if(w(),"registerPage"===pageId)return void y.validateRegisterField();(0,i.init)(),Config.customCssEnabled&&Config.customCssContent&&$("head").append("<style>"+Config.customCssContent+"</style>"),u.preventCloseWindow(),u.handleMainMenu(),u.handleMainMenuLink(),Config.showSidebarBtnGroupEnabled&&u.showSidebarBtnGroup(),u.handleSidebarRollBtn(),u.handleSearchDialog(),u.fillCommonForumPanel(),u.showEditCommonForumDialog(),$(".page-input").length>0&&u.handlePageInput(),"indexPage"===pageId?(m.handleAtTipsBtn(),m.handleIndexThreadPanel(),m.handleSelectBgImage(),m.handleSelectBgColor(),m.handleCustomBgStyle()):"readPage"===pageId?(g.gotoFloor(),Config.threadContentFontSize>0&&$("head").append("<style>.read-content { font-size: "+Config.threadContentFontSize+"px; }</style>"),g.handleFastGotoFloorBtn(),g.handleTuiThreadBtn(),g.handleCopyFloorLinkBtn(),g.handleFastReplyBtn(),g.handleBlockFloorBtn(),g.handleBuyThreadBtn(),g.copyBuyThreadList(),g.handleFloorImage(),b.checkPostForm(),u.bindFastSubmitShortcutKey($("#postContent")),g.handleCopyCodeBtn(),b.addSmileCode($("#postContent")),g.bindMultiQuoteCheckClick(),b.handleClearMultiQuoteDataBtn(),$(".multi-reply-btn").click(function(){return b.handleMultiQuote(1)}),Config.userMemoEnabled&&g.addUserMemo()):"postPage"===pageId?(b.checkPostForm(),u.bindFastSubmitShortcutKey($("#postContent")),b.handleEditorBtns(),b.addSmileCode($("#postContent")),b.handleAttachBtns(),b.handleClearMultiQuoteDataBtn(),Info.multiQuote&&b.handleMultiQuote(2)):"gjcPage"===pageId?y.highlightUnReadAtTipsMsg():"userPage"===pageId?y.handleUserPageBtns():"gameIntroSearchPage"===pageId?y.handleGameIntroSearchArea():"gameIntroPage"===pageId?y.tuiGameIntro("game"):"gameIntroCompanyPage"===pageId?y.tuiGameIntro("company"):"gameIntroTypePage"===pageId?y.tuiGameIntro("type"):"gameIntroPropertyPage"===pageId?y.tuiGameIntro("property"):"favorPage"===pageId?y.bindFavorPageBtnsClick():"friendPage"===pageId?y.bindFriendPageBtnsClick():"modifyPage"===pageId?(y.syncPerPageFloorNum(),y.assignBirthdayField(),y.handleUploadAvatarFileBtn()):"bankPage"===pageId?y.transferKfbAlert():"messagePage"===pageId?y.bindMessageActionBtnsClick():"readMessagePage"===pageId?(g.handleFloorImage(),g.handleCopyCodeBtn()):"writeMessagePage"===pageId?(u.bindFastSubmitShortcutKey($("#msgContent")),b.addSmileCode($("#msgContent"))):"messageBannedPage"===pageId&&u.bindFastSubmitShortcutKey($('[name="banidinfo"]')),Config.blockUserEnabled&&u.blockUsers(),Config.blockThreadEnabled&&u.blockThread(),Config.followUserEnabled&&u.followUsers(),Config.kfSmileEnhanceExtensionEnabled&&["readPage","postPage","writeMessagePage"].includes(pageId)&&$("body").append('<script src="/KfEmotion.min.user.js'+(Info.resTimestamp?"?ts="+Info.resTimestamp:"")+'"></script>'),$('[data-toggle="tooltip"]').tooltip({container:"body"}),console.log("脚本加载完毕，耗时："+(new Date-e)+"ms")}};$(document).ready(C)},{"./module/Config":2,"./module/Const":3,"./module/Dialog":4,"./module/Index":5,"./module/Msg":6,"./module/Other":7,"./module/Post":8,"./module/Public":9,"./module/Read":10,"./module/Util":11,"./module/configDialog":13,"./module/const":14,"./module/dialog":15,"./module/index":16,"./module/msg":17,"./module/other":18,"./module/post":19,"./module/public":20,"./module/read":21,"./module/util":22}],2:[function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.normalize=n.clear=n.write=n.read=n.init=n.Config=void 0;var o=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("./util"),r=a(i),l="kf_config",s=n.Config={activeNewReplyPanel:"#galgameNewReplyPanel",activeTopRecommendPanel:"#galgameTopRecommendPanel",commonForumList:[],showSidebarBtnGroupEnabled:!0,showSidebarRollBtnEnabled:!0,showSidebarMainMenuBtnEnabled:!1,showSidebarForumListBtnEnabled:!0,showSidebarSearchBtnEnabled:!1,showSidebarHomePageBtnEnabled:!0,perPageFloorNum:10,threadContentFontSize:0,userMemoEnabled:!1,userMemoList:{},kfSmileEnhanceExtensionEnabled:!1,defShowMsgDuration:-1,customCssEnabled:!1,customCssContent:"",followUserEnabled:!1,followUserList:[],highlightFollowUserThreadInHPEnabled:!0,highlightFollowUserThreadLinkEnabled:!0,blockUserEnabled:!1,blockUserDefaultType:0,blockUserAtTipsEnabled:!0,blockUserForumType:0,blockUserFidList:[],blockUserList:[],blockThreadEnabled:!1,blockThreadDefForumType:0,blockThreadDefFidList:[],blockThreadList:[]},d=(n.init=function(){window.Config=$.extend(!0,{},s),d()},n.read=function(){var e=localStorage[l];if(e){try{e=JSON.parse(e)}catch(e){return}e&&"object"===$.type(e)&&!$.isEmptyObject(e)&&(e=c(e),window.Config=$.extend(!0,{},s,e))}}),c=(n.write=function(){var e=r.getDifferenceSetOfObject(s,window.Config);localStorage[l]=JSON.stringify(e)},n.clear=function(){localStorage.removeItem(l)},n.normalize=function(e){var t={};if("object"!==$.type(e))return t;var n=!0,a=!1,i=void 0;try{for(var r,l=Object.entries(e)[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var d=o(r.value,2),c=d[0],u=d[1];c in s&&$.type(u)===$.type(s[c])&&(t[c]=u)}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t})},{"./util":22}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a={multiQuoteStorageName:"kf_multi_quote",atTipsTimeCookieName:"at_tips_time",prevAtTipsTimeCookieName:"prev_at_tips_time",bgStyleCookieName:"bg_style",commonForumList:[{fid:106,name:"新作动态"},{fid:41,name:"网盘下载"},{fid:16,name:"种子下载"},{fid:52,name:"游戏讨论"},{fid:84,name:"动漫讨论"},{fid:67,name:"CG下载"},{fid:5,name:"自由讨论"},{fid:56,name:"个人日记"},{fid:57,name:"同人漫本"}],availableForumList:[{fid:106,name:"新作动态"},{fid:52,name:"游戏讨论"},{fid:16,name:"种子下载"},{fid:41,name:"网盘下载"},{fid:67,name:"CG下载"},{fid:102,name:"游戏推荐"},{fid:24,name:"疑难互助"},{fid:57,name:"同人漫本"},{fid:84,name:"动漫讨论"},{fid:92,name:"动画共享"},{fid:127,name:"漫画小说"},{fid:68,name:"音乐共享"},{fid:163,name:"LIVE共享"},{fid:182,name:"转载资源"},{fid:94,name:"原创绘画"},{fid:87,name:"宅物交流"},{fid:86,name:"电子产品"},{fid:115,name:"文字作品"},{fid:96,name:"图片来源"},{fid:36,name:"寻求资源"},{fid:5,name:"自由讨论"},{fid:56,name:"个人日记"},{fid:9,name:"我的关注"},{fid:4,name:"意见投诉"},{fid:93,name:"管理组区"},{fid:59,name:"原创组区"},{fid:125,name:"水楼林立"},{fid:181,name:"私人日记"},{fid:42,name:"旧期资料"},{fid:128,name:"作品判定"},{fid:98,name:"日本语版"},{fid:99,name:"意見箱"},{fid:112,name:"掲示板"},{fid:100,name:"創作感想"}]};n.default=a},{}],4:[function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.close=n.resize=n.show=n.create=void 0;var o=e("./util"),i=a(o),r=(n.create=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o='\n<form>\n<div class="dialog" id="'+e+'" tabindex="-1" role="dialog" aria-hidden="true" aria-labelledby="'+e+'Title">\n  <div class="container dialog-content" role="document">\n    <div class="dialog-header">\n      <h5 class="dialog-title" id="'+e+'Title">'+t+'</h5>\n      <button class="close" data-dismiss="dialog" type="button" aria-label="关闭">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    <div class="dialog-body">'+n+'</div>\n    <div class="dialog-footer" '+(a?"":"hidden")+">"+a+"</div>\n  </div>\n</div>\n</form>",s=$(o).appendTo("body");return s.on("click",'[data-dismiss="dialog"]',function(){return l(e)}).on("click",".tips",function(){return!1}).on("click",".disabled-link",function(){return!1}).keydown(function(t){if(27===t.keyCode)return l(e)}).find('legend [type="checkbox"]').click(function(){var e=$(this),t=e.prop("checked");i.isOpera()||i.isEdge()?e.closest("fieldset").find("input, select, textarea, button").not("legend input").prop("disabled",!t):e.closest("fieldset").prop("disabled",!t)}).end().find("input[data-disabled]").click(function(){var e=$(this),t=e.prop("checked");$(e.data("disabled")).each(function(){var e=$(this);e.is("a")?t?e.removeClass("disabled-link"):e.addClass("disabled-link"):e.prop("disabled",!t)})}).end().find('[data-toggle="tooltip"]').tooltip({container:"body"}),$(window).on("resize."+e,function(){var t=$(":focus");t.length>0&&(t.is("input")&&!["checkbox","radio"].includes(t.attr("type"))||t.is("textarea"))||r(e)}),s},n.show=function(e){var t=$("#"+e);t.length&&(t.find('legend [type="checkbox"]').each(function(){$(this).triggerHandler("click")}).end().find("input[data-disabled]").each(function(){$(this).triggerHandler("click")}),t.fadeIn("normal").find(".close:first").focus(),r(e))},n.resize=function(e){var t=$("#"+e);t.find(".dialog-body").css("max-height",$(window).height()-t.find(".dialog-header").outerHeight()-t.find(".dialog-footer").outerHeight())}),l=n.close=function(e){return $("#"+e).fadeOut("normal",function(){$(this).parent().remove()}),$(window).off("resize."+e),!1}},{"./util":22}],5:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.handleCustomBgStyle=n.handleSelectBgColor=n.handleSelectBgImage=n.handleIndexThreadPanel=n.handleAtTipsBtn=void 0;var i=e("./util"),r=o(i),l=e("./const"),s=a(l),d=e("./config");n.handleAtTipsBtn=function(){$("#atTips").click(function(){var e=$(this),t=e.data("time"),n=r.getCookie(s.default.atTipsTimeCookieName);if(t&&t!==n){if(n)n!==t&&r.setCookie(s.default.prevAtTipsTimeCookieName,n);else{var a=(new Date).getDate();r.setCookie(s.default.prevAtTipsTimeCookieName,(a<10?"0"+a:a)+"日00时00分")}r.setCookie(s.default.atTipsTimeCookieName,t,r.getDate("+3d")),e.removeClass("btn-outline-danger").addClass("btn-outline-primary")}})},n.handleIndexThreadPanel=function(){Config.activeNewReplyPanel&&$('a[data-toggle="tab"][href="'+Config.activeNewReplyPanel+'"]').tab("show"),Config.activeTopRecommendPanel&&$('a[data-toggle="tab"][href="'+Config.activeTopRecommendPanel+'"]').tab("show"),$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(e){var t=$(e.target),n=t.attr("href"),a="";n.includes("NewReplyPanel")?a="activeNewReplyPanel":n.includes("TopRecommendPanel")&&(a="activeTopRecommendPanel"),a&&Config[a]!==n&&((0,d.read)(),Config[a]=n,(0,d.write)())})},n.handleSelectBgImage=function(){$("#selectBgImage").on("click","[data-id]",function(){var e=$(this),t=e.data("id"),n=e.data("filename"),a=e.parent().data("path");t&&n&&a&&confirm("是否选择此背景图片？")&&(r.setCookie(s.default.bgStyleCookieName,t,r.getDate("+1y")),$("body, .modal-content").css("background-image",'url("'+a+n+'")'),alert("背景已更换（图片可能需要一定时间加载）"))})},n.handleSelectBgColor=function(){$("#selectBgImage").on("click","[data-color]",function(){var e=$(this),t=e.data("color");t&&confirm("是否选择此背景颜色？")&&(r.setCookie(s.default.bgStyleCookieName,t,r.getDate("+1y")),$("body, .modal-content").css("background",t),alert("背景已更换"))})},n.handleCustomBgStyle=function(){$("#customBgStyle").click(function(){var e=r.getCookie(s.default.bgStyleCookieName);if(e&&!parseInt(e)||(e=""),e=prompt("请输入背景图片URL、颜色代码或CSS样式：\n（例：http://xxx.com/abc.jpg 或 #fcfcfc，留空表示恢复默认背景）\n（注：建议选择简洁、不花哨、偏浅色系的背景图片或颜色）",e),null!==e){var t=$("body, .modal-content, .dialog-content");""===$.trim(e)?(r.setCookie(s.default.bgStyleCookieName,"",r.getDate("-1d")),alert("背景已恢复默认"),location.reload()):/^https?:\/\/[^"']+/.test(e)?(r.setCookie(s.default.bgStyleCookieName,e,r.getDate("+1y")),t.css("background-image",'url("'+e+'")'),alert("背景已更换（图片可能需要一定时间加载）")):/^#[0-9a-f]{6}$/i.test(e)?(r.setCookie(s.default.bgStyleCookieName,e,r.getDate("+1y")),t.css("background",e.toLowerCase()),alert("背景已更换")):/[<>{}]/.test(e)?alert("格式不正确"):(e=e.replace(";",""),r.setCookie(s.default.bgStyleCookieName,e,r.getDate("+1y")),t.css("background",e),alert("背景已更换（图片可能需要一定时间加载）"))}})}},{"./config":12,"./const":14,"./util":22}],6:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=n.show=function(e,t){var n={msg:"",duration:Config.defShowMsgDuration,clickable:!0,preventable:!1};"object"===$.type(e)?$.extend(n,e):(n.msg=e,n.duration="undefined"==typeof t?Config.defShowMsgDuration:t);var a=$(".msg-container"),i=0===a.length;i||$(".mask").length||a.height()>=.8*$(window).height()&&(r(),i=!0),n.preventable&&!$(".mask").length&&$('<div class="mask"></div>').appendTo("body"),i&&(a=$('<div class="container msg-container"></div>').appendTo("body"));var l=$('<div class="msg">'+n.msg+"</div>").appendTo(a);return l.on("click",".stop-action",function(e){e.preventDefault(),$(this).text("正在停止&hellip;").closest(".msg").data("stop",!0)}),n.clickable&&l.css("cursor","pointer").click(function(){o($(this))}).find("a").click(function(e){e.stopPropagation()}),n.preventable&&l.attr("preventable",!0),l.slideDown("normal"),n.duration>-1&&setTimeout(function(){o(l)},1e3*n.duration),l},o=(n.wait=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e+='<i class="fa fa-spinner fa-spin fa-lg fa-fw ml-3" aria-label="等待中" aria-hidden="true"></i>',a({msg:e,duration:-1,clickable:!1,preventable:t})},n.hide=function(e){e.slideUp("normal",function(){i($(this))})}),i=n.remove=function(e){var t=e.parent();e.remove(),$(".msg").length?$(".msg[preventable]").length||$(".mask").remove():(t.remove(),$(".mask").remove())},r=n.destroy=function(){$(".msg-container").remove(),$(".mask").remove()}},{}],7:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.handleUserPageBtns=n.validateRegisterField=n.bindMessageActionBtnsClick=n.transferKfbAlert=n.handleUploadAvatarFileBtn=n.syncPerPageFloorNum=n.assignBirthdayField=n.bindFriendPageBtnsClick=n.bindFavorPageBtnsClick=n.tuiGameIntro=n.handleGameIntroSearchArea=n.highlightUnReadAtTipsMsg=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e("./util"),l=o(r),s=e("./const"),d=a(s),c=e("./config");n.highlightUnReadAtTipsMsg=function(){if(Info.gjc===Info.userName){var e=l.getCookie(d.default.prevAtTipsTimeCookieName);if(e&&/^\d+日\d+时\d+分$/.test(e)){var t="";$(".thread-list-item time").each(function(n){var a=$(this),o=$.trim(a.text());return 0===n&&(t=o),e<o&&t>=o&&(a.addClass("text-danger"),void(t=o))}),$(document).on("click",".thread-list-item .thread-link-item a",function(){l.deleteCookie(d.default.prevAtTipsTimeCookieName)})}}},n.handleGameIntroSearchArea=function(){$("#gameSearchKeyword").val(Info.keyword),$("#gameSearchType").val(Info.searchType)},n.tuiGameIntro=function(e){var t="";t="company"===e?"g_intro_inc_tui_":"type"===e?"g_intro_adv_tui_":"property"===e?"g_intro_moe_tui_":"g_intro_tui_",t+=Info.id;var n=l.makeUrl("game_intro/"+e,"id="+Info.id+"&tui=1");$(".tui-btn").click(function(e){e.preventDefault();var a=$(this);if(!a.data("wait")){if(l.getCookie(t,""))return void alert("你在48小时内已经推过");a.data("wait",!0),$.ajax({type:"GET",url:n,success:function(){var e=a.find("span:first"),t=parseInt(e.text());e.text("+1"),setTimeout(function(){e.text(++t)},1e3)},error:function(){alert("操作失败")},complete:function(){a.removeData("wait")},dataType:"html"})}})},n.bindFavorPageBtnsClick=function(){var e=$('form[name="favorForm"]');$(document).on("click",".remove-catalog",function(){return confirm("是否删除该目录？")}),$("#addCatalog").click(function(t){t.preventDefault();var n=$.trim(prompt("请输入收藏夹目录名称："));n&&(e.find('[name="job"]').val("addtype"),e.find('[name="type"]').val(n),e.submit())}),$("#favorActionBtns").on("click","button",function(){var t=$(this).data("action");if("selectAll"===t)l.selectAll($('[name="delid[]"]'));else if("selectInverse"===t)l.selectInverse($('[name="delid[]"]'));else if("delete"===t){var n=$('[name="delid[]"]:checked');n.length>0&&confirm("是否删除这"+n.length+"项？")&&(e.find('[name="job"]').val("clear"),e.submit())}}),$("#convertCatalogDropdownMenu").on("click","a",function(t){t.preventDefault();var n=$(this).data("type"),a=$('[name="delid[]"]:checked');a.length>0&&confirm("是否将这"+a.length+"项转换到指定目录？")&&(e.find('[name="job"]').val("change"),e.find('[name="type"]').val(n),e.submit())})},n.bindFriendPageBtnsClick=function(){$("#friendActionBtns").on("click",'[type="button"]',function(){var e=$(this).data("action");"selectAll"===e?l.selectAll($('[name="selid[]"]')):"selectInverse"===e&&l.selectInverse($('[name="selid[]"]'))})},n.assignBirthdayField=function(){$("#birthday").change(function(){var e=$(this).val().trim(),t=/(\d{4})-(\d{1,2})-(\d{1,2})/.exec(e),n="",a="",o="";t&&(n=parseInt(t[1]),a=parseInt(t[2]),o=parseInt(t[3])),$('[name="proyear"]').val(n),$('[name="promonth"]').val(a),$('[name="proday"]').val(o)})},n.syncPerPageFloorNum=function(){var e=function(){var e=parseInt($('[name="p_num"]').val());0===e&&(e=10),isNaN(e)||e===Config.perPageFloorNum||(Config.perPageFloorNum=e,(0,c.write)())};e(),$("#creator").submit(function(){(0,c.read)(),e()})},n.handleUploadAvatarFileBtn=function(){$("#browseAvatar").change(function(){var e=$(this),t=/\.(\w+)$/.exec(e.val());t&&["jpg","gif","png"].includes(t[1].toLowerCase())||alert("头像图片类型不匹配")})},n.transferKfbAlert=function(){$("#transferKfbForm").submit(function(){var e=$(this),t=parseInt(e.find('[name="to_money"]').val()),n=parseInt($("#fixedDeposit").text()),a=parseInt($("#currentDeposit").text());if(t>0&&n>0&&t>a&&!confirm("你的活期存款不足，转账金额将从定期存款里扣除，是否继续？"))return!1})},n.bindMessageActionBtnsClick=function(){$("#messageActionBtns").on("click","button",function(){var e=$("#messageListForm"),t=$(this).attr("name");if("selectAll"===t)l.selectAll($('[name="delid[]"]'));else if("selectInverse"===t)l.selectInverse($('[name="delid[]"]'));else if("selectCustom"===t){var n=function(){var e=$.trim(prompt("请填写所要选择的包含指定字符串的短消息标题（可用|符号分隔多个标题）","收到了他人转账的KFB|银行汇款通知|您的文章被评分|您的文章被删除"));return e?($('[name="delid[]"]').prop("checked",!1),void $("a.thread-link").each(function(){var t=$(this),n=!0,a=!1,o=void 0;try{for(var i,r=e.split("|")[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;t.text().toLowerCase().includes(l.toLowerCase())&&t.parent().find('[name="delid[]"]').prop("checked",!0)}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}})):{v:void 0}}();if("object"===("undefined"==typeof n?"undefined":i(n)))return n.v}else if("download"===t){var a=$('[name="delid[]"]:checked');a.length>0&&confirm("是否下载这"+a.length+"项？")&&(e.attr("action","/message.php").find('[name="action"]').val("down"),e.submit())}else if("delete"===t){var o=$('[name="delid[]"]:checked');o.length>0&&confirm("是否删除这"+o.length+"项？")&&(e.attr("action",l.makeUrl("message/job")).find('[name="action"]').val("del"),e.submit())}})},n.validateRegisterField=function(){$(document).on("change","input[name]",function(){var e=$(this),t=e.attr("name"),n=e.val();return n?void("regemail"===t?(l.showValidationMsg(e,"wait","检查中，请稍等&hellip;"),$.post(l.makeUrl("register/check"),"username="+n,function(t){var n=t.type,a=t.msg,o=t.username;e.val()===o&&l.showValidationMsg(e,n,a)}).fail(function(){l.showValidationMsg(e,"error","响应失败")})):"regpwd"===t?n.length>16||n.length<6?l.showValidationMsg(e,"error","密码长度不正确"):(l.showValidationMsg(e,"clear"),$('[name="regpwdrepeat"]').trigger("change")):"regpwdrepeat"===t&&(n!==$('[name="regpwd"]').val()?l.showValidationMsg(e,"error","两次输入的密码不相符"):l.showValidationMsg(e,"clear"))):void l.showValidationMsg(e,"clear")}),$("#registerForm").submit(function(){if($(this).find(".has-danger").length>0)return alert("请正确填写表单"),!1})},n.handleUserPageBtns=function(){var e=$("#profileBtns"),t=e.data("username");e.on("click",'[name="followUser"], [name="blockUser"]',function(){(0,c.read)();var e=$(this),n="关注",a=Config.followUserList;if("blockUser"===e.attr("name")?(n="屏蔽",a=Config.blockUserList,Config.blockUserEnabled=!0):Config.followUserEnabled=!0,e.text().includes("取消")){var o=l.inFollowOrBlockUserList(t,a);o>-1&&(a.splice(o,1),(0,c.write)()),e.removeClass("btn-outline-danger").addClass("btn-outline-primary").find("span").text(n+"用户"),alert("该用户已被取消"+n)}else{if(l.inFollowOrBlockUserList(t,a)===-1){if("屏蔽"===n){var i=Config.blockUserDefaultType;if(i=prompt("请填写屏蔽类型，0：主题和回帖；1：主题；2：回帖",i),null===i)return;i=parseInt(i),(isNaN(i)||i<0||i>2)&&(i=Config.blockUserDefaultType),a.push({name:t,type:i})}else a.push({name:t});(0,c.write)()}e.removeClass("btn-outline-primary").addClass("btn-outline-danger").find("span").text("取消"+n),alert("该用户已被"+n)}}).find('[name="followUser"], [name="blockUser"]').each(function(){var e=$(this),n="关注",a=Config.followUserList;"blockUser"===e.attr("name")&&(n="屏蔽",a=Config.blockUserList),l.inFollowOrBlockUserList(t,a)>-1&&e.removeClass("btn-outline-primary").addClass("btn-outline-danger").find("span").text("取消"+n)})}},{"./config":12,"./const":14,"./util":22}],8:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.handleClearMultiQuoteDataBtn=n.handleMultiQuote=n.addSmileCode=n.handleAttachBtns=n.checkPostForm=n.handleEditorBtns=void 0;var r=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=e("./util"),s=o(l),d=e("./const"),c=a(d),u=e("./msg"),f=o(u);n.handleEditorBtns=function(){var e=$("#postContent").get(0);$(document).on("click",".editor-btn-group button[data-action]",function(){var t=$(this).data("action"),n="";switch(t){case"link":n=prompt("请输入链接URL：","http://");break;case"img":n=prompt("请输入图片URL：","http://");break;case"sell":n=prompt("请输入出售金额：",1);break;case"hide":n=prompt("请输入神秘等级：",1);break;case"audio":n=prompt("请输入HTML5音频实际地址：\n（可直接输入网易云音乐或虾米的单曲地址，将自动转换为外链地址）","http://");var a=/^https?:\/\/music\.163\.com\/(?:#\/)?song\?id=(\d+)/i.exec(n);a&&(n="http://music.miaola.info/163/"+a[1]+".mp3"),a=/^https?:\/\/www\.xiami\.com\/song\/(\d+)/i.exec(n),a&&(n="http://music.miaola.info/xiami/"+a[1]+".mp3");break;case"video":n=prompt("请输入HTML5视频实际地址：\n（可直接输入YouTube视频页面的地址，将自动转换为外链地址）","http://");var o=/^https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w\-]+)/i.exec(n);o&&(n="http://video.miaola.info/youtube/"+o[1]),o=/^https?:\/\/youtu\.be\/([\w\-]+)$/i.exec(n),o&&(n="http://video.miaola.info/youtube/"+o[1])}if(null!==n){var i="",r="";switch(t){case"link":i=s.getSelText(e),r="[url="+n+"]"+i+"[/url]";break;case"img":r="[img]"+n+"[/img]";break;case"quote":i=s.getSelText(e),r="[quote]"+i+"[/quote]";break;case"code":i=s.getSelText(e),r="[code]"+i+"[/code]";break;case"sell":i=s.getSelText(e),r="[sell="+n+"]"+i+"[/sell]";break;case"hide":i=s.getSelText(e),r="[hide="+n+"]"+i+"[/hide]";break;case"bold":i=s.getSelText(e),r="[b]"+i+"[/b]";break;case"italic":i=s.getSelText(e),r="[i]"+i+"[/i]";break;case"underline":i=s.getSelText(e),r="[u]"+i+"[/u]";break;case"strike":i=s.getSelText(e),r="[strike]"+i+"[/strike]";break;case"super":i=s.getSelText(e),r="[sup]"+i+"[/sup]";break;case"sub":i=s.getSelText(e),r="[sub]"+i+"[/sub]";break;case"horizontal":r="[hr]";break;case"align-left":i=s.getSelText(e),r="[align=left]"+i+"[/align]";break;case"align-center":i=s.getSelText(e),r="[align=center]"+i+"[/align]";break;case"align-right":i=s.getSelText(e),r="[align=right]"+i+"[/align]";break;case"fly":i=s.getSelText(e),r="[fly]"+i+"[/fly]";break;case"audio":r="[audio]"+n+"[/audio]";break;case"video":r="[video]"+n+"[/video]"}r&&(s.addCode(e,r,i),e.focus())}}),$("#fontSizeDropdownMenu").on("click","a",function(t){t.preventDefault();var n=$(this).data("size"),a=s.getSelText(e),o="[size="+n+"]"+a+"[/size]";s.addCode(e,o,a),e.focus()}),$("#colorDropdownMenu, #bgColorDropdownMenu").on("click","span",function(){var t=$(this),n=t.parent().is("#bgColorDropdownMenu")?"backcolor":"color",a=t.data("color"),o=s.getSelText(e),i="["+n+"="+a+"]"+o+"[/"+n+"]";s.addCode(e,i,o),e.focus()})},n.checkPostForm=function(){$("#postForm").submit(function(){var e=$("#postType");if(e.length>0&&!e.val())return alert("没有选择主题分类"),e.focus(),!1;var t=$("#postTitle");if(t.length>0){var n=s.getStrByteLen(t.val());if(!n)return alert("标题不能为空"),t.focus(),!1;if(n>100)return alert("标题超过最大长度 100 个字节"),t.focus(),!1}var a=$("#voteItemContent");if(a.length>0&&!a.val().trim())return alert("投票选项不能为空"),a.focus(),!1;var o=$("#postContent");if(o.length>0){var i=s.getStrByteLen(o.val().trim());if(i<12)return alert("文章内容少于 12 个字节"),o.focus(),!1;if(i>5e4)return alert("文章内容大于 50000 个字节"),o.focus(),!1}var r=$("#postGjc");return r.length>0&&"new"===Info.action&&!r.val().trim()?(alert("请在内容文本框的下方填写关键词，以方便搜索，也可以在标题中选择任意一个词填入"),r.focus(),!1):void 0})},n.handleAttachBtns=function(){$(document).on("click",".attach-area a[data-action]",function(e){e.preventDefault();var t=$(this),n=t.closest(".attach-area"),a=t.data("action"),o=n.data("id");if(o)if("insert"===a){var i=t.data("type"),r=$("#postContent").get(0),l="["+("new"===i?"upload":"attachment")+"="+o+"]";s.addCode(r,l),r.focus()}else"update"===a?(n.find(".attach-info").prop("hidden",!0).after('<label><input name="replace_'+o+'" type="file" aria-label="选择附件"></label>'),t.data("action","cancel").text("取消").blur(),$(document).data("attachUpdateAlert")||(alert("本反向代理服务器为了提高性能对图片设置了缓存，更新附件图片后可能需等待最多30分钟才能看到效果"),$(document).data("attachUpdateAlert",!0))):"cancel"===a?(n.find(".attach-info").prop("hidden",!1).next("label").remove(),t.data("action","update").text("更新").blur()):"delete"===a&&n.remove()}),$(document).on("change",'[type="file"]',function(){var e=$(this),t=/\.(\w+)$/.exec(e.val());if(!t||!["jpg","gif","png","torrent"].includes(t[1].toLowerCase()))return void alert("附件类型不匹配");var n=e.data("type");if("new"===n){e.removeData("type").parent().next().prop("hidden",!1);var a=$("#newAttachArea"),o=a.find('[type="file"]').length;if(o>=5)return;var i=a.find('[type="file"]:last').closest(".attach-area"),r=parseInt(i.data("id"));if(!r)return;r++,$('\n<div class="form-group row font-size-sm attach-area" data-id="'+r+'">\n  <div class="col-xs-12 col-form-label">\n    <label>\n      <input name="attachment_'+r+'" data-type="new" type="file" aria-label="选择附件">\n    </label>\n    <span hidden>\n      <a data-action="insert" data-type="new" href="#">插入</a>&nbsp;\n      <a data-action="delete" href="#">删除</a>\n    </span>\n  </div>\n  <div class="col-xs-4">\n    <label class="sr-only" for="atc_downrvrc'+r+'">神秘系数</label>\n    <input class="form-control form-control-sm" id="atc_downrvrc'+r+'" name="atc_downrvrc'+r+'" data-toggle="tooltip" \ntype="number" value="0" min="0" title="神秘系数" placeholder="神秘系数">\n  </div>\n  <div class="col-xs-8">\n    <label class="sr-only" for="atc_desc'+r+'">描述</label>\n    <input class="form-control form-control-sm" id="atc_desc'+r+'" name="atc_desc'+r+'" data-toggle="tooltip" type="text" \ntitle="描述" placeholder="描述">\n  </div>\n</div>\n').insertAfter(i).find('[data-toggle="tooltip"]').tooltip({container:"body"})}})},n.addSmileCode=function(e){$(".smile-panel").on("click","img",function(){$(".smile-panel").addClass("open");var t=e.get(0);if(t){var n="[s:"+$(this).data("id")+"]";s.addCode(t,n,""),t.blur()}}).parent().on("shown.bs.dropdown",function(){$(".smile-panel img").each(function(){var e=$(this);e.attr("src")||e.attr("src",e.data("src"))})}).on("hide.bs.dropdown",function(e){var t=$(e.relatedTarget);return t.data("open")?e.preventDefault():void t.removeData("open")}),$("#smileDropdownBtn").click(function(){var e=$(this);e.data("open",!e.data("open"))})},n.handleMultiQuote=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=localStorage[c.default.multiQuoteStorageName];if(t){try{t=JSON.parse(t)}catch(e){return}if(t&&"object"===$.type(t)&&!$.isEmptyObject(t)){var n=t,a=n.tid,o=n.quoteList;if(Info.tid&&a===Info.tid&&"object"===$.type(o)&&(2!==e||Info.fid)){var l=[],d=!0,u=!1,m=void 0;try{for(var p,g=Object.values(o)[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var h=p.value;if(Array.isArray(h)){var b=!0,v=!1,y=void 0;try{for(var k,w=h[Symbol.iterator]();!(b=(k=w.next()).done);b=!0){var C=k.value;l.push(C)}}catch(e){v=!0,y=e}finally{try{!b&&w.return&&w.return()}finally{if(v)throw y}}}}}catch(e){u=!0,m=e}finally{try{!d&&g.return&&g.return()}finally{if(u)throw m}}if(!l.length)return void localStorage.removeItem(c.default.multiQuoteStorageName);var x=new Set,T="";2===e&&(f.wait('<span class="mr-3">正在获取引用内容中&hellip;</span>剩余：<em class="text-warning countdown-num">'+l.length+"</em>"),$(document).clearQueue("MultiQuote")),$.each(l,function(t,n){"undefined"!=typeof n.floor&&"undefined"!=typeof n.pid&&(x.add(n.userName),2===e?$(document).queue("MultiQuote",function(){$.get(s.makeUrl("post/index","action=quote&fid="+Info.fid+"&tid="+a+"&pid="+n.pid+"&article="+n.floor+"&t="+(new Date).getTime()),function(e){var n=e.postContent;T+=n?n+(t===l.length-1?"":"\n"):"";var a=$(".countdown-num:last");a.text(parseInt(a.text())-1),t===l.length-1?(f.destroy(),$("#postContent").val(T).focus()):setTimeout(function(){return $(document).dequeue("MultiQuote")},100)})}):T+="[quote]回 "+n.floor+"楼("+n.userName+") 的帖子[/quote]\n")});var S=!0,U=!1,I=void 0;try{for(var _,F=l.entries()[Symbol.iterator]();!(S=(_=F.next()).done);S=!0){var D=r(_.value,2);D[0],D[1]}}catch(e){U=!0,I=e}finally{try{!S&&F.return&&F.return()}finally{if(U)throw I}}$('[name="diy_guanjianci"]').val([].concat(i(x)).join(",")),$("#postForm").submit(function(){localStorage.removeItem(c.default.multiQuoteStorageName);
}),2===e?$(document).dequeue("MultiQuote"):$("#postContent").val(T).focus()}}}},n.handleClearMultiQuoteDataBtn=function(){$(".clear-multi-quote-data-btn").click(function(e){e.preventDefault(),confirm("是否清除多重引用数据？")&&(localStorage.removeItem(c.default.multiQuoteStorageName),$('[name="diy_guanjianci"]').val(""),$("#postContent").val(""))})}},{"./const":14,"./msg":17,"./util":22}],9:[function(require,module,exports){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.blockThread=exports.blockUsers=exports.followUsers=exports.showCommonImportOrExportConfigDialog=exports.preventCloseWindow=exports.fillCommonForumPanel=exports.showEditCommonForumDialog=exports.bindFastSubmitShortcutKey=exports.handlePageInput=exports.handleSearchDialog=exports.handleSidebarRollBtn=exports.showSidebarBtnGroup=exports.handleMainMenuLink=exports.handleMainMenu=void 0;var _slicedToArray=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_util=require("./util"),Util=_interopRequireWildcard(_util),_const=require("./const"),_const2=_interopRequireDefault(_const),_dialog=require("./dialog"),Dialog=_interopRequireWildcard(_dialog),_config=require("./config"),_configDialog=require("./configDialog"),ConfigDialog=_interopRequireWildcard(_configDialog),handleMainMenu=exports.handleMainMenu=function(){$("#mainMenuTogglerBtn").click(function(){var e=document.documentElement.clientHeight-$(this).closest(".navbar").outerHeight();e>0&&$("#mainMenu").css("max-height",e+"px")}),$("#sidebarMainMenuBtn").click(function(){return $("#mainMenuTogglerBtn").click()})},handleMainMenuLink=exports.handleMainMenuLink=function(){$("#mainMenu").find('[data-name="openConfigDialog"]').click(function(e){e.preventDefault(),$("#mainMenuTogglerBtn").click(),ConfigDialog.show()})},showSidebarBtnGroup=exports.showSidebarBtnGroup=function(){$(".sidebar-btn-group").prop("hidden",!1),Config.showSidebarRollBtnEnabled&&$("#sidebarRollBtn").prop("hidden",!1),Config.showSidebarMainMenuBtnEnabled&&$("#sidebarMainMenuBtn").prop("hidden",!1),Config.showSidebarForumListBtnEnabled&&$("#sidebarForumListBtn").prop("hidden",!1),Config.showSidebarSearchBtnEnabled&&$("#sidebarSearchBtn").prop("hidden",!1),Config.showSidebarHomePageBtnEnabled&&$("#sidebarHomePageBtn").prop("hidden",!1)},handleSidebarRollBtn=exports.handleSidebarRollBtn=function(){$(window).scroll(function(){var e=$("#sidebarRollBtn");if($(window).scrollTop()>640){if("top"===e.data("direction"))return;e.data("direction","top").attr("aria-label","滚动到页顶").find("i").removeClass("fa-chevron-down").addClass("fa-chevron-up")}else{if("bottom"===e.data("direction"))return;e.data("direction","bottom").attr("aria-label","滚动到页底").find("i").removeClass("fa-chevron-up").addClass("fa-chevron-down")}}),$("#sidebarRollBtn").click(function(){var e="bottom"===$(this).data("direction")?$("body").height():0;$("body, html").animate({scrollTop:e})})},handleSearchDialog=exports.handleSearchDialog=function(){var e=$("#searchDialog");e.on("shown.bs.modal",function(){$("#searchKeyword").select().focus()}).find("form").submit(function(){var e=$(this),t=e.find("#searchKeyword"),n=e.find("#searchType").val(),a=$.trim(t.val());"gjc"===n?e.attr("action",Util.makeUrl("gjc/"+a)):"username"===n?e.attr("action",Util.makeUrl("user/username/"+a)):(e.attr("action",Util.makeUrl("search")),t.attr("name","author"===n?"pwuser":"keyword"),"title"===n&&a.length&&Util.getStrByteLen(a)<=2&&!function(){var n=e.find('[name="method"]');n.val("OR"),t.val(a+" "+Math.floor((new Date).getTime()/1e3)),setTimeout(function(){t.val(a),n.val("AND")},200)}())}),e.find('[name="searchRange"]').on("click",function(){var t="all";"current"===$(this).val()&&(t=Info.fid),e.find('[name="f_fid"]').val(t)});var t=e.find('[name="searchRange"][value="current"]'),n=t.closest(".form-check-inline");e.find("#searchType").change(function(){var e=$(this).val();if(t.data("enabled")){var a="gjc"===e||"username"===e;t.prop("disabled",a),a?n.addClass("disabled"):n.removeClass("disabled")}}),"threadPage"!==pageId&&"readPage"!==pageId||(t.prop("disabled",!1).data("enabled",!0).click(),n.removeClass("disabled"))},handlePageInput=exports.handlePageInput=function(){$(document).on("click",".page-input",function(e){if(e.preventDefault(),!(Info.maxPageNum&&Info.maxPageNum<=1)){var t=$(this).data("url");if(t){var n=$(this).data("exclude");n=n?n.split(","):[];var a=parseInt(prompt("要跳转到第几页？"+(Info.maxPageNum?"（共"+Info.maxPageNum+"页）":""),Info.currentPageNum));a&&a>0&&(location.href=Util.makeUrl(t,"page="+a,!0,n))}}})},bindFastSubmitShortcutKey=exports.bindFastSubmitShortcutKey=function(e){e.keydown(function(e){13===e.keyCode&&e.ctrlKey&&$(this).closest("form").submit()})},showEditCommonForumDialog=exports.showEditCommonForumDialog=function(){$(document).on("click",".edit-common-forum-btn",function(e){e.preventDefault();var t="editCommonForumDialog";if(!($("#"+t).length>0)){(0,_config.read)();var n=Config.commonForumList.length>0?Config.commonForumList:_const2.default.commonForumList,a="",o=!0,i=!1,r=void 0;try{for(var l,s=n[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var d=l.value,c=d.fid,u=d.name;a+='<span class="btn btn-outline-primary" data-fid="'+c+'">'+u+"</span>"}}catch(e){i=!0,r=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw r}}var f="",m=!0,p=!1,g=void 0;try{for(var h,b=function(){var e=h.value,t=e.fid,a=e.name;return n.find(function(e){return e.fid===t})?"continue":void(f+='<span class="btn btn-outline-primary" data-fid="'+t+'">'+a+"</span>")},v=_const2.default.availableForumList[Symbol.iterator]();!(m=(h=v.next()).done);m=!0){b()}}catch(e){p=!0,g=e}finally{try{!m&&v.return&&v.return()}finally{if(p)throw g}}var y='\n<p class="font-size-sm text-muted">\n  请将可用版块内的版块按钮拖拽到常用版块内（或相反）\n</p>\n<fieldset class="fieldset mb-3 py-2">\n  <legend>常用版块</legend>\n  <div class="edit-forum-list d-flex flex-wrap" id="editCommonForumList">'+a+'</div>\n</fieldset>\n<fieldset class="fieldset mb-3 py-2">\n  <legend>可用版块</legend>\n  <div class="edit-forum-list d-flex flex-wrap" id="editAvailableForumList">'+f+"</div>\n</fieldset>",k='\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>\n<button class="btn btn-danger" name="reset" type="button">重置</button>',w=Dialog.create(t,"编辑常用版块",y,k),C=$('[name="dragulaScriptPath"]'),x=C.val();x?($.getScript(x,function(){return dragula(w.find(".edit-forum-list").get(),{revertOnSpill:!0})}),C.val("")):dragula(w.find(".edit-forum-list").get(),{revertOnSpill:!0}),w.submit(function(e){e.preventDefault(),Config.commonForumList=[],$("#editCommonForumList").children(".btn").each(function(){var e=$(this),t=parseInt(e.data("fid")),n=e.text().trim();t&&n&&Config.commonForumList.push({fid:t,name:n})}),(0,_config.write)(),alert("设置已保存"),Dialog.close(t),location.reload()}).find('[name="reset"]').click(function(){confirm("是否重置？")&&(Config.commonForumList=[],(0,_config.write)(),alert("设置已重置"),Dialog.close(t),location.reload())}),Dialog.show(t)}})},fillCommonForumPanel=exports.fillCommonForumPanel=function(){var e=Config.commonForumList.length>0?Config.commonForumList:_const2.default.commonForumList,t="",n=!0,a=!1,o=void 0;try{for(var i,r=e.entries()[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=_slicedToArray(i.value,2),s=l[0],d=l[1],c=d.fid,u=d.name;0!==s&&s%3!==0||(t+='<div class="row mb-3">'),t+='\n<div class="col-4">\n  <a class="btn btn-outline-primary btn-block" href="'+Util.makeUrl("thread")+"/"+c+'">'+u+"</a>\n</div>",s!==e.length-1&&s%3!==2||(t+="</div>")}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}$(".common-forum-panel").html(t)},preventCloseWindow=exports.preventCloseWindow=function(){window.addEventListener("beforeunload",function(e){if($(".mask").length>0){var t="正在进行操作中，确定要关闭页面吗？";return e.returnValue=t,t}})},showCommonImportOrExportConfigDialog=exports.showCommonImportOrExportConfigDialog=function(e,t,n,a){var o="pdCommonImOrExConfigDialog";if(!($("#"+o).length>0)){(0,_config.read)();var i='\n<p class="font-size-sm">\n  <b>导入设置：</b>将设置内容粘贴到文本框中并点击保存按钮即可<br>\n  <b>导出设置：</b>复制文本框里的内容并粘贴到别处即可\n</p>\n<div class="form-group">\n  <textarea class="form-control" name="commonConfig" rows="10" aria-label="设置内容" style="word-break: break-all;"></textarea>\n</div>',r='\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',l=Dialog.create(o,"导入或导出"+e,i,r);l.submit(function(e){if(e.preventDefault(),confirm("是否导入文本框中的设置？")){var n=$.trim(l.find('[name="commonConfig"]').val());if(n){try{n=JSON.parse(n)}catch(e){return void alert("设置有错误")}if(!n||$.type(n)!==$.type(Config[t]))return void alert("设置有错误");Config[t]=n,(0,_config.write)(),alert("设置已导入"),Dialog.close(o),"function"==typeof a?a():location.reload()}}}),Dialog.show(o),l.find('[name="commonConfig"]').val(JSON.stringify(Config[t])).select().focus(),"function"==typeof n&&n(l)}},followUsers=exports.followUsers=function(){Config.followUserList.length&&("indexPage"===pageId&&Config.highlightFollowUserThreadInHPEnabled?$(".thread-link").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("author"),Config.followUserList)>-1&&e.addClass("text-danger")}):"threadPage"===pageId?$(".thread-link").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("author"),Config.followUserList)>-1&&(e.closest(".thread-list-item").find(".thread-item-footer a:first").addClass("text-danger"),Config.highlightFollowUserThreadLinkEnabled&&e.addClass("text-danger"))}):"readPage"===pageId?$(".read-floor").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("username"),Config.followUserList)>-1&&e.find(".floor-num").addClass("text-danger")}):"gjcPage"!==pageId&&"sharePage"!==pageId&&"searchPage"!==pageId||$(".thread-list-group").find("a[data-author]").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("author"),Config.followUserList)>-1&&e.addClass("text-danger")}))},blockUsers=exports.blockUsers=function(){if(Config.blockUserList.length){var e=0;if("indexPage"===pageId)$(".thread-link").each(function(){var t=$(this),n=Util.inFollowOrBlockUserList(t.data("author"),Config.blockUserList);n>-1&&Config.blockUserList[n].type<=1&&(e++,t.closest(".thread-link-group").remove())});else if("threadPage"===pageId){if(1===Config.blockUserForumType&&!Config.blockUserFidList.includes(Info.fid))return;if(2===Config.blockUserForumType&&Config.blockUserFidList.includes(Info.fid))return;$(".thread-link").each(function(){var t=$(this),n=Util.inFollowOrBlockUserList(t.data("author"),Config.blockUserList);n>-1&&Config.blockUserList[n].type<=1&&(e++,t.closest(".thread-list-item").remove())})}else if("readPage"===pageId){if(1===Config.blockUserForumType&&!Config.blockUserFidList.includes(Info.fid))return;if(2===Config.blockUserForumType&&Config.blockUserFidList.includes(Info.fid))return;$(".read-floor").each(function(){var t=$(this),n=Util.inFollowOrBlockUserList(t.data("username"),Config.blockUserList);if(n>-1){var a=parseInt(t.data("floor"));if(2===Config.blockUserList[n].type&&0===a)return;if(1===Config.blockUserList[n].type&&a>0)return;e++,t.closest(".read-floor").remove()}}),$(".read-content").find(".blockquote > p").each(function(){var e=$(this),t=e.text().trim(),n=!0,a=!1,o=void 0;try{for(var i,r=Config.blockUserList[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;if(1!==l.type)try{var s=new RegExp("^引用(第\\d+楼|楼主)"+l.name+"于","i"),d=new RegExp("^回\\s*\\d+楼\\("+l.name+"\\)\\s*的帖子","i");(s.test(t)||d.test(t))&&e.html('<mark class="help" data-toggle="tooltip" title="被屏蔽用户：'+l.name+'">该用户已被屏蔽</mark>')}catch(e){}}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}})}else"gjcPage"===pageId&&Config.blockUserAtTipsEnabled&&$(".thread-list-group").find("a[data-author]").each(function(){var t=$(this);Util.inFollowOrBlockUserList(t.data("author"),Config.blockUserList)>-1&&(e++,t.closest(".thread-list-item").remove())});e>0&&console.log("【屏蔽用户】共有"+e+"个主题或回复被屏蔽")}},blockThread=exports.blockThread=function blockThread(){if(Config.blockThreadList.length){var isBlock=function isBlock(title,userName){var fid=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,_iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _iterator5=Config.blockThreadList[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){var _step5$value=_step5.value,keyWord=_step5$value.keyWord,includeUser=_step5$value.includeUser,excludeUser=_step5$value.excludeUser,includeFid=_step5$value.includeFid,excludeFid=_step5$value.excludeFid,regex=null;if(/^\/.+\/[gimuy]*$/.test(keyWord))try{regex=eval(keyWord)}catch(e){console.log(e);continue}if(userName)if(includeUser){if(!includeUser.includes(userName))continue}else if(excludeUser&&excludeUser.includes(userName))continue;if(fid)if(includeFid){if(!includeFid.includes(fid))continue}else if(excludeFid&&excludeFid.includes(fid))continue;if(regex){if(regex.test(title))return!0}else if(title.toLowerCase().includes(keyWord.toLowerCase()))return!0}}catch(e){_didIteratorError5=!0,_iteratorError5=e}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}return!1},num=0;if("indexPage"===pageId)$(".thread-link").each(function(){var e=$(this);isBlock(e.text().trim(),e.data("author"))&&(num++,e.closest(".thread-link-group").remove())});else if("threadPage"===pageId)$(".thread-link").each(function(){var e=$(this);isBlock(e.text().trim(),e.data("author"),Info.fid)&&(num++,e.closest(".thread-list-item").remove())});else if("readPage"===pageId){if(1!==Info.currentPageNum)return;var $topFloor=$('.read-floor[data-floor="0"]');if(!$topFloor.length)return;isBlock($(".thread-title").text().trim(),$topFloor.data("username"),Info.fid)&&(num++,$topFloor.remove())}num>0&&console.log("【屏蔽主题】共有"+num+"个主题被屏蔽")}}},{"./config":12,"./configDialog":13,"./const":14,"./dialog":15,"./util":22}],10:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.addUserMemo=n.bindMultiQuoteCheckClick=n.handleCopyCodeBtn=n.handleTuiThreadBtn=n.handleFastGotoFloorBtn=n.gotoFloor=n.handleFloorImage=n.copyBuyThreadList=n.handleBuyThreadBtn=n.handleBlockFloorBtn=n.handleFastReplyBtn=n.handleCopyFloorLinkBtn=void 0;var i=e("./util"),r=o(i),l=e("./const"),s=a(l),d=(e("./config"),e("./msg")),c=o(d),u=(n.handleCopyFloorLinkBtn=function(){$(document).on("click",".floor-num",function(e){e.preventDefault();var t=$(this),n=r.getHostNameUrl()+t.attr("href");t.data("copy-text",n),r.copyText(t,t)||prompt("本楼的跳转链接：",n)})},n.handleFastReplyBtn=function(){$(document).on("click",".fast-reply-btn",function(){var e=$(this).closest("article"),t=e.data("floor"),n=e.data("username");$("#postGjc").val(n);var a=$("#postContent").get(0);a.value="[quote]回 "+t+"楼("+n+") 的帖子[/quote]\n",a.selectionStart=a.value.length,a.selectionEnd=a.value.length,a.focus()})},n.handleBlockFloorBtn=function(){$(document).on("click",".block-floor",function(){return confirm("确认要屏蔽该回帖？本操作不可恢复！（屏蔽后该回帖将对大家不可见）")})},n.handleBuyThreadBtn=function(){$(document).on("click",".buy-thread-btn",function(e){e.preventDefault();var t=$(this),n=t.data("pid"),a=t.data("price");if(!(a>5)||confirm("此贴售价"+a+"KFB，是否购买？")){var o=c.wait("正在购买帖子&hellip;");$.get(r.makeUrl("job/buytopic","tid="+Info.tid+"&pid="+n+"&verify="+Info.verify),function(e){var t=e.msg;c.remove(o),"操作完成"===t?location.reload():t.includes("您已经购买此帖")?(alert("你已经购买过此帖"),location.reload()):alert("帖子购买失败")})}})},n.copyBuyThreadList=function(){$(document).on("change",".buy-thread-list",function(){var e=$(this);if("copyList"===e.val()){var t=e.find("option").map(function(e){var t=$(this).text();return 0===e||1===e||t.includes("-".repeat(11))?null:t}).get().join("\n");if(e.get(0).selectedIndex=0,!t)return void alert("暂时无人购买");var n=$('\n<div class="modal fade" id="buyThreadListDialog" tabindex="-1" role="dialog" aria-labelledby="buyThreadListDialogTitle"\n     aria-hidden="true">\n  <div class="modal-dialog modal-sm" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="buyThreadListDialogTitle">购买人名单</h5>\n        <button class="close" data-dismiss="modal" type="button" aria-label="关闭">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <div class="form-group">\n          <textarea class="form-control" name="buyThreadListContent" rows="14" aria-label="购买人名单">'+t+"</textarea>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n").appendTo("body");n.on("shown.bs.modal",function(){n.find('[name="buyThreadListContent"]').select().focus()}).on("hidden.bs.modal",function(){n.remove()}).modal("show")}})},n.handleFloorImage=function(){$(document).on("click",".img",function(){var e=$(this);e.parent().is("a")||this.naturalWidth<=e.closest(".read-content").width()||(location.href=e.attr("src"))})},n.gotoFloor=function(){if(Info.floor&&Info.floor>0){var e=$('article[data-floor="'+Info.floor+'"]').prev("a").attr("name");e&&(location.hash="#"+e)}},n.handleFastGotoFloorBtn=function(){$(".fast-goto-floor").click(function(e){e.preventDefault();var t=$(this).data("url");if(t){var n=parseInt(prompt("你要跳转到哪一层楼？"));!n||n<=0||(location.href=r.makeUrl(t,"page="+(Math.floor(n/Config.perPageFloorNum)+1)+"&floor="+n))}})},n.handleTuiThreadBtn=function(){$(".tui-btn").click(function(e){e.preventDefault();var t=$(this);t.data("wait")||(t.data("wait",!0),$.ajax({type:"POST",url:"/diy_read_tui.php",data:"tid="+Info.tid+"&safeid="+Info.safeId,success:function(e){var n=/<span.+?\+\d+!<\/span>\s*(\d+)/i.exec(e);n?!function(){var e=t.find("span:first");e.text("+1"),setTimeout(function(){e.text(n[1])},1e3)}():/已推过/.test(e)?alert("已推过"):alert("操作失败")},error:function(){alert("操作失败")},complete:function(){t.removeData("wait")}}))})},n.handleCopyCodeBtn=function(){$(document).on("click",".copy-code",function(e){e.preventDefault();var t=$(this);if(!r.copyText(t.next("pre"),t)){var n=t.data("code");if(n)t.text("复制代码").removeData("code"),t.next("textarea").remove(),t.after('<pre class="pre-scrollable">'+n+"</pre>");else{var a=t.next("pre"),o=a.html();t.text("还原代码").data("code",o),o=r.decodeHtmlSpecialChar(o);var i=a.height();i<50&&(i=50),i>340&&(i=340),a.remove(),$('<textarea class="form-control code-textarea" style="height: '+i+'px" wrap="off">'+o+"</textarea>").insertAfter(t).select().focus()}}})},function(){var e=[];return $(".multi-quote-check:checked").each(function(){var t=$(this).closest("article");e.push({floor:t.data("floor"),pid:t.data("pid"),userName:t.data("username")})}),e});n.bindMultiQuoteCheckClick=function(){$(document).on("click",".multi-quote-check",function(){var e=localStorage[s.default.multiQuoteStorageName];if(e)try{e=JSON.parse(e),!e||"object"!==$.type(e)||$.isEmptyObject(e)?e=null:"tid"in e&&e.tid===Info.tid&&"object"===$.type(e.quoteList)||(e=null)}catch(t){e=null}else e=null;var t=u();e||(localStorage.removeItem(s.default.multiQuoteStorageName),e={tid:Info.tid,quoteList:{}}),t.length>0?e.quoteList[Info.currentPageNum]=t:delete e.quoteList[Info.currentPageNum],localStorage[s.default.multiQuoteStorageName]=JSON.stringify(e)})},n.addUserMemo=function(){$.isEmptyObject(Config.userMemoList)||$(".read-floor").each(function(){var e=$(this),t=e.data("username"),n=Object.keys(Config.userMemoList).find(function(e){return e===t});n&&e.find(".floor-user").after('<span class="tips font-size-sm" data-toggle="tooltip" title="备注：'+Config.userMemoList[n]+'">[?]</span>')})}},{"./config":12,"./const":14,"./msg":17,"./util":22}],11:[function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=(n.setCookie=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Info.cookiePrefix;document.cookie=""+a+e+"="+encodeURI(t)+(n?";expires="+n.toUTCString():"")+";path=/;"},n.getCookie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Info.cookiePrefix,n=new RegExp("(^| )"+t+e+"=([^;]*)(;|$)"),a=document.cookie.match(n);return a?decodeURI(a[2]):null},n.deleteCookie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Info.cookiePrefix;document.cookie=""+t+e+"=;expires="+i("-1d").toUTCString()+";path=/;"},n.getDate=function(e){var t=new Date,n=/^(-|\+)?(\d+)([a-zA-Z]{1,2})$/.exec(e);if(!n)return null;var a="undefined"==typeof n[1]?0:"+"===n[1]?1:-1,o=a===-1?-parseInt(n[2]):parseInt(n[2]),i=n[3];switch(i){case"Y":t.setFullYear(o);break;case"y":t.setFullYear(0===a?o:t.getFullYear()+o);break;case"M":t.setMonth(0===a?o:t.getMonth()+o);break;case"d":t.setDate(0===a?o:t.getDate()+o);break;case"h":t.setHours(0===a?o:t.getHours()+o);break;case"m":t.setMinutes(0===a?o:t.getMinutes()+o);break;case"s":t.setSeconds(0===a?o:t.getSeconds()+o);break;case"ms":t.setMilliseconds(0===a?o:t.getMilliseconds()+o);break;default:return null}return t}),r=(n.getStrByteLen=function(e){for(var t=0,n=2,a=0;a<e.length;a++)t+=e.charCodeAt(a)<0||e.charCodeAt(a)>255?n:1;return t},n.getHostNameUrl=function(){return location.protocol+"//"+location.host},n.addCode=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=""===n?t.indexOf("]")+1:t.indexOf(n);if("undefined"!=typeof e.selectionStart){var o=e.selectionStart;e.value=e.value.substring(0,o)+t+e.value.substring(e.selectionEnd),e.selectionStart=o+a,e.selectionEnd=o+a+n.length}else e.value+=t},n.getSelText=function(e){return e.value.substring(e.selectionStart,e.selectionEnd)},n.extractQueryStr=function(e){var t=new Map,n=!0,a=!1,i=void 0;try{for(var r,l=e.split("&")[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var s=r.value;if(s){var d=s.split("="),c=o(d,2),u=c[0],f=c[1];t.set(u,"undefined"!=typeof f?f:"")}}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t}),l=n.buildQueryStr=function(e){var t="",n=!0,a=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var s=o(r.value,2),d=s[0],c=s[1];t+=2===Info.urlType?(t?"&":"")+d+"="+c:(t?"/":"")+d+"/"+c}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t},s=(n.makeUrl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i="",s=r(t);if(n){s=new Map([].concat(a(r(Info.urlParam).entries()),a(s.entries())));for(var d in o)s.delete(o[d])}if(e.startsWith("/")||(i=location.pathname.startsWith(Info.baseFile)?Info.baseFile+"/":Info.rootPath),i+=e,s.size>0){var c=l(s);c&&(i+=(2===Info.urlType?"?":"/")+c)}return i},n.getQueryParam=function(e){return r(Info.urlParam).get(e)},n.decodeHtmlSpecialChar=function(e){return e.length?e.replace(/<br\s*\/?>/gi,"\n").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&nbsp;/gi," ").replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&amp;/gi,"&"):""},n.selectAll=function(e){e.prop("checked",!0)},n.selectInverse=function(e){e.each(function(){var e=$(this);e.prop("checked",!e.prop("checked"))})},n.showValidationMsg=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";"error"===t&&(t="danger"),e.removeClass("form-control-success form-control-warning form-control-danger");var a=e.parent();a.removeClass("has-success has-warning has-danger"),$.inArray(t,["success","warning","danger"]>-1)&&e.addClass("form-control-"+t).parent().addClass("has-"+t);var o=a.find(".form-control-feedback");"wait"===t?o.html('<span class="text-muted"><i class="fa fa-spinner fa-spin" aria-hidden="true"></i> '+n+"</span>"):o.text(n)},n.getDifferenceSetOfObject=function(e,t){var n={};return"object"!==$.type(e)||"object"!==$.type(t)?n:($.each(t,function(t,a){t in e&&(s(e[t],a)||(n[t]=a))}),n)},n.deepEqual=function e(t,n){if(t===n)return!0;if($.type(t)!==$.type(n))return!1;if("number"==typeof t&&"number"==typeof n&&isNaN(t)&&isNaN(n))return!0;if($.isArray(t)&&$.isArray(n)||"object"===$.type(t)&&"object"===$.type(n)){if(t.length!==n.length)return!1;for(var a in $.extend($.isArray(t)?[]:{},t,n)){if("undefined"==typeof t[a]||"undefined"==typeof n[a])return!1;if(!e(t[a],n[a]))return!1}return!0}return!1});n.copyText=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!("execCommand"in document&&t.length))return!1;var e=t.data("copy-text");e&&(t=$('<span class="text-hide">'+e+"</span>").insertAfter(t));var a=window.getSelection();a.selectAllChildren(t.get(0));var o=document.execCommand("copy");if(a.removeAllRanges(),e&&t.remove(),o&&n){var i=n.data("copy-msg");n.attr("title",i?i:"已复制").on("hidden.bs.tooltip",function(){$(this).tooltip("dispose")}).tooltip("show")}return o},n.inFollowOrBlockUserList=function(e,t){return t.findIndex(function(t){return t.name&&t.name===e})},n.isOpera=function(){return"undefined"!=typeof window.opera},n.isEdge=function(){return navigator.appVersion&&navigator.appVersion.includes("Edge")}},{}],12:[function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.normalize=n.clear=n.write=n.read=n.init=n.Config=void 0;var o=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=e("./util"),r=a(i),l="kf_config",s=n.Config={activeNewReplyPanel:"#galgameNewReplyPanel",activeTopRecommendPanel:"#galgameTopRecommendPanel",commonForumList:[],showSidebarBtnGroupEnabled:!0,showSidebarRollBtnEnabled:!0,showSidebarMainMenuBtnEnabled:!1,showSidebarForumListBtnEnabled:!0,showSidebarSearchBtnEnabled:!1,showSidebarHomePageBtnEnabled:!0,perPageFloorNum:10,threadContentFontSize:0,userMemoEnabled:!1,userMemoList:{},kfSmileEnhanceExtensionEnabled:!1,defShowMsgDuration:-1,customCssEnabled:!1,customCssContent:"",followUserEnabled:!1,followUserList:[],highlightFollowUserThreadInHPEnabled:!0,highlightFollowUserThreadLinkEnabled:!0,blockUserEnabled:!1,blockUserDefaultType:0,blockUserAtTipsEnabled:!0,blockUserForumType:0,blockUserFidList:[],blockUserList:[],blockThreadEnabled:!1,blockThreadDefForumType:0,blockThreadDefFidList:[],blockThreadList:[]},d=(n.init=function(){window.Config=$.extend(!0,{},s),d()},n.read=function(){var e=localStorage[l];if(e){try{e=JSON.parse(e)}catch(e){return}e&&"object"===$.type(e)&&!$.isEmptyObject(e)&&(e=c(e),window.Config=$.extend(!0,{},s,e))}}),c=(n.write=function(){var e=r.getDifferenceSetOfObject(s,window.Config);localStorage[l]=JSON.stringify(e)},n.clear=function(){localStorage.removeItem(l)},n.normalize=function(e){var t={};if("object"!==$.type(e))return t;var n=!0,a=!1,i=void 0;try{for(var r,l=Object.entries(e)[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var d=o(r.value,2),c=d[0],u=d[1];c in s&&$.type(u)===$.type(s[c])&&(t[c]=u)}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t})},{"./util":22}],13:[function(require,module,exports){"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.show=void 0;var _slicedToArray=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_util=require("./util"),Util=_interopRequireWildcard(_util),_dialog=require("./dialog"),Dialog=_interopRequireWildcard(_dialog),_config=require("./config"),_public=require("./public"),Public=_interopRequireWildcard(_public),show=exports.show=function(){var e="configDialog";if(!($("#"+e).length>0)){(0,_config.read)();var t='\n<fieldset class="fieldset mb-3 py-2">\n  <legend class="form-check">\n    <label class="form-check-label">\n      <input class="form-check-input" name="showSidebarBtnGroupEnabled" type="checkbox"> 显示侧边栏按钮组\n      <span class="tips" data-toggle="tooltip" title="显示侧边栏按钮组，可在下方设置要显示的按钮">[?]</span>\n    </label>\n  </legend>\n  <div class="mb-2 d-sm-inline-block">\n    <div class="form-check form-check-inline">\n      <label class="form-check-label">\n        <input class="form-check-input" name="showSidebarRollBtnEnabled" type="checkbox"> 滚动到页顶/页底\n      </label>\n    </div>\n    <div class="form-check form-check-inline">\n      <label class="form-check-label">\n        <input class="form-check-input" name="showSidebarMainMenuBtnEnabled" type="checkbox"> 主菜单\n      </label>\n    </div>\n  </div>\n  <div class="mb-2 d-sm-inline-block ml-sm-3">\n    <div class="form-check form-check-inline">\n      <label class="form-check-label">\n        <input class="form-check-input" name="showSidebarForumListBtnEnabled" type="checkbox"> 版块列表\n      </label>\n    </div>\n    <div class="form-check form-check-inline">\n      <label class="form-check-label">\n        <input class="form-check-input" name="showSidebarSearchBtnEnabled" type="checkbox"> 搜索\n      </label>\n    </div>\n    <div class="form-check form-check-inline">\n      <label class="form-check-label">\n        <input class="form-check-input" name="showSidebarHomePageBtnEnabled" type="checkbox"> 首页\n      </label>\n    </div>\n  </div>\n</fieldset>\n\n<fieldset class="fieldset mb-3 py-2">\n  <legend>主题页面相关</legend>\n  <div class="form-group mb-2">\n    <label for="perPageFloorNum">主题每页楼层数量</label>\n    <select class="custom-select custom-select-sm" id="perPageFloorNum" name="perPageFloorNum">\n      <option value="10">10</option><option value="20">20</option><option value="30">30</option>\n    </select>\n    <span class="tips" data-toggle="tooltip" title="主题页面中每页的楼层数量（用于电梯直达等功能），如果修改了论坛设置里的“文章列表每页个数”，请在此修改成相同的数目">[?]</span>\n  </div>\n  <div class="input-group mb-2">\n    <span class="input-group-addon">主题内容字体大小</span>\n    <input class="form-control" name="threadContentFontSize" data-toggle="tooltip" type="number" min="8" max="72"\n           title="主题内容字体大小，留空表示使用默认大小，默认值：14px">\n    <span class="input-group-addon">px</span>\n  </div>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input class="form-check-input" name="userMemoEnabled" type="checkbox" data-disabled="[data-name=openUserMemoDialog]"> 显示用户备注\n    </label>\n    <span class="tips" data-toggle="tooltip" title="在楼层内的用户名旁显示该用户的自定义备注">[?]</span>\n    <a class="ml-3" data-name="openUserMemoDialog" href="#" role="button">详细设置&raquo;</a>\n  </div>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input class="form-check-input" name="kfSmileEnhanceExtensionEnabled" type="checkbox"> 开启绯月表情增强插件\n    </label>\n    <span class="tips" data-toggle="tooltip" title="在发帖框上显示绯月表情增强插件，该插件由eddie32开发">[?]</span>\n  </div>\n</fieldset>\n\n<fieldset class="fieldset mb-3 py-2">\n  <legend>其它设置</legend>\n  <div class="input-group mb-2">\n    <span class="input-group-addon">消息显示时间</span>\n    <input class="form-control" name="defShowMsgDuration" data-toggle="tooltip" type="number" min="-1" required\n           title="默认的消息显示时间（秒），设置为-1表示永久显示，例：15">\n    <span class="input-group-addon">秒</span>\n  </div>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input class="form-check-input" name="customCssEnabled" type="checkbox" data-disabled="[data-name=openCustomCssDialog]"> 添加自定义CSS\n    </label>\n    <span class="tips" data-toggle="tooltip" title="为页面添加自定义的CSS内容，请点击详细设置填写自定义的CSS内容">[?]</span>\n    <a class="ml-3" data-name="openCustomCssDialog" href="#" role="button">详细设置&raquo;</a>\n  </div>\n</fieldset>\n\n<fieldset class="fieldset mb-3 py-2">\n  <legend>关注和屏蔽</legend>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input class="form-check-input" name="followUserEnabled" type="checkbox" data-disabled="[data-name=openFollowUserDialog]"> 关注用户\n    </label>\n    <span class="tips" data-toggle="tooltip" title="开启关注用户的功能，所关注的用户将被加注记号，请点击详细设置管理关注用户">[?]</span>\n    <a class="ml-3" data-name="openFollowUserDialog" href="#" role="button">详细设置&raquo;</a>\n  </div>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input class="form-check-input" name="blockUserEnabled" type="checkbox" data-disabled="[data-name=openBlockUserDialog]"> 屏蔽用户\n    </label>\n    <span class="tips" data-toggle="tooltip" title="开启屏蔽用户的功能，你将看不见所屏蔽用户的发言，请点击详细设置管理屏蔽用户">[?]</span>\n    <a class="ml-3" data-name="openBlockUserDialog" href="#" role="button">详细设置&raquo;</a>\n  </div>\n  <div class="form-check">\n    <label class="form-check-label">\n      <input class="form-check-input" name="blockThreadEnabled" type="checkbox" data-disabled="[data-name=openBlockThreadDialog]"> 屏蔽主题\n    </label>\n    <span class="tips" data-toggle="tooltip" title="开启屏蔽标题中包含指定关键字的主题的功能，请点击详细设置管理屏蔽关键字">[?]</span>\n    <a class="ml-3" data-name="openBlockThreadDialog" href="#" role="button">详细设置&raquo;</a>\n  </div>\n</fieldset>',n='\n<button class="btn btn-warning mr-auto" name="openImportOrExportSettingDialog" type="button">导入/导出</button>\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>\n<button class="btn btn-danger" name="reset" type="button">重置</button>',a=Dialog.create(e,"助手设置",t,n);
a.submit(function(t){t.preventDefault(),(0,_config.read)();var n=getMainConfigValue(a);n=(0,_config.normalize)(n),$.extend(Config,n),(0,_config.write)(),Dialog.close(e)}).on("click",'a[data-name^="open"][href="#"]',function(e){e.preventDefault();var t=$(this);if(!t.hasClass("disabled-link")){var n=t.data("name");"openUserMemoDialog"===n?showUserMemoDialog():"openCustomCssDialog"===n?showCustomCssDialog():"openFollowUserDialog"===n?showFollowUserDialog():"openBlockUserDialog"===n?showBlockUserDialog():"openBlockThreadDialog"===n&&showBlockThreadDialog()}}).find('[name="reset"]').click(function(){confirm("是否重置所有设置？")&&((0,_config.clear)(),alert("设置已重置"),Dialog.close(e),location.reload())}).end().find('[name="openImportOrExportSettingDialog"]').click(showImportOrExportSettingDialog),setMainConfigValue(a),Dialog.show(e)}},setMainConfigValue=function(e){e.find("input[name], select[name]").each(function(){var e=$(this),t=e.attr("name");t in Config&&(e.is('[type="checkbox"]')&&"boolean"==typeof Config[t]?e.prop("checked",Config[t]===!0):e.val(Config[t]))}),e.find('[name="threadContentFontSize"]').val(Config.threadContentFontSize>0?Config.threadContentFontSize:"")},getMainConfigValue=function(e){var t={};return e.find("input[name], select[name]").each(function(){var e=$(this),n=e.attr("name");n in Config&&(e.is('[type="checkbox"]')&&"boolean"==typeof Config[n]?t[n]=Boolean(e.prop("checked")):"number"==typeof Config[n]?(t[n]=parseInt(e.val()),"threadContentFontSize"===n&&isNaN(t[n])&&(t[n]=0)):t[n]=$.trim(e.val()))}),t},showImportOrExportSettingDialog=function(){var e="imOrExSettingDialog";if(!($("#"+e).length>0)){(0,_config.read)();var t='\n<p class="font-size-sm">\n  <b>导入设置：</b>将设置内容粘贴到文本框中并点击保存按钮即可<br>\n  <b>导出设置：</b>复制文本框里的内容并粘贴到别处即可<br>\n  <span class="text-danger">注：本设置与电脑版的KFOL助手并不完全通用</span>\n</p>\n<div class="form-group">\n  <textarea class="form-control" name="setting" rows="10" aria-label="设置内容" style="word-break: break-all;"></textarea>\n</div>',n='\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',a=Dialog.create(e,"导入或导出设置",t,n);a.submit(function(e){if(e.preventDefault(),confirm("是否导入文本框中的设置？")){var t=$.trim(a.find('[name="setting"]').val());if(t){try{t=JSON.parse(t)}catch(e){return void alert("设置有错误")}if(!t||"object"!==$.type(t))return void alert("设置有错误");t=(0,_config.normalize)(t),window.Config=$.extend(!0,{},_config.Config,t),(0,_config.write)(),alert("设置已导入"),location.reload()}}}),Dialog.show(e),a.find('[name="setting"]').val(JSON.stringify(Util.getDifferenceSetOfObject(_config.Config,Config))).select().focus()}},showUserMemoDialog=function(){var e="userMemoDialog";if(!($("#"+e).length>0)){(0,_config.read)();var t='\n<p class="font-size-sm">按照<code>用户名:备注</code>的格式（注意是英文冒号），每行一个</p>\n<div class="form-group">\n  <textarea class="form-control" name="userMemoList" rows="13" wrap="off" aria-label="用户备注" style="white-space: pre;"></textarea>\n</div>',n='\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',a=Dialog.create(e,"用户备注",t,n),o=a.find('[name="userMemoList"]');a.submit(function(t){t.preventDefault();var n=$.trim(o.val());Config.userMemoList={};var a=!0,i=!1,r=void 0;try{for(var l,s=n.split("\n")[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var d=l.value;if(d=$.trim(d)){if(!/.+?:.+/.test(d))return alert("格式不正确"),void o.focus();var c=d.split(":"),u=_slicedToArray(c,2),f=u[0],m=u[1],p=void 0===m?"":m;p&&(Config.userMemoList[f.trim()]=p.trim())}}}catch(e){i=!0,r=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}(0,_config.write)(),Dialog.close(e)});var i="",r=!0,l=!1,s=void 0;try{for(var d,c=Object.entries(Config.userMemoList)[Symbol.iterator]();!(r=(d=c.next()).done);r=!0){var u=_slicedToArray(d.value,2),f=u[0],m=u[1];i+=f+":"+m+"\n"}}catch(e){l=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}Dialog.show(e),o.val(i).focus()}},showCustomCssDialog=function(){var e="customCssDialog";if(!($("#"+e).length>0)){(0,_config.read)();var t='\n<div class="form-group">\n  <textarea class="form-control" name="customCssContent" rows="15" wrap="off" aria-label="自定义CSS内容" style="white-space: pre;"></textarea>\n</div>',n='\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',a=Dialog.create(e,"自定义CSS",t,n),o=a.find('[name="customCssContent"]');a.submit(function(t){t.preventDefault(),Config.customCssContent=$.trim(o.val()),(0,_config.write)(),Dialog.close(e),alert("自定义CSS修改成功（需刷新页面后才可生效）")}),Dialog.show(e),o.val(Config.customCssContent).focus()}},showFollowUserDialog=function(){var e="followUserDialog";if(!($("#"+e).length>0)){var t='\n<div class="form-check">\n  <label class="form-check-label">\n    <input class="form-check-input" name="highlightFollowUserThreadInHpEnabled" type="checkbox"> 高亮所关注用户的首页主题链接\n    <span class="tips" data-toggle="tooltip" title="高亮所关注用户在首页下的主题链接">[?]</span>\n  </label>\n</div>\n<div class="form-check mb-3">\n  <label class="form-check-label">\n    <input class="form-check-input" name="highlightFollowUserThreadLinkEnabled" type="checkbox"> 高亮所关注用户的主题链接\n    <span class="tips" data-toggle="tooltip" title="高亮所关注用户在版块页面下的主题链接">[?]</span>\n  </label>\n</div>\n<ul class="list-unstyled" id="followUserList"></ul>\n<div class="btn-group btn-group-sm mb-3" role="group">\n  <button class="btn btn-secondary" name="selectAll" type="button">全选</button>\n  <button class="btn btn-secondary" name="selectInverse" type="button">反选</button>\n  <button class="btn btn-danger" name="deleteSelect" type="button">删除</button>\n</div>\n<div class="input-group mb-3">\n  <input class="form-control" name="addUser" data-toggle="tooltip" type="text" title="添加多个用户请用英文逗号分隔" aria-label="添加关注用户">\n  <span class="input-group-btn">\n    <button class="btn btn-success" name="add" type="button">添加</button>\n  </span>\n</div>\n',n='\n<button class="btn btn-warning mr-auto" name="openImOrExFollowUserListDialog" type="button">导入/导出</button>\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',a=Dialog.create(e,"关注用户",t,n),o=a.find("#followUserList"),i=function(e){$('\n<li class="input-group input-group-sm mb-2">\n  <span class="input-group-addon">\n    <input type="checkbox" aria-label="选择用户">\n  </span>\n  <input class="form-control" name="userName" type="text" value="'+e+'" maxlength="12" aria-label="编辑关注用户">\n  <span class="input-group-btn">\n    <button class="btn btn-danger" name="delete" type="button" aria-label="删除关注用户">\n      <i class="fa fa-trash" aria-hidden="true"></i>\n    </button>\n  </span>\n</li>\n').appendTo(o)};a.submit(function(t){t.preventDefault(),Config.highlightFollowUserThreadInHPEnabled=a.find('[name="highlightFollowUserThreadInHpEnabled"]').prop("checked"),Config.highlightFollowUserThreadLinkEnabled=a.find('[name="highlightFollowUserThreadLinkEnabled"]').prop("checked"),Config.followUserList=[],o.find("li").each(function(){var e=$(this),t=$.trim(e.find('[name="userName"]').val());""!==t&&Util.inFollowOrBlockUserList(t,Config.followUserList)===-1&&Config.followUserList.push({name:t})}),(0,_config.write)(),Dialog.close(e)}).find('[name="deleteSelect"]').click(function(){var e=o.find('li:has([type="checkbox"]:checked)');e.length&&confirm("是否删除所选用户？")&&e.remove()}).end().find('[name="addUser"]').keydown(function(e){13===e.keyCode&&(e.preventDefault(),$(this).next().find("button").click())}).end().find('[name="add"]').click(function(){var e=a.find('[name="addUser"]'),t=!0,n=!1,r=void 0;try{for(var l,s=$.trim(e.val()).split(",")[Symbol.iterator]();!(t=(l=s.next()).done);t=!0){var d=l.value;d=$.trim(d),d&&Util.inFollowOrBlockUserList(d,Config.followUserList)===-1&&i(d)}}catch(e){n=!0,r=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw r}}e.val(""),o.find('li:last-child [type="checkbox"]').focus()}).end().find('[name="openImOrExFollowUserListDialog"]').click(function(e){e.preventDefault(),Public.showCommonImportOrExportConfigDialog("关注用户","followUserList")}).end().find('[name="selectAll"]').click(function(){return Util.selectAll(o.find('[type="checkbox"]'))}).end().find('[name="selectInverse"]').click(function(){return Util.selectInverse(o.find('[type="checkbox"]'))}),o.on("click",'[name="delete"]',function(){$(this).closest("li").remove()}),a.find('[name="highlightFollowUserThreadInHpEnabled"]').prop("checked",Config.highlightFollowUserThreadInHPEnabled),a.find('[name="highlightFollowUserThreadLinkEnabled"]').prop("checked",Config.highlightFollowUserThreadLinkEnabled);var r=!0,l=!1,s=void 0;try{for(var d,c=Config.followUserList[Symbol.iterator]();!(r=(d=c.next()).done);r=!0){var u=d.value;i(u.name)}}catch(e){l=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}Dialog.show(e)}},showBlockUserDialog=function(){var e="blockUserDialog";if(!($("#"+e).length>0)){var t='\n<div class="form-group mb-2">\n  <label for="blockUserDefaultType">默认屏蔽类型</label>\n  <select class="custom-select custom-select-sm" id="blockUserDefaultType" name="blockUserDefaultType">\n    <option value="0">主题和回帖</option><option value="1">主题</option><option value="2">回帖</option>\n  </select>\n  <div class="form-check form-check-inline ml-3">\n    <label class="form-check-label">\n      <input class="form-check-input" name="blockUserAtTipsEnabled" type="checkbox"> 屏蔽@提醒\n      <span class="tips" data-toggle="tooltip" title="屏蔽被屏蔽用户的@提醒">[?]</span>\n    </label>\n  </div>\n</div>\n<div class="form-group mb-2">\n  <label for="blockUserForumType">版块屏蔽范围</label>\n  <select class="custom-select custom-select-sm" id="blockUserForumType" name="blockUserForumType">\n    <option value="0">所有版块</option><option value="1">包括指定版块</option><option value="2">排除指定版块</option>\n  </select>\n</div>\n<div class="form-group">\n  <label>版块ID列表</label>\n  <span class="tips" data-toggle="tooltip" title="版块URL中的fid参数，多个ID请用英文逗号分隔">[?]</span>\n  <input class="form-control form-control-sm" name="blockUserFidList" type="text">\n</div>\n<ul class="list-unstyled" id="blockUserList"></ul>\n<div class="btn-group btn-group-sm mb-3" role="group">\n  <button class="btn btn-secondary" name="selectAll" type="button">全选</button>\n  <button class="btn btn-secondary" name="selectInverse" type="button">反选</button>\n  <div class="btn-group btn-group-sm dropup">\n    <button class="btn btn-info dropdown-toggle" data-toggle="dropdown" type="button" aria-haspopup="true" aria-expanded="false">\n      修改为\n    </button>\n    <div class="dropdown-menu" data-name="modifyMenu">\n      <a class="dropdown-item" data-value="0" href="#">主题和回帖</a>\n      <a class="dropdown-item" data-value="1" href="#">主题</a>\n      <a class="dropdown-item" data-value="2" href="#">回帖</a>\n    </div>\n  </div>\n  <button class="btn btn-danger" name="deleteSelect" type="button">删除</button>\n</div>\n<div class="input-group mb-3">\n  <input class="form-control" name="addUser" data-toggle="tooltip" type="text" title="添加多个用户请用英文逗号分隔" aria-label="添加屏蔽用户">\n  <span class="input-group-btn">\n    <button class="btn btn-success" name="add" type="button">添加</button>\n  </span>\n</div>',n='\n<button class="btn btn-warning mr-auto" name="openImOrExBlockUserListDialog" type="button">导入/导出</button>\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',a=Dialog.create(e,"屏蔽用户",t,n),o=a.find("#blockUserList"),i=function(e,t){$('\n<li class="form-group row no-gutters mb-2">\n  <div class="col-7 input-group input-group-sm">\n    <span class="input-group-addon">\n      <input type="checkbox" aria-label="选择用户">\n    </span>\n    <input class="form-control" name="userName" type="text" value="'+e+'" maxlength="12" aria-label="编辑屏蔽用户">\n  </div>\n  <div class="col-5 input-group input-group-sm">\n    <select class="form-control" name="blockType">\n      <option value="0">主题和回帖</option><option value="1">主题</option><option value="2">回帖</option>\n    </select>\n    <span class="input-group-btn">\n      <button class="btn btn-danger" name="delete" type="button" aria-label="删除屏蔽用户">\n        <i class="fa fa-trash" aria-hidden="true"></i>\n      </button>\n    </span>\n  </div>\n</li>\n').appendTo(o).find('[name="blockType"]').val(t)};a.submit(function(t){t.preventDefault(),Config.blockUserDefaultType=parseInt(a.find('[name="blockUserDefaultType"]').val()),Config.blockUserAtTipsEnabled=a.find('[name="blockUserAtTipsEnabled"]').prop("checked"),Config.blockUserForumType=parseInt(a.find('[name="blockUserForumType"]').val());var n=new Set,i=!0,r=!1,l=void 0;try{for(var s,d=$.trim(a.find('[name="blockUserFidList"]').val()).split(",")[Symbol.iterator]();!(i=(s=d.next()).done);i=!0){var c=s.value;c=parseInt(c),!isNaN(c)&&c>0&&n.add(c)}}catch(e){r=!0,l=e}finally{try{!i&&d.return&&d.return()}finally{if(r)throw l}}Config.blockUserFidList=[].concat(_toConsumableArray(n)),Config.blockUserList=[],o.find("li").each(function(){var e=$(this),t=$.trim(e.find('[name="userName"]').val());if(t&&Util.inFollowOrBlockUserList(t,Config.blockUserList)===-1){var n=parseInt(e.find('[name="blockType"]').val());Config.blockUserList.push({name:t,type:n})}}),(0,_config.write)(),Dialog.close(e)}).find('[data-name="modifyMenu"]').on("click","a",function(e){e.preventDefault();var t=parseInt($(this).data("value"));o.find('li:has([type="checkbox"]:checked) select').val(t)}).end().find('[name="deleteSelect"]').click(function(){var e=o.find('li:has([type="checkbox"]:checked)');e.length&&confirm("是否删除所选用户？")&&e.remove()}).end().find('[name="addUser"]').keydown(function(e){13===e.keyCode&&(e.preventDefault(),$(this).next().find("button").click())}).end().find('[name="add"]').click(function(){var e=a.find('[name="addUser"]'),t=parseInt(a.find('[name="blockUserDefaultType"]').val()),n=!0,r=!1,l=void 0;try{for(var s,d=$.trim(e.val()).split(",")[Symbol.iterator]();!(n=(s=d.next()).done);n=!0){var c=s.value;c=$.trim(c),c&&Util.inFollowOrBlockUserList(c,Config.blockUserList)===-1&&i(c,t)}}catch(e){r=!0,l=e}finally{try{!n&&d.return&&d.return()}finally{if(r)throw l}}e.val(""),o.find('li:last-child [type="checkbox"]').focus()}).end().find('[name="blockUserForumType"]').change(function(){a.find('[name="blockUserFidList"]').prop("disabled",0===parseInt($(this).val()))}).end().find('[name="openImOrExBlockUserListDialog"]').click(function(e){e.preventDefault(),Public.showCommonImportOrExportConfigDialog("屏蔽用户","blockUserList")}).end().find('[name="selectAll"]').click(function(){return Util.selectAll(o.find('[type="checkbox"]'))}).end().find('[name="selectInverse"]').click(function(){return Util.selectInverse(o.find('[type="checkbox"]'))}),o.on("click",'[name="delete"]',function(){$(this).closest("li").remove()}),a.find('[name="blockUserDefaultType"]').val(Config.blockUserDefaultType),a.find('[name="blockUserAtTipsEnabled"]').prop("checked",Config.blockUserAtTipsEnabled),a.find('[name="blockUserForumType"]').val(Config.blockUserForumType).triggerHandler("change"),a.find('[name="blockUserFidList"]').val(Config.blockUserFidList.join(","));var r=!0,l=!1,s=void 0;try{for(var d,c=Config.blockUserList[Symbol.iterator]();!(r=(d=c.next()).done);r=!0){var u=d.value;i(u.name,u.type)}}catch(e){l=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}Dialog.show(e)}},showBlockThreadDialog=function showBlockThreadDialog(){var dialogName="blockThreadDialog";if(!($("#"+dialogName).length>0)){var bodyContent='\n<p class="font-size-sm">\n  标题关键字可使用普通字符串或正则表达式，正则表达式请使用<code>/abc/</code>的格式，例：<code>/关键字A.*关键字B/i</code><br>\n  用户名和版块ID为可选项（多个用户名或版块ID请用英文逗号分隔）<br>\n</p>\n<div class="form-group mb-2">\n  <label for="blockThreadDefForumType">默认版块屏蔽范围</label>\n  <select class="custom-select custom-select-sm" id="blockThreadDefForumType" name="blockThreadDefForumType">\n    <option value="0">所有版块</option><option value="1">包括指定版块</option><option value="2">排除指定版块</option>\n  </select>\n</div>\n<div class="form-group">\n  <label for="blockThreadDefFidList">默认版块ID列表</label>\n  <input class="form-control form-control-sm" id="blockThreadDefFidList" name="blockThreadDefFidList" type="text">\n</div>\n<div class="table-responsive">\n  <table class="table table-sm table-hover table-center text-nowrap">\n    <thead>\n      <tr>\n        <th>标题关键字(必填)</th>\n        <th>屏蔽用户</th>\n        <th>用户名</th>\n        <th>屏蔽范围</th>\n        <th>版块ID</th>\n        <th></th>\n      </tr>\n    </thead>\n    <tbody id="blockThreadList"></tbody>\n  </table>\n</div>\n<div class="btn-group btn-group-sm mb-3" role="group">\n  <button class="btn btn-success" name="add" type="button">增加</button>\n  <button class="btn btn-danger" name="clear" type="button">清空</button>\n</div>',footerContent='\n<button class="btn btn-warning mr-auto" name="openImOrExBlockThreadListDialog" type="button">导入/导出</button>\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',$dialog=Dialog.create(dialogName,"屏蔽主题",bodyContent,footerContent),$blockThreadList=$dialog.find("#blockThreadList"),addBlockThread=function(e,t,n,a,o){$('\n<tr>\n  <td>\n    <input class="form-control form-control-sm" name="keyWord" type="text" value="'+e+'" aria-label="标题关键字" style="min-width: 12rem;">\n  </td>\n  <td>\n    <select class="form-control form-control-sm" name="userType" aria-label="屏蔽用户类型" style="min-width: 4.5rem;">\n      <option value="0">所有</option><option value="1">包括</option><option value="2">排除</option>\n    </select>\n  </td>\n  <td>\n    <input class="form-control form-control-sm" name="userList" type="text" value="'+n.join(",")+'" aria-label="用户名"\n           '+(0===t?"disabled":"")+' style="min-width: 12rem;">\n  </td>\n  <td>\n    <select class="form-control form-control-sm" name="fidType" aria-label="屏蔽范围" style="min-width: 4.5rem;">\n      <option value="0">所有</option><option value="1">包括</option><option value="2">排除</option>\n    </select>\n  </td>\n  <td>\n    <input class="form-control form-control-sm" name="fidList" type="text" value="'+o.join(",")+'" aria-label="版块ID列表"\n           '+(0===a?"disabled":"")+' style="min-width: 9rem;">\n  </td>\n  <td class="text-left">\n    <button class="btn btn-danger btn-sm" name="delete" type="button" aria-label="删除">\n      <i class="fa fa-trash" aria-hidden="true"></i>\n    </button>\n  </td>\n</tr>\n').appendTo($blockThreadList).find('[name="userType"]').val(t).end().find('[name="fidType"]').val(a)},verify=function verify(){var flag=!0;return $blockThreadList.find("tr").each(function(){var $this=$(this),$txtKeyWord=$this.find('[name="keyWord"]'),keyWord=$txtKeyWord.val();if($.trim(keyWord)&&/^\/.+\/[gimuy]*$/.test(keyWord))try{eval(keyWord)}catch(e){return alert("正则表达式不正确"),$txtKeyWord.select().focus(),flag=!1,!1}}),flag};$dialog.submit(function(e){if(e.preventDefault(),verify()){Config.blockThreadDefForumType=parseInt($dialog.find('[name="blockThreadDefForumType"]').val());var t=new Set,n=!0,a=!1,o=void 0;try{for(var i,r=$.trim($dialog.find('[name="blockThreadDefFidList"]').val()).split(",")[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;l=parseInt(l),!isNaN(l)&&l>0&&t.add(l)}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}Config.blockThreadDefFidList=[].concat(_toConsumableArray(t)),Config.blockThreadList=[],$blockThreadList.find("tr").each(function(){var e=$(this),t=e.find('[name="keyWord"]').val();if($.trim(t)){var n={keyWord:t},a=parseInt(e.find('[name="userType"]').val());if(a>0){var o=new Set,i=!0,r=!1,l=void 0;try{for(var s,d=$.trim(e.find('[name="userList"]').val()).split(",")[Symbol.iterator]();!(i=(s=d.next()).done);i=!0){var c=s.value;c=$.trim(c),c&&o.add(c)}}catch(e){r=!0,l=e}finally{try{!i&&d.return&&d.return()}finally{if(r)throw l}}o.size>0&&(n[2===a?"excludeUser":"includeUser"]=[].concat(_toConsumableArray(o)))}var u=parseInt(e.find('[name="fidType"]').val());if(u>0){var f=new Set,m=!0,p=!1,g=void 0;try{for(var h,b=$.trim(e.find('[name="fidList"]').val()).split(",")[Symbol.iterator]();!(m=(h=b.next()).done);m=!0){var v=h.value;v=parseInt(v),!isNaN(v)&&v>0&&f.add(v)}}catch(e){p=!0,g=e}finally{try{!m&&b.return&&b.return()}finally{if(p)throw g}}f.size>0&&(n[2===u?"excludeFid":"includeFid"]=[].concat(_toConsumableArray(f)))}Config.blockThreadList.push(n)}}),(0,_config.write)(),Dialog.close(dialogName)}}).find('[name="clear"]').click(function(){confirm("是否清除所有屏蔽关键字？")&&$blockThreadList.html("")}).end().find('[name="add"]').click(function(){addBlockThread("",0,[],parseInt($dialog.find('[name="blockThreadDefForumType"]').val()),$.trim($dialog.find('[name="blockThreadDefFidList"]').val()).split(","))}).end().find('[name="blockThreadDefForumType"]').change(function(){$dialog.find('[name="blockThreadDefFidList"]').prop("disabled",0===parseInt($(this).val()))}).end().find('[name="openImOrExBlockThreadListDialog"]').click(function(e){e.preventDefault(),Public.showCommonImportOrExportConfigDialog("屏蔽主题","blockThreadList")}).end().find('[name="selectAll"]').click(function(){return Util.selectAll($blockThreadList.find('[type="checkbox"]'))}).end().find('[name="selectInverse"]').click(function(){return Util.selectInverse($blockThreadList.find('[type="checkbox"]'))}),$blockThreadList.on("change","select",function(){var e=$(this);e.closest("td").next("td").find("input").prop("disabled",0===parseInt(e.val()))}).on("click",'[name="delete"]',function(){$(this).closest("tr").remove()}),$dialog.find('[name="blockThreadDefForumType"]').val(Config.blockThreadDefForumType).triggerHandler("change"),$dialog.find('[name="blockThreadDefFidList"]').val(Config.blockThreadDefFidList.join(","));var _iteratorNormalCompletion11=!0,_didIteratorError11=!1,_iteratorError11=void 0;try{for(var _iterator11=Config.blockThreadList[Symbol.iterator](),_step11;!(_iteratorNormalCompletion11=(_step11=_iterator11.next()).done);_iteratorNormalCompletion11=!0){var data=_step11.value,keyWord=data.keyWord,includeUser=data.includeUser,excludeUser=data.excludeUser,includeFid=data.includeFid,excludeFid=data.excludeFid,userType=0,userList=[];"undefined"!=typeof includeUser?(userType=1,userList=includeUser):"undefined"!=typeof excludeUser&&(userType=2,userList=excludeUser);var fidType=0,fidList=[];"undefined"!=typeof includeFid?(fidType=1,fidList=includeFid):"undefined"!=typeof excludeFid&&(fidType=2,fidList=excludeFid),addBlockThread(keyWord,userType,userList,fidType,fidList)}}catch(e){_didIteratorError11=!0,_iteratorError11=e}finally{try{!_iteratorNormalCompletion11&&_iterator11.return&&_iterator11.return()}finally{if(_didIteratorError11)throw _iteratorError11}}Dialog.show(dialogName)}}},{"./config":12,"./dialog":15,"./public":20,"./util":22}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a={multiQuoteStorageName:"kf_multi_quote",atTipsTimeCookieName:"at_tips_time",prevAtTipsTimeCookieName:"prev_at_tips_time",bgStyleCookieName:"bg_style",commonForumList:[{fid:106,name:"新作动态"},{fid:41,name:"网盘下载"},{fid:16,name:"种子下载"},{fid:52,name:"游戏讨论"},{fid:84,name:"动漫讨论"},{fid:67,name:"CG下载"},{fid:5,name:"自由讨论"},{fid:56,name:"个人日记"},{fid:57,name:"同人漫本"}],availableForumList:[{fid:106,name:"新作动态"},{fid:52,name:"游戏讨论"},{fid:16,name:"种子下载"},{fid:41,name:"网盘下载"},{fid:67,name:"CG下载"},{fid:102,name:"游戏推荐"},{fid:24,name:"疑难互助"},{fid:57,name:"同人漫本"},{fid:84,name:"动漫讨论"},{fid:92,name:"动画共享"},{fid:127,name:"漫画小说"},{fid:68,name:"音乐共享"},{fid:163,name:"LIVE共享"},{fid:182,name:"转载资源"},{fid:94,name:"原创绘画"},{fid:87,name:"宅物交流"},{fid:86,name:"电子产品"},{fid:115,name:"文字作品"},{fid:96,name:"图片来源"},{fid:36,name:"寻求资源"},{fid:5,name:"自由讨论"},{fid:56,name:"个人日记"},{fid:9,name:"我的关注"},{fid:4,name:"意见投诉"},{fid:93,name:"管理组区"},{fid:59,name:"原创组区"},{fid:125,name:"水楼林立"},{fid:181,name:"私人日记"},{fid:42,name:"旧期资料"},{fid:128,name:"作品判定"},{fid:98,name:"日本语版"},{fid:99,name:"意見箱"},{fid:112,name:"掲示板"},{fid:100,name:"創作感想"}]};n.default=a},{}],15:[function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.close=n.resize=n.show=n.create=void 0;var o=e("./util"),i=a(o),r=(n.create=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o='\n<form>\n<div class="dialog" id="'+e+'" tabindex="-1" role="dialog" aria-hidden="true" aria-labelledby="'+e+'Title">\n  <div class="container dialog-content" role="document">\n    <div class="dialog-header">\n      <h5 class="dialog-title" id="'+e+'Title">'+t+'</h5>\n      <button class="close" data-dismiss="dialog" type="button" aria-label="关闭">\n        <span aria-hidden="true">&times;</span>\n      </button>\n    </div>\n    <div class="dialog-body">'+n+'</div>\n    <div class="dialog-footer" '+(a?"":"hidden")+">"+a+"</div>\n  </div>\n</div>\n</form>",s=$(o).appendTo("body");return s.on("click",'[data-dismiss="dialog"]',function(){return l(e)}).on("click",".tips",function(){return!1}).on("click",".disabled-link",function(){return!1}).keydown(function(t){if(27===t.keyCode)return l(e)}).find('legend [type="checkbox"]').click(function(){var e=$(this),t=e.prop("checked");i.isOpera()||i.isEdge()?e.closest("fieldset").find("input, select, textarea, button").not("legend input").prop("disabled",!t):e.closest("fieldset").prop("disabled",!t)}).end().find("input[data-disabled]").click(function(){var e=$(this),t=e.prop("checked");$(e.data("disabled")).each(function(){var e=$(this);e.is("a")?t?e.removeClass("disabled-link"):e.addClass("disabled-link"):e.prop("disabled",!t)})}).end().find('[data-toggle="tooltip"]').tooltip({container:"body"}),$(window).on("resize."+e,function(){var t=$(":focus");t.length>0&&(t.is("input")&&!["checkbox","radio"].includes(t.attr("type"))||t.is("textarea"))||r(e)}),s},n.show=function(e){var t=$("#"+e);t.length&&(t.find('legend [type="checkbox"]').each(function(){$(this).triggerHandler("click")}).end().find("input[data-disabled]").each(function(){$(this).triggerHandler("click")}),t.fadeIn("normal").find(".close:first").focus(),r(e))},n.resize=function(e){var t=$("#"+e);t.find(".dialog-body").css("max-height",$(window).height()-t.find(".dialog-header").outerHeight()-t.find(".dialog-footer").outerHeight())}),l=n.close=function(e){return $("#"+e).fadeOut("normal",function(){$(this).parent().remove()}),$(window).off("resize."+e),!1}},{"./util":22}],16:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.handleCustomBgStyle=n.handleSelectBgColor=n.handleSelectBgImage=n.handleIndexThreadPanel=n.handleAtTipsBtn=void 0;var i=e("./util"),r=o(i),l=e("./const"),s=a(l),d=e("./config");n.handleAtTipsBtn=function(){$("#atTips").click(function(){var e=$(this),t=e.data("time"),n=r.getCookie(s.default.atTipsTimeCookieName);if(t&&t!==n){if(n)n!==t&&r.setCookie(s.default.prevAtTipsTimeCookieName,n);else{var a=(new Date).getDate();r.setCookie(s.default.prevAtTipsTimeCookieName,(a<10?"0"+a:a)+"日00时00分")}r.setCookie(s.default.atTipsTimeCookieName,t,r.getDate("+3d")),e.removeClass("btn-outline-danger").addClass("btn-outline-primary")}})},n.handleIndexThreadPanel=function(){Config.activeNewReplyPanel&&$('a[data-toggle="tab"][href="'+Config.activeNewReplyPanel+'"]').tab("show"),Config.activeTopRecommendPanel&&$('a[data-toggle="tab"][href="'+Config.activeTopRecommendPanel+'"]').tab("show"),$(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(e){var t=$(e.target),n=t.attr("href"),a="";n.includes("NewReplyPanel")?a="activeNewReplyPanel":n.includes("TopRecommendPanel")&&(a="activeTopRecommendPanel"),a&&Config[a]!==n&&((0,d.read)(),Config[a]=n,(0,d.write)())})},n.handleSelectBgImage=function(){$("#selectBgImage").on("click","[data-id]",function(){var e=$(this),t=e.data("id"),n=e.data("filename"),a=e.parent().data("path");t&&n&&a&&confirm("是否选择此背景图片？")&&(r.setCookie(s.default.bgStyleCookieName,t,r.getDate("+1y")),$("body, .modal-content").css("background-image",'url("'+a+n+'")'),alert("背景已更换（图片可能需要一定时间加载）"))})},n.handleSelectBgColor=function(){$("#selectBgImage").on("click","[data-color]",function(){var e=$(this),t=e.data("color");t&&confirm("是否选择此背景颜色？")&&(r.setCookie(s.default.bgStyleCookieName,t,r.getDate("+1y")),$("body, .modal-content").css("background",t),alert("背景已更换"))})},n.handleCustomBgStyle=function(){$("#customBgStyle").click(function(){var e=r.getCookie(s.default.bgStyleCookieName);if(e&&!parseInt(e)||(e=""),e=prompt("请输入背景图片URL、颜色代码或CSS样式：\n（例：http://xxx.com/abc.jpg 或 #fcfcfc，留空表示恢复默认背景）\n（注：建议选择简洁、不花哨、偏浅色系的背景图片或颜色）",e),null!==e){var t=$("body, .modal-content, .dialog-content");""===$.trim(e)?(r.setCookie(s.default.bgStyleCookieName,"",r.getDate("-1d")),alert("背景已恢复默认"),location.reload()):/^https?:\/\/[^"']+/.test(e)?(r.setCookie(s.default.bgStyleCookieName,e,r.getDate("+1y")),t.css("background-image",'url("'+e+'")'),alert("背景已更换（图片可能需要一定时间加载）")):/^#[0-9a-f]{6}$/i.test(e)?(r.setCookie(s.default.bgStyleCookieName,e,r.getDate("+1y")),t.css("background",e.toLowerCase()),alert("背景已更换")):/[<>{}]/.test(e)?alert("格式不正确"):(e=e.replace(";",""),r.setCookie(s.default.bgStyleCookieName,e,r.getDate("+1y")),t.css("background",e),alert("背景已更换（图片可能需要一定时间加载）"))}})}},{"./config":12,"./const":14,"./util":22}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=n.show=function(e,t){var n={msg:"",duration:Config.defShowMsgDuration,clickable:!0,preventable:!1};"object"===$.type(e)?$.extend(n,e):(n.msg=e,n.duration="undefined"==typeof t?Config.defShowMsgDuration:t);var a=$(".msg-container"),i=0===a.length;i||$(".mask").length||a.height()>=.8*$(window).height()&&(r(),i=!0),n.preventable&&!$(".mask").length&&$('<div class="mask"></div>').appendTo("body"),i&&(a=$('<div class="container msg-container"></div>').appendTo("body"));var l=$('<div class="msg">'+n.msg+"</div>").appendTo(a);return l.on("click",".stop-action",function(e){e.preventDefault(),$(this).text("正在停止&hellip;").closest(".msg").data("stop",!0)}),n.clickable&&l.css("cursor","pointer").click(function(){o($(this))}).find("a").click(function(e){e.stopPropagation()}),n.preventable&&l.attr("preventable",!0),l.slideDown("normal"),n.duration>-1&&setTimeout(function(){o(l)},1e3*n.duration),l},o=(n.wait=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e+='<i class="fa fa-spinner fa-spin fa-lg fa-fw ml-3" aria-label="等待中" aria-hidden="true"></i>',a({msg:e,duration:-1,clickable:!1,preventable:t})},n.hide=function(e){e.slideUp("normal",function(){i($(this))})}),i=n.remove=function(e){var t=e.parent();e.remove(),$(".msg").length?$(".msg[preventable]").length||$(".mask").remove():(t.remove(),$(".mask").remove())},r=n.destroy=function(){$(".msg-container").remove(),$(".mask").remove()}},{}],18:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.handleUserPageBtns=n.validateRegisterField=n.bindMessageActionBtnsClick=n.transferKfbAlert=n.handleUploadAvatarFileBtn=n.syncPerPageFloorNum=n.assignBirthdayField=n.bindFriendPageBtnsClick=n.bindFavorPageBtnsClick=n.tuiGameIntro=n.handleGameIntroSearchArea=n.highlightUnReadAtTipsMsg=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e("./util"),l=o(r),s=e("./const"),d=a(s),c=e("./config");n.highlightUnReadAtTipsMsg=function(){if(Info.gjc===Info.userName){
var e=l.getCookie(d.default.prevAtTipsTimeCookieName);if(e&&/^\d+日\d+时\d+分$/.test(e)){var t="";$(".thread-list-item time").each(function(n){var a=$(this),o=$.trim(a.text());return 0===n&&(t=o),e<o&&t>=o&&(a.addClass("text-danger"),void(t=o))}),$(document).on("click",".thread-list-item .thread-link-item a",function(){l.deleteCookie(d.default.prevAtTipsTimeCookieName)})}}},n.handleGameIntroSearchArea=function(){$("#gameSearchKeyword").val(Info.keyword),$("#gameSearchType").val(Info.searchType)},n.tuiGameIntro=function(e){var t="";t="company"===e?"g_intro_inc_tui_":"type"===e?"g_intro_adv_tui_":"property"===e?"g_intro_moe_tui_":"g_intro_tui_",t+=Info.id;var n=l.makeUrl("game_intro/"+e,"id="+Info.id+"&tui=1");$(".tui-btn").click(function(e){e.preventDefault();var a=$(this);if(!a.data("wait")){if(l.getCookie(t,""))return void alert("你在48小时内已经推过");a.data("wait",!0),$.ajax({type:"GET",url:n,success:function(){var e=a.find("span:first"),t=parseInt(e.text());e.text("+1"),setTimeout(function(){e.text(++t)},1e3)},error:function(){alert("操作失败")},complete:function(){a.removeData("wait")},dataType:"html"})}})},n.bindFavorPageBtnsClick=function(){var e=$('form[name="favorForm"]');$(document).on("click",".remove-catalog",function(){return confirm("是否删除该目录？")}),$("#addCatalog").click(function(t){t.preventDefault();var n=$.trim(prompt("请输入收藏夹目录名称："));n&&(e.find('[name="job"]').val("addtype"),e.find('[name="type"]').val(n),e.submit())}),$("#favorActionBtns").on("click","button",function(){var t=$(this).data("action");if("selectAll"===t)l.selectAll($('[name="delid[]"]'));else if("selectInverse"===t)l.selectInverse($('[name="delid[]"]'));else if("delete"===t){var n=$('[name="delid[]"]:checked');n.length>0&&confirm("是否删除这"+n.length+"项？")&&(e.find('[name="job"]').val("clear"),e.submit())}}),$("#convertCatalogDropdownMenu").on("click","a",function(t){t.preventDefault();var n=$(this).data("type"),a=$('[name="delid[]"]:checked');a.length>0&&confirm("是否将这"+a.length+"项转换到指定目录？")&&(e.find('[name="job"]').val("change"),e.find('[name="type"]').val(n),e.submit())})},n.bindFriendPageBtnsClick=function(){$("#friendActionBtns").on("click",'[type="button"]',function(){var e=$(this).data("action");"selectAll"===e?l.selectAll($('[name="selid[]"]')):"selectInverse"===e&&l.selectInverse($('[name="selid[]"]'))})},n.assignBirthdayField=function(){$("#birthday").change(function(){var e=$(this).val().trim(),t=/(\d{4})-(\d{1,2})-(\d{1,2})/.exec(e),n="",a="",o="";t&&(n=parseInt(t[1]),a=parseInt(t[2]),o=parseInt(t[3])),$('[name="proyear"]').val(n),$('[name="promonth"]').val(a),$('[name="proday"]').val(o)})},n.syncPerPageFloorNum=function(){var e=function(){var e=parseInt($('[name="p_num"]').val());0===e&&(e=10),isNaN(e)||e===Config.perPageFloorNum||(Config.perPageFloorNum=e,(0,c.write)())};e(),$("#creator").submit(function(){(0,c.read)(),e()})},n.handleUploadAvatarFileBtn=function(){$("#browseAvatar").change(function(){var e=$(this),t=/\.(\w+)$/.exec(e.val());t&&["jpg","gif","png"].includes(t[1].toLowerCase())||alert("头像图片类型不匹配")})},n.transferKfbAlert=function(){$("#transferKfbForm").submit(function(){var e=$(this),t=parseInt(e.find('[name="to_money"]').val()),n=parseInt($("#fixedDeposit").text()),a=parseInt($("#currentDeposit").text());if(t>0&&n>0&&t>a&&!confirm("你的活期存款不足，转账金额将从定期存款里扣除，是否继续？"))return!1})},n.bindMessageActionBtnsClick=function(){$("#messageActionBtns").on("click","button",function(){var e=$("#messageListForm"),t=$(this).attr("name");if("selectAll"===t)l.selectAll($('[name="delid[]"]'));else if("selectInverse"===t)l.selectInverse($('[name="delid[]"]'));else if("selectCustom"===t){var n=function(){var e=$.trim(prompt("请填写所要选择的包含指定字符串的短消息标题（可用|符号分隔多个标题）","收到了他人转账的KFB|银行汇款通知|您的文章被评分|您的文章被删除"));return e?($('[name="delid[]"]').prop("checked",!1),void $("a.thread-link").each(function(){var t=$(this),n=!0,a=!1,o=void 0;try{for(var i,r=e.split("|")[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;t.text().toLowerCase().includes(l.toLowerCase())&&t.parent().find('[name="delid[]"]').prop("checked",!0)}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}})):{v:void 0}}();if("object"===("undefined"==typeof n?"undefined":i(n)))return n.v}else if("download"===t){var a=$('[name="delid[]"]:checked');a.length>0&&confirm("是否下载这"+a.length+"项？")&&(e.attr("action","/message.php").find('[name="action"]').val("down"),e.submit())}else if("delete"===t){var o=$('[name="delid[]"]:checked');o.length>0&&confirm("是否删除这"+o.length+"项？")&&(e.attr("action",l.makeUrl("message/job")).find('[name="action"]').val("del"),e.submit())}})},n.validateRegisterField=function(){$(document).on("change","input[name]",function(){var e=$(this),t=e.attr("name"),n=e.val();return n?void("regemail"===t?(l.showValidationMsg(e,"wait","检查中，请稍等&hellip;"),$.post(l.makeUrl("register/check"),"username="+n,function(t){var n=t.type,a=t.msg,o=t.username;e.val()===o&&l.showValidationMsg(e,n,a)}).fail(function(){l.showValidationMsg(e,"error","响应失败")})):"regpwd"===t?n.length>16||n.length<6?l.showValidationMsg(e,"error","密码长度不正确"):(l.showValidationMsg(e,"clear"),$('[name="regpwdrepeat"]').trigger("change")):"regpwdrepeat"===t&&(n!==$('[name="regpwd"]').val()?l.showValidationMsg(e,"error","两次输入的密码不相符"):l.showValidationMsg(e,"clear"))):void l.showValidationMsg(e,"clear")}),$("#registerForm").submit(function(){if($(this).find(".has-danger").length>0)return alert("请正确填写表单"),!1})},n.handleUserPageBtns=function(){var e=$("#profileBtns"),t=e.data("username");e.on("click",'[name="followUser"], [name="blockUser"]',function(){(0,c.read)();var e=$(this),n="关注",a=Config.followUserList;if("blockUser"===e.attr("name")?(n="屏蔽",a=Config.blockUserList,Config.blockUserEnabled=!0):Config.followUserEnabled=!0,e.text().includes("取消")){var o=l.inFollowOrBlockUserList(t,a);o>-1&&(a.splice(o,1),(0,c.write)()),e.removeClass("btn-outline-danger").addClass("btn-outline-primary").find("span").text(n+"用户"),alert("该用户已被取消"+n)}else{if(l.inFollowOrBlockUserList(t,a)===-1){if("屏蔽"===n){var i=Config.blockUserDefaultType;if(i=prompt("请填写屏蔽类型，0：主题和回帖；1：主题；2：回帖",i),null===i)return;i=parseInt(i),(isNaN(i)||i<0||i>2)&&(i=Config.blockUserDefaultType),a.push({name:t,type:i})}else a.push({name:t});(0,c.write)()}e.removeClass("btn-outline-primary").addClass("btn-outline-danger").find("span").text("取消"+n),alert("该用户已被"+n)}}).find('[name="followUser"], [name="blockUser"]').each(function(){var e=$(this),n="关注",a=Config.followUserList;"blockUser"===e.attr("name")&&(n="屏蔽",a=Config.blockUserList),l.inFollowOrBlockUserList(t,a)>-1&&e.removeClass("btn-outline-primary").addClass("btn-outline-danger").find("span").text("取消"+n)})}},{"./config":12,"./const":14,"./util":22}],19:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.handleClearMultiQuoteDataBtn=n.handleMultiQuote=n.addSmileCode=n.handleAttachBtns=n.checkPostForm=n.handleEditorBtns=void 0;var r=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=e("./util"),s=o(l),d=e("./const"),c=a(d),u=e("./msg"),f=o(u);n.handleEditorBtns=function(){var e=$("#postContent").get(0);$(document).on("click",".editor-btn-group button[data-action]",function(){var t=$(this).data("action"),n="";switch(t){case"link":n=prompt("请输入链接URL：","http://");break;case"img":n=prompt("请输入图片URL：","http://");break;case"sell":n=prompt("请输入出售金额：",1);break;case"hide":n=prompt("请输入神秘等级：",1);break;case"audio":n=prompt("请输入HTML5音频实际地址：\n（可直接输入网易云音乐或虾米的单曲地址，将自动转换为外链地址）","http://");var a=/^https?:\/\/music\.163\.com\/(?:#\/)?song\?id=(\d+)/i.exec(n);a&&(n="http://music.miaola.info/163/"+a[1]+".mp3"),a=/^https?:\/\/www\.xiami\.com\/song\/(\d+)/i.exec(n),a&&(n="http://music.miaola.info/xiami/"+a[1]+".mp3");break;case"video":n=prompt("请输入HTML5视频实际地址：\n（可直接输入YouTube视频页面的地址，将自动转换为外链地址）","http://");var o=/^https?:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w\-]+)/i.exec(n);o&&(n="http://video.miaola.info/youtube/"+o[1]),o=/^https?:\/\/youtu\.be\/([\w\-]+)$/i.exec(n),o&&(n="http://video.miaola.info/youtube/"+o[1])}if(null!==n){var i="",r="";switch(t){case"link":i=s.getSelText(e),r="[url="+n+"]"+i+"[/url]";break;case"img":r="[img]"+n+"[/img]";break;case"quote":i=s.getSelText(e),r="[quote]"+i+"[/quote]";break;case"code":i=s.getSelText(e),r="[code]"+i+"[/code]";break;case"sell":i=s.getSelText(e),r="[sell="+n+"]"+i+"[/sell]";break;case"hide":i=s.getSelText(e),r="[hide="+n+"]"+i+"[/hide]";break;case"bold":i=s.getSelText(e),r="[b]"+i+"[/b]";break;case"italic":i=s.getSelText(e),r="[i]"+i+"[/i]";break;case"underline":i=s.getSelText(e),r="[u]"+i+"[/u]";break;case"strike":i=s.getSelText(e),r="[strike]"+i+"[/strike]";break;case"super":i=s.getSelText(e),r="[sup]"+i+"[/sup]";break;case"sub":i=s.getSelText(e),r="[sub]"+i+"[/sub]";break;case"horizontal":r="[hr]";break;case"align-left":i=s.getSelText(e),r="[align=left]"+i+"[/align]";break;case"align-center":i=s.getSelText(e),r="[align=center]"+i+"[/align]";break;case"align-right":i=s.getSelText(e),r="[align=right]"+i+"[/align]";break;case"fly":i=s.getSelText(e),r="[fly]"+i+"[/fly]";break;case"audio":r="[audio]"+n+"[/audio]";break;case"video":r="[video]"+n+"[/video]"}r&&(s.addCode(e,r,i),e.focus())}}),$("#fontSizeDropdownMenu").on("click","a",function(t){t.preventDefault();var n=$(this).data("size"),a=s.getSelText(e),o="[size="+n+"]"+a+"[/size]";s.addCode(e,o,a),e.focus()}),$("#colorDropdownMenu, #bgColorDropdownMenu").on("click","span",function(){var t=$(this),n=t.parent().is("#bgColorDropdownMenu")?"backcolor":"color",a=t.data("color"),o=s.getSelText(e),i="["+n+"="+a+"]"+o+"[/"+n+"]";s.addCode(e,i,o),e.focus()})},n.checkPostForm=function(){$("#postForm").submit(function(){var e=$("#postType");if(e.length>0&&!e.val())return alert("没有选择主题分类"),e.focus(),!1;var t=$("#postTitle");if(t.length>0){var n=s.getStrByteLen(t.val());if(!n)return alert("标题不能为空"),t.focus(),!1;if(n>100)return alert("标题超过最大长度 100 个字节"),t.focus(),!1}var a=$("#voteItemContent");if(a.length>0&&!a.val().trim())return alert("投票选项不能为空"),a.focus(),!1;var o=$("#postContent");if(o.length>0){var i=s.getStrByteLen(o.val().trim());if(i<12)return alert("文章内容少于 12 个字节"),o.focus(),!1;if(i>5e4)return alert("文章内容大于 50000 个字节"),o.focus(),!1}var r=$("#postGjc");return r.length>0&&"new"===Info.action&&!r.val().trim()?(alert("请在内容文本框的下方填写关键词，以方便搜索，也可以在标题中选择任意一个词填入"),r.focus(),!1):void 0})},n.handleAttachBtns=function(){$(document).on("click",".attach-area a[data-action]",function(e){e.preventDefault();var t=$(this),n=t.closest(".attach-area"),a=t.data("action"),o=n.data("id");if(o)if("insert"===a){var i=t.data("type"),r=$("#postContent").get(0),l="["+("new"===i?"upload":"attachment")+"="+o+"]";s.addCode(r,l),r.focus()}else"update"===a?(n.find(".attach-info").prop("hidden",!0).after('<label><input name="replace_'+o+'" type="file" aria-label="选择附件"></label>'),t.data("action","cancel").text("取消").blur(),$(document).data("attachUpdateAlert")||(alert("本反向代理服务器为了提高性能对图片设置了缓存，更新附件图片后可能需等待最多30分钟才能看到效果"),$(document).data("attachUpdateAlert",!0))):"cancel"===a?(n.find(".attach-info").prop("hidden",!1).next("label").remove(),t.data("action","update").text("更新").blur()):"delete"===a&&n.remove()}),$(document).on("change",'[type="file"]',function(){var e=$(this),t=/\.(\w+)$/.exec(e.val());if(!t||!["jpg","gif","png","torrent"].includes(t[1].toLowerCase()))return void alert("附件类型不匹配");var n=e.data("type");if("new"===n){e.removeData("type").parent().next().prop("hidden",!1);var a=$("#newAttachArea"),o=a.find('[type="file"]').length;if(o>=5)return;var i=a.find('[type="file"]:last').closest(".attach-area"),r=parseInt(i.data("id"));if(!r)return;r++,$('\n<div class="form-group row font-size-sm attach-area" data-id="'+r+'">\n  <div class="col-xs-12 col-form-label">\n    <label>\n      <input name="attachment_'+r+'" data-type="new" type="file" aria-label="选择附件">\n    </label>\n    <span hidden>\n      <a data-action="insert" data-type="new" href="#">插入</a>&nbsp;\n      <a data-action="delete" href="#">删除</a>\n    </span>\n  </div>\n  <div class="col-xs-4">\n    <label class="sr-only" for="atc_downrvrc'+r+'">神秘系数</label>\n    <input class="form-control form-control-sm" id="atc_downrvrc'+r+'" name="atc_downrvrc'+r+'" data-toggle="tooltip" \ntype="number" value="0" min="0" title="神秘系数" placeholder="神秘系数">\n  </div>\n  <div class="col-xs-8">\n    <label class="sr-only" for="atc_desc'+r+'">描述</label>\n    <input class="form-control form-control-sm" id="atc_desc'+r+'" name="atc_desc'+r+'" data-toggle="tooltip" type="text" \ntitle="描述" placeholder="描述">\n  </div>\n</div>\n').insertAfter(i).find('[data-toggle="tooltip"]').tooltip({container:"body"})}})},n.addSmileCode=function(e){$(".smile-panel").on("click","img",function(){$(".smile-panel").addClass("open");var t=e.get(0);if(t){var n="[s:"+$(this).data("id")+"]";s.addCode(t,n,""),t.blur()}}).parent().on("shown.bs.dropdown",function(){$(".smile-panel img").each(function(){var e=$(this);e.attr("src")||e.attr("src",e.data("src"))})}).on("hide.bs.dropdown",function(e){var t=$(e.relatedTarget);return t.data("open")?e.preventDefault():void t.removeData("open")}),$("#smileDropdownBtn").click(function(){var e=$(this);e.data("open",!e.data("open"))})},n.handleMultiQuote=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=localStorage[c.default.multiQuoteStorageName];if(t){try{t=JSON.parse(t)}catch(e){return}if(t&&"object"===$.type(t)&&!$.isEmptyObject(t)){var n=t,a=n.tid,o=n.quoteList;if(Info.tid&&a===Info.tid&&"object"===$.type(o)&&(2!==e||Info.fid)){var l=[],d=!0,u=!1,m=void 0;try{for(var p,g=Object.values(o)[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var h=p.value;if(Array.isArray(h)){var b=!0,v=!1,y=void 0;try{for(var k,w=h[Symbol.iterator]();!(b=(k=w.next()).done);b=!0){var C=k.value;l.push(C)}}catch(e){v=!0,y=e}finally{try{!b&&w.return&&w.return()}finally{if(v)throw y}}}}}catch(e){u=!0,m=e}finally{try{!d&&g.return&&g.return()}finally{if(u)throw m}}if(!l.length)return void localStorage.removeItem(c.default.multiQuoteStorageName);var x=new Set,T="";2===e&&(f.wait('<span class="mr-3">正在获取引用内容中&hellip;</span>剩余：<em class="text-warning countdown-num">'+l.length+"</em>"),$(document).clearQueue("MultiQuote")),$.each(l,function(t,n){"undefined"!=typeof n.floor&&"undefined"!=typeof n.pid&&(x.add(n.userName),2===e?$(document).queue("MultiQuote",function(){$.get(s.makeUrl("post/index","action=quote&fid="+Info.fid+"&tid="+a+"&pid="+n.pid+"&article="+n.floor+"&t="+(new Date).getTime()),function(e){var n=e.postContent;T+=n?n+(t===l.length-1?"":"\n"):"";var a=$(".countdown-num:last");a.text(parseInt(a.text())-1),t===l.length-1?(f.destroy(),$("#postContent").val(T).focus()):setTimeout(function(){return $(document).dequeue("MultiQuote")},100)})}):T+="[quote]回 "+n.floor+"楼("+n.userName+") 的帖子[/quote]\n")});var S=!0,U=!1,I=void 0;try{for(var _,F=l.entries()[Symbol.iterator]();!(S=(_=F.next()).done);S=!0){var D=r(_.value,2);D[0],D[1]}}catch(e){U=!0,I=e}finally{try{!S&&F.return&&F.return()}finally{if(U)throw I}}$('[name="diy_guanjianci"]').val([].concat(i(x)).join(",")),$("#postForm").submit(function(){localStorage.removeItem(c.default.multiQuoteStorageName)}),2===e?$(document).dequeue("MultiQuote"):$("#postContent").val(T).focus()}}}},n.handleClearMultiQuoteDataBtn=function(){$(".clear-multi-quote-data-btn").click(function(e){e.preventDefault(),confirm("是否清除多重引用数据？")&&(localStorage.removeItem(c.default.multiQuoteStorageName),$('[name="diy_guanjianci"]').val(""),$("#postContent").val(""))})}},{"./const":14,"./msg":17,"./util":22}],20:[function(require,module,exports){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.blockThread=exports.blockUsers=exports.followUsers=exports.showCommonImportOrExportConfigDialog=exports.preventCloseWindow=exports.fillCommonForumPanel=exports.showEditCommonForumDialog=exports.bindFastSubmitShortcutKey=exports.handlePageInput=exports.handleSearchDialog=exports.handleSidebarRollBtn=exports.showSidebarBtnGroup=exports.handleMainMenuLink=exports.handleMainMenu=void 0;var _slicedToArray=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_util=require("./util"),Util=_interopRequireWildcard(_util),_const=require("./const"),_const2=_interopRequireDefault(_const),_dialog=require("./dialog"),Dialog=_interopRequireWildcard(_dialog),_config=require("./config"),_configDialog=require("./configDialog"),ConfigDialog=_interopRequireWildcard(_configDialog),handleMainMenu=exports.handleMainMenu=function(){$("#mainMenuTogglerBtn").click(function(){var e=document.documentElement.clientHeight-$(this).closest(".navbar").outerHeight();e>0&&$("#mainMenu").css("max-height",e+"px")}),$("#sidebarMainMenuBtn").click(function(){return $("#mainMenuTogglerBtn").click()})},handleMainMenuLink=exports.handleMainMenuLink=function(){$("#mainMenu").find('[data-name="openConfigDialog"]').click(function(e){e.preventDefault(),$("#mainMenuTogglerBtn").click(),ConfigDialog.show()})},showSidebarBtnGroup=exports.showSidebarBtnGroup=function(){$(".sidebar-btn-group").prop("hidden",!1),Config.showSidebarRollBtnEnabled&&$("#sidebarRollBtn").prop("hidden",!1),Config.showSidebarMainMenuBtnEnabled&&$("#sidebarMainMenuBtn").prop("hidden",!1),Config.showSidebarForumListBtnEnabled&&$("#sidebarForumListBtn").prop("hidden",!1),Config.showSidebarSearchBtnEnabled&&$("#sidebarSearchBtn").prop("hidden",!1),Config.showSidebarHomePageBtnEnabled&&$("#sidebarHomePageBtn").prop("hidden",!1)},handleSidebarRollBtn=exports.handleSidebarRollBtn=function(){$(window).scroll(function(){var e=$("#sidebarRollBtn");if($(window).scrollTop()>640){if("top"===e.data("direction"))return;e.data("direction","top").attr("aria-label","滚动到页顶").find("i").removeClass("fa-chevron-down").addClass("fa-chevron-up")}else{if("bottom"===e.data("direction"))return;e.data("direction","bottom").attr("aria-label","滚动到页底").find("i").removeClass("fa-chevron-up").addClass("fa-chevron-down")}}),$("#sidebarRollBtn").click(function(){var e="bottom"===$(this).data("direction")?$("body").height():0;$("body, html").animate({scrollTop:e})})},handleSearchDialog=exports.handleSearchDialog=function(){var e=$("#searchDialog");e.on("shown.bs.modal",function(){$("#searchKeyword").select().focus()}).find("form").submit(function(){var e=$(this),t=e.find("#searchKeyword"),n=e.find("#searchType").val(),a=$.trim(t.val());"gjc"===n?e.attr("action",Util.makeUrl("gjc/"+a)):"username"===n?e.attr("action",Util.makeUrl("user/username/"+a)):(e.attr("action",Util.makeUrl("search")),t.attr("name","author"===n?"pwuser":"keyword"),"title"===n&&a.length&&Util.getStrByteLen(a)<=2&&!function(){var n=e.find('[name="method"]');n.val("OR"),t.val(a+" "+Math.floor((new Date).getTime()/1e3)),setTimeout(function(){t.val(a),n.val("AND")},200)}())}),e.find('[name="searchRange"]').on("click",function(){var t="all";"current"===$(this).val()&&(t=Info.fid),e.find('[name="f_fid"]').val(t)});var t=e.find('[name="searchRange"][value="current"]'),n=t.closest(".form-check-inline");e.find("#searchType").change(function(){var e=$(this).val();if(t.data("enabled")){var a="gjc"===e||"username"===e;t.prop("disabled",a),a?n.addClass("disabled"):n.removeClass("disabled")}}),"threadPage"!==pageId&&"readPage"!==pageId||(t.prop("disabled",!1).data("enabled",!0).click(),n.removeClass("disabled"))},handlePageInput=exports.handlePageInput=function(){$(document).on("click",".page-input",function(e){if(e.preventDefault(),!(Info.maxPageNum&&Info.maxPageNum<=1)){var t=$(this).data("url");if(t){var n=$(this).data("exclude");n=n?n.split(","):[];var a=parseInt(prompt("要跳转到第几页？"+(Info.maxPageNum?"（共"+Info.maxPageNum+"页）":""),Info.currentPageNum));a&&a>0&&(location.href=Util.makeUrl(t,"page="+a,!0,n))}}})},bindFastSubmitShortcutKey=exports.bindFastSubmitShortcutKey=function(e){e.keydown(function(e){13===e.keyCode&&e.ctrlKey&&$(this).closest("form").submit()})},showEditCommonForumDialog=exports.showEditCommonForumDialog=function(){$(document).on("click",".edit-common-forum-btn",function(e){e.preventDefault();var t="editCommonForumDialog";if(!($("#"+t).length>0)){(0,_config.read)();var n=Config.commonForumList.length>0?Config.commonForumList:_const2.default.commonForumList,a="",o=!0,i=!1,r=void 0;try{for(var l,s=n[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){var d=l.value,c=d.fid,u=d.name;a+='<span class="btn btn-outline-primary" data-fid="'+c+'">'+u+"</span>"}}catch(e){i=!0,r=e}finally{try{!o&&s.return&&s.return()}finally{if(i)throw r}}var f="",m=!0,p=!1,g=void 0;try{for(var h,b=function(){var e=h.value,t=e.fid,a=e.name;return n.find(function(e){return e.fid===t})?"continue":void(f+='<span class="btn btn-outline-primary" data-fid="'+t+'">'+a+"</span>")},v=_const2.default.availableForumList[Symbol.iterator]();!(m=(h=v.next()).done);m=!0){b()}}catch(e){p=!0,g=e}finally{try{!m&&v.return&&v.return()}finally{if(p)throw g}}var y='\n<p class="font-size-sm text-muted">\n  请将可用版块内的版块按钮拖拽到常用版块内（或相反）\n</p>\n<fieldset class="fieldset mb-3 py-2">\n  <legend>常用版块</legend>\n  <div class="edit-forum-list d-flex flex-wrap" id="editCommonForumList">'+a+'</div>\n</fieldset>\n<fieldset class="fieldset mb-3 py-2">\n  <legend>可用版块</legend>\n  <div class="edit-forum-list d-flex flex-wrap" id="editAvailableForumList">'+f+"</div>\n</fieldset>",k='\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>\n<button class="btn btn-danger" name="reset" type="button">重置</button>',w=Dialog.create(t,"编辑常用版块",y,k),C=$('[name="dragulaScriptPath"]'),x=C.val();x?($.getScript(x,function(){return dragula(w.find(".edit-forum-list").get(),{revertOnSpill:!0})}),C.val("")):dragula(w.find(".edit-forum-list").get(),{revertOnSpill:!0}),w.submit(function(e){e.preventDefault(),Config.commonForumList=[],$("#editCommonForumList").children(".btn").each(function(){var e=$(this),t=parseInt(e.data("fid")),n=e.text().trim();t&&n&&Config.commonForumList.push({fid:t,name:n})}),(0,_config.write)(),alert("设置已保存"),Dialog.close(t),location.reload()}).find('[name="reset"]').click(function(){confirm("是否重置？")&&(Config.commonForumList=[],(0,_config.write)(),alert("设置已重置"),Dialog.close(t),location.reload())}),Dialog.show(t)}})},fillCommonForumPanel=exports.fillCommonForumPanel=function(){var e=Config.commonForumList.length>0?Config.commonForumList:_const2.default.commonForumList,t="",n=!0,a=!1,o=void 0;try{for(var i,r=e.entries()[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=_slicedToArray(i.value,2),s=l[0],d=l[1],c=d.fid,u=d.name;0!==s&&s%3!==0||(t+='<div class="row mb-3">'),t+='\n<div class="col-4">\n  <a class="btn btn-outline-primary btn-block" href="'+Util.makeUrl("thread")+"/"+c+'">'+u+"</a>\n</div>",s!==e.length-1&&s%3!==2||(t+="</div>")}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}$(".common-forum-panel").html(t)},preventCloseWindow=exports.preventCloseWindow=function(){window.addEventListener("beforeunload",function(e){if($(".mask").length>0){var t="正在进行操作中，确定要关闭页面吗？";return e.returnValue=t,t}})},showCommonImportOrExportConfigDialog=exports.showCommonImportOrExportConfigDialog=function(e,t,n,a){var o="pdCommonImOrExConfigDialog";if(!($("#"+o).length>0)){(0,_config.read)();var i='\n<p class="font-size-sm">\n  <b>导入设置：</b>将设置内容粘贴到文本框中并点击保存按钮即可<br>\n  <b>导出设置：</b>复制文本框里的内容并粘贴到别处即可\n</p>\n<div class="form-group">\n  <textarea class="form-control" name="commonConfig" rows="10" aria-label="设置内容" style="word-break: break-all;"></textarea>\n</div>',r='\n<button class="btn btn-primary" type="submit">保存</button>\n<button class="btn btn-secondary" data-dismiss="dialog" type="button">取消</button>',l=Dialog.create(o,"导入或导出"+e,i,r);l.submit(function(e){if(e.preventDefault(),confirm("是否导入文本框中的设置？")){var n=$.trim(l.find('[name="commonConfig"]').val());if(n){try{n=JSON.parse(n)}catch(e){return void alert("设置有错误")}if(!n||$.type(n)!==$.type(Config[t]))return void alert("设置有错误");Config[t]=n,(0,_config.write)(),alert("设置已导入"),Dialog.close(o),"function"==typeof a?a():location.reload()}}}),Dialog.show(o),l.find('[name="commonConfig"]').val(JSON.stringify(Config[t])).select().focus(),"function"==typeof n&&n(l)}},followUsers=exports.followUsers=function(){Config.followUserList.length&&("indexPage"===pageId&&Config.highlightFollowUserThreadInHPEnabled?$(".thread-link").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("author"),Config.followUserList)>-1&&e.addClass("text-danger")}):"threadPage"===pageId?$(".thread-link").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("author"),Config.followUserList)>-1&&(e.closest(".thread-list-item").find(".thread-item-footer a:first").addClass("text-danger"),Config.highlightFollowUserThreadLinkEnabled&&e.addClass("text-danger"))}):"readPage"===pageId?$(".read-floor").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("username"),Config.followUserList)>-1&&e.find(".floor-num").addClass("text-danger")}):"gjcPage"!==pageId&&"sharePage"!==pageId&&"searchPage"!==pageId||$(".thread-list-group").find("a[data-author]").each(function(){var e=$(this);Util.inFollowOrBlockUserList(e.data("author"),Config.followUserList)>-1&&e.addClass("text-danger")}))},blockUsers=exports.blockUsers=function(){if(Config.blockUserList.length){var e=0;if("indexPage"===pageId)$(".thread-link").each(function(){var t=$(this),n=Util.inFollowOrBlockUserList(t.data("author"),Config.blockUserList);n>-1&&Config.blockUserList[n].type<=1&&(e++,t.closest(".thread-link-group").remove())});else if("threadPage"===pageId){if(1===Config.blockUserForumType&&!Config.blockUserFidList.includes(Info.fid))return;if(2===Config.blockUserForumType&&Config.blockUserFidList.includes(Info.fid))return;$(".thread-link").each(function(){var t=$(this),n=Util.inFollowOrBlockUserList(t.data("author"),Config.blockUserList);n>-1&&Config.blockUserList[n].type<=1&&(e++,t.closest(".thread-list-item").remove())})}else if("readPage"===pageId){if(1===Config.blockUserForumType&&!Config.blockUserFidList.includes(Info.fid))return;if(2===Config.blockUserForumType&&Config.blockUserFidList.includes(Info.fid))return;$(".read-floor").each(function(){var t=$(this),n=Util.inFollowOrBlockUserList(t.data("username"),Config.blockUserList);if(n>-1){var a=parseInt(t.data("floor"));if(2===Config.blockUserList[n].type&&0===a)return;if(1===Config.blockUserList[n].type&&a>0)return;e++,t.closest(".read-floor").remove()}}),$(".read-content").find(".blockquote > p").each(function(){var e=$(this),t=e.text().trim(),n=!0,a=!1,o=void 0;try{for(var i,r=Config.blockUserList[Symbol.iterator]();!(n=(i=r.next()).done);n=!0){var l=i.value;if(1!==l.type)try{var s=new RegExp("^引用(第\\d+楼|楼主)"+l.name+"于","i"),d=new RegExp("^回\\s*\\d+楼\\("+l.name+"\\)\\s*的帖子","i");(s.test(t)||d.test(t))&&e.html('<mark class="help" data-toggle="tooltip" title="被屏蔽用户：'+l.name+'">该用户已被屏蔽</mark>')}catch(e){}}}catch(e){a=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(a)throw o}}})}else"gjcPage"===pageId&&Config.blockUserAtTipsEnabled&&$(".thread-list-group").find("a[data-author]").each(function(){var t=$(this);Util.inFollowOrBlockUserList(t.data("author"),Config.blockUserList)>-1&&(e++,t.closest(".thread-list-item").remove())});e>0&&console.log("【屏蔽用户】共有"+e+"个主题或回复被屏蔽")}},blockThread=exports.blockThread=function blockThread(){if(Config.blockThreadList.length){var isBlock=function isBlock(title,userName){var fid=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,_iteratorNormalCompletion5=!0,_didIteratorError5=!1,_iteratorError5=void 0;try{for(var _iterator5=Config.blockThreadList[Symbol.iterator](),_step5;!(_iteratorNormalCompletion5=(_step5=_iterator5.next()).done);_iteratorNormalCompletion5=!0){var _step5$value=_step5.value,keyWord=_step5$value.keyWord,includeUser=_step5$value.includeUser,excludeUser=_step5$value.excludeUser,includeFid=_step5$value.includeFid,excludeFid=_step5$value.excludeFid,regex=null;if(/^\/.+\/[gimuy]*$/.test(keyWord))try{regex=eval(keyWord)}catch(e){console.log(e);continue}if(userName)if(includeUser){if(!includeUser.includes(userName))continue}else if(excludeUser&&excludeUser.includes(userName))continue;if(fid)if(includeFid){if(!includeFid.includes(fid))continue}else if(excludeFid&&excludeFid.includes(fid))continue;if(regex){if(regex.test(title))return!0}else if(title.toLowerCase().includes(keyWord.toLowerCase()))return!0}}catch(e){_didIteratorError5=!0,_iteratorError5=e}finally{try{!_iteratorNormalCompletion5&&_iterator5.return&&_iterator5.return()}finally{if(_didIteratorError5)throw _iteratorError5}}return!1},num=0;if("indexPage"===pageId)$(".thread-link").each(function(){var e=$(this);isBlock(e.text().trim(),e.data("author"))&&(num++,e.closest(".thread-link-group").remove())});else if("threadPage"===pageId)$(".thread-link").each(function(){var e=$(this);isBlock(e.text().trim(),e.data("author"),Info.fid)&&(num++,e.closest(".thread-list-item").remove())});else if("readPage"===pageId){if(1!==Info.currentPageNum)return;var $topFloor=$('.read-floor[data-floor="0"]');if(!$topFloor.length)return;isBlock($(".thread-title").text().trim(),$topFloor.data("username"),Info.fid)&&(num++,$topFloor.remove())}num>0&&console.log("【屏蔽主题】共有"+num+"个主题被屏蔽")}}},{"./config":12,"./configDialog":13,"./const":14,"./dialog":15,"./util":22}],21:[function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.addUserMemo=n.bindMultiQuoteCheckClick=n.handleCopyCodeBtn=n.handleTuiThreadBtn=n.handleFastGotoFloorBtn=n.gotoFloor=n.handleFloorImage=n.copyBuyThreadList=n.handleBuyThreadBtn=n.handleBlockFloorBtn=n.handleFastReplyBtn=n.handleCopyFloorLinkBtn=void 0;var i=e("./util"),r=o(i),l=e("./const"),s=a(l),d=(e("./config"),e("./msg")),c=o(d),u=(n.handleCopyFloorLinkBtn=function(){$(document).on("click",".floor-num",function(e){e.preventDefault();var t=$(this),n=r.getHostNameUrl()+t.attr("href");t.data("copy-text",n),r.copyText(t,t)||prompt("本楼的跳转链接：",n)})},n.handleFastReplyBtn=function(){$(document).on("click",".fast-reply-btn",function(){var e=$(this).closest("article"),t=e.data("floor"),n=e.data("username");$("#postGjc").val(n);var a=$("#postContent").get(0);a.value="[quote]回 "+t+"楼("+n+") 的帖子[/quote]\n",a.selectionStart=a.value.length,a.selectionEnd=a.value.length,a.focus()})},n.handleBlockFloorBtn=function(){$(document).on("click",".block-floor",function(){return confirm("确认要屏蔽该回帖？本操作不可恢复！（屏蔽后该回帖将对大家不可见）")})},n.handleBuyThreadBtn=function(){$(document).on("click",".buy-thread-btn",function(e){e.preventDefault();var t=$(this),n=t.data("pid"),a=t.data("price");if(!(a>5)||confirm("此贴售价"+a+"KFB，是否购买？")){var o=c.wait("正在购买帖子&hellip;");$.get(r.makeUrl("job/buytopic","tid="+Info.tid+"&pid="+n+"&verify="+Info.verify),function(e){
var t=e.msg;c.remove(o),"操作完成"===t?location.reload():t.includes("您已经购买此帖")?(alert("你已经购买过此帖"),location.reload()):alert("帖子购买失败")})}})},n.copyBuyThreadList=function(){$(document).on("change",".buy-thread-list",function(){var e=$(this);if("copyList"===e.val()){var t=e.find("option").map(function(e){var t=$(this).text();return 0===e||1===e||t.includes("-".repeat(11))?null:t}).get().join("\n");if(e.get(0).selectedIndex=0,!t)return void alert("暂时无人购买");var n=$('\n<div class="modal fade" id="buyThreadListDialog" tabindex="-1" role="dialog" aria-labelledby="buyThreadListDialogTitle"\n     aria-hidden="true">\n  <div class="modal-dialog modal-sm" role="document">\n    <div class="modal-content">\n      <div class="modal-header">\n        <h5 class="modal-title" id="buyThreadListDialogTitle">购买人名单</h5>\n        <button class="close" data-dismiss="modal" type="button" aria-label="关闭">\n          <span aria-hidden="true">&times;</span>\n        </button>\n      </div>\n      <div class="modal-body">\n        <div class="form-group">\n          <textarea class="form-control" name="buyThreadListContent" rows="14" aria-label="购买人名单">'+t+"</textarea>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n").appendTo("body");n.on("shown.bs.modal",function(){n.find('[name="buyThreadListContent"]').select().focus()}).on("hidden.bs.modal",function(){n.remove()}).modal("show")}})},n.handleFloorImage=function(){$(document).on("click",".img",function(){var e=$(this);e.parent().is("a")||this.naturalWidth<=e.closest(".read-content").width()||(location.href=e.attr("src"))})},n.gotoFloor=function(){if(Info.floor&&Info.floor>0){var e=$('article[data-floor="'+Info.floor+'"]').prev("a").attr("name");e&&(location.hash="#"+e)}},n.handleFastGotoFloorBtn=function(){$(".fast-goto-floor").click(function(e){e.preventDefault();var t=$(this).data("url");if(t){var n=parseInt(prompt("你要跳转到哪一层楼？"));!n||n<=0||(location.href=r.makeUrl(t,"page="+(Math.floor(n/Config.perPageFloorNum)+1)+"&floor="+n))}})},n.handleTuiThreadBtn=function(){$(".tui-btn").click(function(e){e.preventDefault();var t=$(this);t.data("wait")||(t.data("wait",!0),$.ajax({type:"POST",url:"/diy_read_tui.php",data:"tid="+Info.tid+"&safeid="+Info.safeId,success:function(e){var n=/<span.+?\+\d+!<\/span>\s*(\d+)/i.exec(e);n?!function(){var e=t.find("span:first");e.text("+1"),setTimeout(function(){e.text(n[1])},1e3)}():/已推过/.test(e)?alert("已推过"):alert("操作失败")},error:function(){alert("操作失败")},complete:function(){t.removeData("wait")}}))})},n.handleCopyCodeBtn=function(){$(document).on("click",".copy-code",function(e){e.preventDefault();var t=$(this);if(!r.copyText(t.next("pre"),t)){var n=t.data("code");if(n)t.text("复制代码").removeData("code"),t.next("textarea").remove(),t.after('<pre class="pre-scrollable">'+n+"</pre>");else{var a=t.next("pre"),o=a.html();t.text("还原代码").data("code",o),o=r.decodeHtmlSpecialChar(o);var i=a.height();i<50&&(i=50),i>340&&(i=340),a.remove(),$('<textarea class="form-control code-textarea" style="height: '+i+'px" wrap="off">'+o+"</textarea>").insertAfter(t).select().focus()}}})},function(){var e=[];return $(".multi-quote-check:checked").each(function(){var t=$(this).closest("article");e.push({floor:t.data("floor"),pid:t.data("pid"),userName:t.data("username")})}),e});n.bindMultiQuoteCheckClick=function(){$(document).on("click",".multi-quote-check",function(){var e=localStorage[s.default.multiQuoteStorageName];if(e)try{e=JSON.parse(e),!e||"object"!==$.type(e)||$.isEmptyObject(e)?e=null:"tid"in e&&e.tid===Info.tid&&"object"===$.type(e.quoteList)||(e=null)}catch(t){e=null}else e=null;var t=u();e||(localStorage.removeItem(s.default.multiQuoteStorageName),e={tid:Info.tid,quoteList:{}}),t.length>0?e.quoteList[Info.currentPageNum]=t:delete e.quoteList[Info.currentPageNum],localStorage[s.default.multiQuoteStorageName]=JSON.stringify(e)})},n.addUserMemo=function(){$.isEmptyObject(Config.userMemoList)||$(".read-floor").each(function(){var e=$(this),t=e.data("username"),n=Object.keys(Config.userMemoList).find(function(e){return e===t});n&&e.find(".floor-user").after('<span class="tips font-size-sm" data-toggle="tooltip" title="备注：'+Config.userMemoList[n]+'">[?]</span>')})}},{"./config":12,"./const":14,"./msg":17,"./util":22}],22:[function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],a=!0,o=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(a=(r=l.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(e){o=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=(n.setCookie=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Info.cookiePrefix;document.cookie=""+a+e+"="+encodeURI(t)+(n?";expires="+n.toUTCString():"")+";path=/;"},n.getCookie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Info.cookiePrefix,n=new RegExp("(^| )"+t+e+"=([^;]*)(;|$)"),a=document.cookie.match(n);return a?decodeURI(a[2]):null},n.deleteCookie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Info.cookiePrefix;document.cookie=""+t+e+"=;expires="+i("-1d").toUTCString()+";path=/;"},n.getDate=function(e){var t=new Date,n=/^(-|\+)?(\d+)([a-zA-Z]{1,2})$/.exec(e);if(!n)return null;var a="undefined"==typeof n[1]?0:"+"===n[1]?1:-1,o=a===-1?-parseInt(n[2]):parseInt(n[2]),i=n[3];switch(i){case"Y":t.setFullYear(o);break;case"y":t.setFullYear(0===a?o:t.getFullYear()+o);break;case"M":t.setMonth(0===a?o:t.getMonth()+o);break;case"d":t.setDate(0===a?o:t.getDate()+o);break;case"h":t.setHours(0===a?o:t.getHours()+o);break;case"m":t.setMinutes(0===a?o:t.getMinutes()+o);break;case"s":t.setSeconds(0===a?o:t.getSeconds()+o);break;case"ms":t.setMilliseconds(0===a?o:t.getMilliseconds()+o);break;default:return null}return t}),r=(n.getStrByteLen=function(e){for(var t=0,n=2,a=0;a<e.length;a++)t+=e.charCodeAt(a)<0||e.charCodeAt(a)>255?n:1;return t},n.getHostNameUrl=function(){return location.protocol+"//"+location.host},n.addCode=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=""===n?t.indexOf("]")+1:t.indexOf(n);if("undefined"!=typeof e.selectionStart){var o=e.selectionStart;e.value=e.value.substring(0,o)+t+e.value.substring(e.selectionEnd),e.selectionStart=o+a,e.selectionEnd=o+a+n.length}else e.value+=t},n.getSelText=function(e){return e.value.substring(e.selectionStart,e.selectionEnd)},n.extractQueryStr=function(e){var t=new Map,n=!0,a=!1,i=void 0;try{for(var r,l=e.split("&")[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var s=r.value;if(s){var d=s.split("="),c=o(d,2),u=c[0],f=c[1];t.set(u,"undefined"!=typeof f?f:"")}}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t}),l=n.buildQueryStr=function(e){var t="",n=!0,a=!1,i=void 0;try{for(var r,l=e[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var s=o(r.value,2),d=s[0],c=s[1];t+=2===Info.urlType?(t?"&":"")+d+"="+c:(t?"/":"")+d+"/"+c}}catch(e){a=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(a)throw i}}return t},s=(n.makeUrl=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i="",s=r(t);if(n){s=new Map([].concat(a(r(Info.urlParam).entries()),a(s.entries())));for(var d in o)s.delete(o[d])}if(e.startsWith("/")||(i=location.pathname.startsWith(Info.baseFile)?Info.baseFile+"/":Info.rootPath),i+=e,s.size>0){var c=l(s);c&&(i+=(2===Info.urlType?"?":"/")+c)}return i},n.getQueryParam=function(e){return r(Info.urlParam).get(e)},n.decodeHtmlSpecialChar=function(e){return e.length?e.replace(/<br\s*\/?>/gi,"\n").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&nbsp;/gi," ").replace(/&gt;/gi,">").replace(/&lt;/gi,"<").replace(/&amp;/gi,"&"):""},n.selectAll=function(e){e.prop("checked",!0)},n.selectInverse=function(e){e.each(function(){var e=$(this);e.prop("checked",!e.prop("checked"))})},n.showValidationMsg=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";"error"===t&&(t="danger"),e.removeClass("form-control-success form-control-warning form-control-danger");var a=e.parent();a.removeClass("has-success has-warning has-danger"),$.inArray(t,["success","warning","danger"]>-1)&&e.addClass("form-control-"+t).parent().addClass("has-"+t);var o=a.find(".form-control-feedback");"wait"===t?o.html('<span class="text-muted"><i class="fa fa-spinner fa-spin" aria-hidden="true"></i> '+n+"</span>"):o.text(n)},n.getDifferenceSetOfObject=function(e,t){var n={};return"object"!==$.type(e)||"object"!==$.type(t)?n:($.each(t,function(t,a){t in e&&(s(e[t],a)||(n[t]=a))}),n)},n.deepEqual=function e(t,n){if(t===n)return!0;if($.type(t)!==$.type(n))return!1;if("number"==typeof t&&"number"==typeof n&&isNaN(t)&&isNaN(n))return!0;if($.isArray(t)&&$.isArray(n)||"object"===$.type(t)&&"object"===$.type(n)){if(t.length!==n.length)return!1;for(var a in $.extend($.isArray(t)?[]:{},t,n)){if("undefined"==typeof t[a]||"undefined"==typeof n[a])return!1;if(!e(t[a],n[a]))return!1}return!0}return!1});n.copyText=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!("execCommand"in document&&t.length))return!1;var e=t.data("copy-text");e&&(t=$('<span class="text-hide">'+e+"</span>").insertAfter(t));var a=window.getSelection();a.selectAllChildren(t.get(0));var o=document.execCommand("copy");if(a.removeAllRanges(),e&&t.remove(),o&&n){var i=n.data("copy-msg");n.attr("title",i?i:"已复制").on("hidden.bs.tooltip",function(){$(this).tooltip("dispose")}).tooltip("show")}return o},n.inFollowOrBlockUserList=function(e,t){return t.findIndex(function(t){return t.name&&t.name===e})},n.isOpera=function(){return"undefined"!=typeof window.opera},n.isEdge=function(){return navigator.appVersion&&navigator.appVersion.includes("Edge")}},{}]},{},[1]);
//# sourceMappingURL=app.min.js.map

{"version":3,"sources":["app.js"],"names":["pageId","$","attr","configName","Config","Const","multiQuoteStorageName","setCookie","name","value","date","prefix","document","cookie","replace","pageInfo","cookiePrefix","encodeURI","toUTCString","getCookie","regex","RegExp","matches","match","decodeURI","getDate","Date","exec","flag","increment","parseInt","unit","setFullYear","setYear","getYear","setMonth","getMonth","setDate","setHours","getHours","setMinutes","getMinutes","setSeconds","getSeconds","setMilliseconds","getMilliseconds","getStrLen","str","len","s_len","indexOf","length","c_len","i","charCodeAt","getHostNameUrl","location","protocol","host","addCode","textArea","code","selText","startPos","selectionStart","prePos","substr","selectionEnd","getSelText","extractQueryStr","param","each","split","arr","buildQueryStr","obj","queryStr","key","makeUrl","action","includeOtherParam","url","paramList","extend","urlParam","hasEntryFile","pathname","baseFile","rootPath","isEmptyObject","urlType","decodeHtmlSpecialChar","selectAll","$nodes","prop","selectReverse","$this","this","bindFastSubmitKeydown","$node","keydown","e","keyCode","ctrlKey","closest","submit","readConfig","options","localStorage","JSON","parse","ex","type","writeConfig","stringify","handleMainMenu","click","css","documentElement","clientHeight","handleBackToTop","window","scroll","scrollTop","fadeIn","fadeOut","animate","handleSearchDialog","$searchDialog","on","select","focus","find","$searchKeyword","searchType","val","keyword","trim","$method","Math","floor","getTime","setTimeout","fid","$current","change","data","handleAtTipsBtn","time","cookieValue","currentDate","removeClass","addClass","highlightUnReadAtTipsMsg","gjc","userName","timeString","test","prevString","index","curString","text","handleIndexThreadPanel","activeNewReplyPanel","tab","activeTopRecommendPanel","$target","target","panelName","typeName","handlePageNav","preventDefault","maxPageNum","num","prompt","currentPageNum","href","showFloorLink","handleFastReplyBtn","$article","replyContent","get","handleBlockFloorBtn","confirm","handleBuyThreadBtn","pid","price","tid","verify","copyBuyThreadList","children","list","map","join","modal","selectedIndex","handleFloorImage","parent","is","naturalWidth","width","addSmileCode","blur","$relatedTarget","relatedTarget","removeData","handlePostForm","minLen","$textArea","alert","fastGotoFloor","perPageFloorNum","floorNum","inArray","hashName","prev","hash","tuiThread","ajax","safeId","success","msg","$num","error","complete","copyCode","next","remove","after","$pre","html","height","insertAfter","getCheckedMultiQuoteData","quoteList","push","bindMultiQuoteCheckClick","removeItem","handleMultiQuote","j","keywords","content","quote","handleClearMultiQuoteDataBtn","checkDonationBtnStatus","handleGameIntroSearchArea","tuiGameIntro","cookieName","id","dataType","randomSelectSmBox","$boxes","number","random","off","eq","bindFavorPageBtnsClick","$form","$checked","bindFriendPageBtnsClick","assignBirthdayFiled","year","month","day","uploadAvatar","$browseAvatar","formData","FormData","append","files","cache","contentType","processData","console","log","syncPerPageFloorNum","syncConfig","isNaN","transferKfbAlert","transferKfb","fixedDeposit","currentDeposit","bindMessageActionBtnsClick","title","toLowerCase","tooltip","container"],"mappings":"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","file":"app.js","sourcesContent":["'use strict';\r\n// 页面ID\r\nvar pageId = $('body').attr('id');\r\n// 配置名称\r\nvar configName = 'kf_config';\r\n/**\r\n * 配置类\r\n */\r\nvar Config = {};\r\n/**\r\n * 配置常量类\r\n */\r\nvar Const = {\r\n    // 存储多重引用数据的LocalStorage名称\r\n    multiQuoteStorageName: 'kf_multi_quote'\r\n};\r\n\r\n/**\r\n * 设置Cookie\r\n * @param {string} name Cookie名称\r\n * @param {*} value Cookie值\r\n * @param {?Date} [date] Cookie有效期，为空则表示有效期为浏览器进程关闭\r\n * @param {string} [prefix] Cookie名称前缀，留空则表示使用{@link pageInfo.cookiePrefix}前缀\r\n */\r\nvar setCookie = function (name, value, date, prefix) {\r\n    document.cookie =\r\n        '{0}{1}={2}{3};path=/;'\r\n            .replace('{0}', typeof prefix === 'undefined' || prefix === null ? pageInfo.cookiePrefix : prefix)\r\n            .replace('{1}', name)\r\n            .replace('{2}', encodeURI(value))\r\n            .replace('{3}', !date ? '' : ';expires=' + date.toUTCString());\r\n};\r\n\r\n/**\r\n * 获取Cookie\r\n * @param {string} name Cookie名称\r\n * @param {string} [prefix] Cookie名称前缀，留空则表示使用{@link pageInfo.cookiePrefix}前缀\r\n * @returns {?string} Cookie值\r\n */\r\nvar getCookie = function (name, prefix) {\r\n    var regex = new RegExp(\r\n        '(^| ){0}{1}=([^;]*)(;|$)'\r\n            .replace('{0}', typeof prefix === 'undefined' || prefix === null ? pageInfo.cookiePrefix : prefix)\r\n            .replace('{1}', name)\r\n    );\r\n    var matches = document.cookie.match(regex);\r\n    if (!matches) return null;\r\n    else return decodeURI(matches[2]);\r\n};\r\n\r\n/**\r\n * 获取在当前时间的基础上的指定（相对）时间量的Date对象\r\n * @param {string} value 指定（相对）时间量，+或-：之后或之前（相对于当前时间）；无符号：绝对值；Y：完整年份；y：年；M：月；d：天；h：小时；m：分；s：秒；ms：毫秒\r\n * @returns {?Date} 指定（相对）时间量的Date对象\r\n * @example\r\n * Tools.getDate('+2y') 获取2年后的Date对象\r\n * Tools.getDate('+3M') 获取3个月后的Date对象\r\n * Tools.getDate('-4d') 获取4天前的Date对象\r\n * Tools.getDate('5h') 获取今天5点的Date对象（其它时间量与当前时间一致）\r\n * Tools.getDate('2015Y') 获取年份为2015年的Date对象\r\n */\r\nvar getDate = function (value) {\r\n    var date = new Date();\r\n    var matches = /^(-|\\+)?(\\d+)([a-zA-Z]{1,2})$/.exec(value);\r\n    if (!matches) return null;\r\n    var flag = typeof matches[1] === 'undefined' ? 0 : (matches[1] === '+' ? 1 : -1);\r\n    var increment = flag === -1 ? -parseInt(matches[2]) : parseInt(matches[2]);\r\n    var unit = matches[3];\r\n    switch (unit) {\r\n        case 'Y':\r\n            date.setFullYear(increment);\r\n            break;\r\n        case 'y':\r\n            date.setYear(flag === 0 ? increment : date.getYear() + increment);\r\n            break;\r\n        case 'M':\r\n            date.setMonth(flag === 0 ? increment : date.getMonth() + increment);\r\n            break;\r\n        case 'd':\r\n            date.setDate(flag === 0 ? increment : date.getDate() + increment);\r\n            break;\r\n        case 'h':\r\n            date.setHours(flag === 0 ? increment : date.getHours() + increment);\r\n            break;\r\n        case 'm':\r\n            date.setMinutes(flag === 0 ? increment : date.getMinutes() + increment);\r\n            break;\r\n        case 's':\r\n            date.setSeconds(flag === 0 ? increment : date.getSeconds() + increment);\r\n            break;\r\n        case 'ms':\r\n            date.setMilliseconds(flag === 0 ? increment : date.getMilliseconds() + increment);\r\n            break;\r\n        default:\r\n            return null;\r\n    }\r\n    return date;\r\n};\r\n\r\n/**\r\n * 获取指定字符串的字节长度（1个GBK字符按2个字节来算）\r\n * @param {string} str 指定字符串\r\n * @returns {number} 字符串的长度\r\n */\r\nvar getStrLen = function (str) {\r\n    var len = 0;\r\n    var s_len = str.indexOf('\\n') !== -1 ? str.replace(/\\r?\\n/g, '_').length : str.length;\r\n    var c_len = 2;\r\n    for (var i = 0; i < s_len; i++) {\r\n        len += str.charCodeAt(i) < 0 || str.charCodeAt(i) > 255 ? c_len : 1;\r\n    }\r\n    return len;\r\n};\r\n\r\n/**\r\n * 获取当前域名的URL\r\n * @returns {string} 当前域名的URL\r\n */\r\nvar getHostNameUrl = function () {\r\n    return location.protocol + '//' + location.host;\r\n};\r\n\r\n/**\r\n * 添加BBCode\r\n * @param textArea 文本框\r\n * @param {string} code BBCode\r\n * @param {string} selText 选择文本\r\n */\r\nvar addCode = function (textArea, code, selText) {\r\n    var startPos = selText === '' ? code.indexOf(']') + 1 : code.indexOf(selText);\r\n    if (typeof textArea.selectionStart !== 'undefined') {\r\n        var prePos = textArea.selectionStart;\r\n        textArea.value = textArea.value.substr(0, prePos) + code + textArea.value.substr(textArea.selectionEnd);\r\n        textArea.selectionStart = prePos + startPos;\r\n        textArea.selectionEnd = prePos + startPos + selText.length;\r\n    }\r\n    else {\r\n        textArea.value += code;\r\n    }\r\n};\r\n\r\n/**\r\n * 获取选择文本\r\n * @param textArea 文本框\r\n * @returns {string} 选择文本\r\n */\r\nvar getSelText = function (textArea) {\r\n    return textArea.value.substr(textArea.selectionStart, textArea.selectionEnd - textArea.selectionStart);\r\n};\r\n\r\n/**\r\n * 从URL查询字符串提取参数对象\r\n * @param {string} str URL查询字符串\r\n * @returns {{}} 参数对象\r\n */\r\nvar extractQueryStr = function (str) {\r\n    var param = {};\r\n    $.each(str.split('&'), function (i, value) {\r\n        if (!value) return;\r\n        var arr = value.split('=');\r\n        param[arr[0]] = typeof arr[1] !== 'undefined' ? arr[1] : '';\r\n    });\r\n    return param;\r\n};\r\n\r\n/**\r\n * 从参数对象中创建URL查询字符串\r\n * @param {{}} obj 参数对象\r\n * @returns {string} URL查询字符串\r\n */\r\nvar buildQueryStr = function (obj) {\r\n    var queryStr = '';\r\n    $.each(obj, function (key, value) {\r\n        queryStr += '/' + key + '/' + value;\r\n    });\r\n    return queryStr;\r\n};\r\n\r\n/**\r\n * 生成指定的URL\r\n * @param {string} action 控制器（小写）\r\n * @param {string} [param=''] 查询参数\r\n * @param {boolean} [includeOtherParam=false] 是否包括当前页面的其它查询参数\r\n * @returns {string} URL 最终的URL\r\n */\r\nvar makeUrl = function (action, param, includeOtherParam) {\r\n    var url = '';\r\n    var paramList = extractQueryStr(param ? param : '');\r\n    if (includeOtherParam) {\r\n        paramList = $.extend(extractQueryStr(pageInfo.urlParam), paramList);\r\n    }\r\n    var hasEntryFile = location.pathname.indexOf(pageInfo.baseFile) === 0;\r\n    if (hasEntryFile) url = pageInfo.baseFile;\r\n    else url = pageInfo.rootPath.substr(0, pageInfo.rootPath.length - 1);\r\n    var queryStr = '';\r\n    if (!$.isEmptyObject(paramList)) queryStr = buildQueryStr(paramList);\r\n    if (pageInfo.urlType === 2) url += '?s=' + '/' + action + queryStr;\r\n    else url += '/' + action + queryStr;\r\n    return url;\r\n};\r\n\r\n/**\r\n * 解码HTML特殊字符\r\n * @param {string} str 待解码的字符串\r\n * @returns {string} 解码后的字符串\r\n */\r\nvar decodeHtmlSpecialChar = function (str) {\r\n    if (str.length === 0) return '';\r\n    return str.replace(/<br\\s*\\/?>/gi, '\\n')\r\n        .replace(/&quot;/gi, '\\\"')\r\n        .replace(/&#39;/gi, '\\'')\r\n        .replace(/&nbsp;/gi, ' ')\r\n        .replace(/&gt;/gi, '>')\r\n        .replace(/&lt;/gi, '<')\r\n        .replace(/&amp;/gi, '&');\r\n};\r\n\r\n/**\r\n * 全选\r\n * @param {jQuery} $nodes 想要全选的节点的jQuery对象\r\n */\r\nvar selectAll = function ($nodes) {\r\n    $nodes.prop('checked', true);\r\n};\r\n\r\n/**\r\n * 反选\r\n * @param {jQuery} $nodes 想要反选的节点的jQuery对象\r\n */\r\nvar selectReverse = function ($nodes) {\r\n    $nodes.each(function () {\r\n        var $this = $(this);\r\n        $this.prop('checked', !$this.prop('checked'));\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定快速提交的按键事件\r\n * @param {jQuery} $node 想要绑定的节点的jQuery对象\r\n */\r\nvar bindFastSubmitKeydown = function ($node) {\r\n    $node.keydown(function (e) {\r\n        if (e.keyCode === 13 && e.ctrlKey) {\r\n            $(this).closest('form').submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 读取设置\r\n */\r\nvar readConfig = function () {\r\n    var options = localStorage['configName'];\r\n    if (!options) return;\r\n    try {\r\n        options = JSON.parse(options);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!options || $.type(options) !== 'object' || $.isEmptyObject(options)) return;\r\n    Config = options;\r\n};\r\n\r\n/**\r\n * 写入设置\r\n */\r\nvar writeConfig = function () {\r\n    localStorage['configName'] = JSON.stringify(Config);\r\n};\r\n\r\n/**\r\n * 处理主菜单\r\n */\r\nvar handleMainMenu = function () {\r\n    $('#mainMenuTogglerBtn').click(function () {\r\n        $('#mainMenu').css('max-height', document.documentElement.clientHeight - 49 + 'px');\r\n    });\r\n};\r\n\r\n/**\r\n * 处理回到顶部按钮\r\n */\r\nvar handleBackToTop = function () {\r\n    $(window).scroll(function () {\r\n        if ($(window).scrollTop() > 300)\r\n            $(\"#backToTop\").fadeIn();\r\n        else\r\n            $(\"#backToTop\").fadeOut();\r\n    });\r\n\r\n    $(\"#backToTop\").click(function () {\r\n        $('body, html').animate({scrollTop: 0});\r\n    });\r\n};\r\n\r\n/**\r\n * 处理搜索对话框\r\n */\r\nvar handleSearchDialog = function () {\r\n    var $searchDialog = $('#searchDialog');\r\n\r\n    $searchDialog.on('shown.bs.modal', function () {\r\n        $('#searchKeyword').select().focus();\r\n    }).find('form').submit(function () {\r\n        var $this = $(this);\r\n        var $searchKeyword = $this.find('#searchKeyword');\r\n        var searchType = $this.find('#searchType').val();\r\n        var keyword = $.trim($searchKeyword.val());\r\n        if (searchType === 'gjc') {\r\n            $this.attr('action', makeUrl('gjc/' + keyword));\r\n        }\r\n        else if (searchType === 'username') {\r\n            $this.attr('action', makeUrl('user/username/' + keyword));\r\n        }\r\n        else {\r\n            $this.attr('action', makeUrl('search'));\r\n            $searchKeyword.attr('name', searchType === 'author' ? 'pwuser' : 'keyword');\r\n            if (searchType === 'title') {\r\n                if (keyword.length && getStrLen(keyword) <= 2) {\r\n                    var $method = $this.find('input[name=\"method\"]');\r\n                    $method.val('OR');\r\n                    $searchKeyword.val(keyword + ' ' + Math.floor(new Date().getTime() / 1000));\r\n                    window.setTimeout(function () {\r\n                        $searchKeyword.val(keyword);\r\n                        $method.val('AND');\r\n                    }, 200);\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    $searchDialog.find('input[name=\"searchRange\"]').on('click', function () {\r\n        var value = 'all';\r\n        if ($(this).val() === 'current') value = pageInfo.fid;\r\n        $searchDialog.find('input[name=\"f_fid\"]').val(value);\r\n    });\r\n\r\n    var $current = $searchDialog.find('input[name=\"searchRange\"][value=\"current\"]');\r\n    $searchDialog.find('#searchType').change(function () {\r\n        var searchType = $(this).val();\r\n        if (!$current.data('enabled')) return;\r\n        $current.prop('disabled', searchType === 'gjc' || searchType === 'username');\r\n    });\r\n\r\n    if (pageId === 'threadPage' || pageId === 'readPage') {\r\n        $current.prop('disabled', false).data('enabled', true).click();\r\n    }\r\n};\r\n\r\n/**\r\n * 处理首页的@提醒按钮\r\n */\r\nvar handleAtTipsBtn = function () {\r\n    $('#atTips').click(function () {\r\n        var $this = $(this);\r\n        var time = $this.data('time');\r\n        var cookieValue = getCookie('at_tips_time');\r\n        if (!time || time === cookieValue) return;\r\n        if (!cookieValue) {\r\n            var currentDate = (new Date()).getDate();\r\n            setCookie('prev_at_tips_time', (currentDate < 10 ? '0' + currentDate : currentDate) + '日00时00分');\r\n        }\r\n        else if (cookieValue !== time) {\r\n            setCookie('prev_at_tips_time', cookieValue);\r\n        }\r\n        setCookie('at_tips_time', time, getDate('+3d'));\r\n        $this.removeClass('btn-outline-danger').addClass('btn-outline-primary');\r\n    });\r\n};\r\n\r\n/**\r\n * 高亮关键词页面中未读的消息\r\n */\r\nvar highlightUnReadAtTipsMsg = function () {\r\n    if (pageInfo.gjc !== pageInfo.userName) return;\r\n    var timeString = getCookie('prev_at_tips_time');\r\n    if (!timeString || !/^\\d+日\\d+时\\d+分$/.test(timeString)) return;\r\n    var prevString = '';\r\n    $('.thread-list-item time').each(function (index) {\r\n        var $this = $(this);\r\n        var curString = $.trim($this.text());\r\n        if (index === 0) prevString = curString;\r\n        if (timeString < curString && prevString >= curString) {\r\n            $this.addClass('text-danger');\r\n            prevString = curString;\r\n        }\r\n        else return false;\r\n    });\r\n\r\n    $(document).on('click', '.thread-list-item .thread-link-item a', function () {\r\n        setCookie('prev_at_tips_time', '', getDate('-1d'));\r\n    });\r\n};\r\n\r\n/**\r\n * 处理首页主题链接面板\r\n */\r\nvar handleIndexThreadPanel = function () {\r\n    if (Config['activeNewReplyPanel']) {\r\n        $('a[data-toggle=\"tab\"][href=\"{0}\"]'.replace('{0}', Config.activeNewReplyPanel)).tab('show');\r\n    }\r\n    if (Config['activeTopRecommendPanel']) {\r\n        $('a[data-toggle=\"tab\"][href=\"{0}\"]'.replace('{0}', Config.activeTopRecommendPanel)).tab('show');\r\n    }\r\n\r\n    $(document).on('shown.bs.tab', 'a[data-toggle=\"tab\"]', function (e) {\r\n        var $target = $(e.target);\r\n        readConfig();\r\n        var panelName = $target.attr('href');\r\n        var typeName = '';\r\n        if (panelName.indexOf('NewReplyPanel') > 0) typeName = 'activeNewReplyPanel';\r\n        else if (panelName.indexOf('TopRecommendPanel') > 0) typeName = 'activeTopRecommendPanel';\r\n        if (typeName) {\r\n            Config[typeName] = $target.attr('href');\r\n            writeConfig();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 处理分页导航\r\n * @param {string} action 控制器\r\n */\r\nvar handlePageNav = function (action) {\r\n    $(document).on('click', '.page-item.active > .page-link', function (e) {\r\n        e.preventDefault();\r\n        if (pageInfo.maxPageNum <= 1) return;\r\n        var num = parseInt(window.prompt('要跳转到第几页？（共' + pageInfo.maxPageNum + '页）', pageInfo.currentPageNum));\r\n        if (num && num > 0) {\r\n            location.href = makeUrl(action, 'page=' + num, true);\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 显示楼层跳转链接\r\n */\r\nvar showFloorLink = function () {\r\n    $(document).on('click', '.floor-num', function (e) {\r\n        e.preventDefault();\r\n        window.prompt('本楼的跳转链接：', getHostNameUrl() + $(this).attr('href'));\r\n    });\r\n};\r\n\r\n/**\r\n * 处理快速回复按钮\r\n */\r\nvar handleFastReplyBtn = function () {\r\n    $(document).on('click', '.fast-reply-btn', function (e) {\r\n        e.preventDefault();\r\n        var $article = $(this).closest('article');\r\n        var floor = $article.data('floor');\r\n        var userName = $article.data('username');\r\n        $('#articleGjc').val(userName);\r\n        var replyContent = $('#articleContent').get(0);\r\n        replyContent.value = '[quote]回 {0}楼({1}) 的帖子[/quote]\\n'.replace('{0}', floor).replace('{1}', userName);\r\n        replyContent.selectionStart = replyContent.value.length;\r\n        replyContent.selectionEnd = replyContent.value.length;\r\n        replyContent.focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理屏蔽回帖按钮\r\n */\r\nvar handleBlockFloorBtn = function () {\r\n    $(document).on('click', '.block-floor', function () {\r\n        if (!window.confirm('确认要屏蔽该回帖？本操作不可恢复！（屏蔽后该回帖将对大家不可见）')) return false;\r\n    });\r\n};\r\n\r\n/**\r\n * 处理购买帖子按钮\r\n */\r\nvar handleBuyThreadBtn = function () {\r\n    $(document).on('click', '.buy-thread-btn', function (e) {\r\n        e.preventDefault();\r\n        var $this = $(this);\r\n        var pid = $this.data('pid');\r\n        var price = $this.data('price');\r\n        if (price > 5 && !window.confirm('此贴售价{0}KFB，是否购买？'.replace('{0}', price))) return;\r\n        location.href = makeUrl(\r\n            'job/buytopic',\r\n            'tid={0}&pid={1}&verify={2}'\r\n                .replace('{0}', pageInfo.tid)\r\n                .replace('{1}', pid)\r\n                .replace('{2}', pageInfo.verify)\r\n        );\r\n    });\r\n};\r\n\r\n/**\r\n * 复制购买人名单\r\n */\r\nvar copyBuyThreadList = function () {\r\n    $(document).on('change', '.buy-thread-list', function () {\r\n        var $this = $(this);\r\n        if ($this.val() !== 'copyList' || $this.children().length <= 3) return;\r\n        var list = $this.find('option:gt(2)').map(function () {\r\n            return $(this).text();\r\n        }).get().join('\\n');\r\n        $('#buyThreadListContent').val(list);\r\n        $('#buyThreadListDialog').modal('show');\r\n        $this.get(0).selectedIndex = 0;\r\n    });\r\n\r\n    $('#buyThreadListDialog').on('shown.bs.modal', function () {\r\n        $('#buyThreadListContent').select().focus();\r\n    });\r\n};\r\n\r\n/**\r\n * 处理楼层内的图片\r\n */\r\nvar handleFloorImage = function () {\r\n    $(document).on('click', '.img', function () {\r\n        var $this = $(this);\r\n        if ($this.parent().is('a') || this.naturalWidth <= $this.closest('.read-content').width()) return;\r\n        location.href = $this.attr('src');\r\n    });\r\n};\r\n\r\n/**\r\n * 插入表情代码\r\n */\r\nvar addSmileCode = function () {\r\n    $('.smile-panel').on('click', 'img', function () {\r\n        $('.smile-panel').addClass('open');\r\n        var textArea = $('#articleContent').get(0);\r\n        if (!textArea) return;\r\n        var code = '[s:' + $(this).data('id') + ']';\r\n        addCode(textArea, code, '');\r\n        textArea.blur();\r\n    }).parent().on('shown.bs.dropdown', function () {\r\n        $('.smile-panel img').each(function () {\r\n            var $this = $(this);\r\n            if (!$this.attr('src')) {\r\n                $this.attr('src', $this.data('src'));\r\n            }\r\n        });\r\n    }).on('hide.bs.dropdown', function (e) {\r\n        var $relatedTarget = $(e.relatedTarget);\r\n        if (!$relatedTarget.data('open')) $relatedTarget.removeData('open');\r\n        else return e.preventDefault();\r\n    });\r\n\r\n    $('#smileDropdownBtn').click(function () {\r\n        var $this = $(this);\r\n        $this.data('open', !$this.data('open'));\r\n    });\r\n};\r\n\r\n/**\r\n * 处理发帖表单\r\n */\r\nvar handlePostForm = function () {\r\n    $('#articleForm').submit(function () {\r\n        var minLen = 12;\r\n        var $textArea = $('#articleContent');\r\n        if (getStrLen($.trim($textArea.val())) < minLen) {\r\n            alert('文章内容少于 ' + minLen + ' 个字节');\r\n            return false;\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 快速跳转到指定楼层\r\n */\r\nvar fastGotoFloor = function () {\r\n    $('.fast-goto-floor').click(function (e) {\r\n        e.preventDefault();\r\n        if (!Config.perPageFloorNum) {\r\n            var floorNum = parseInt(\r\n                window.prompt('你的论坛设置里“文章列表每页个数”为多少（10、20、30）？\\n注：如修改了论坛中的此项设置，请访问账号设置页面即可自动同步本地设置', 10)\r\n            );\r\n            if (floorNum && $.inArray(floorNum, [10, 20, 30]) !== -1) {\r\n                Config.perPageFloorNum = floorNum;\r\n                writeConfig();\r\n            }\r\n            else return;\r\n        }\r\n        var floor = parseInt(window.prompt('你要跳转到哪一层楼？'));\r\n        if (!floor || floor <= 0) return;\r\n        location.href = makeUrl(\r\n            'read/index',\r\n            'tid={0}&page={1}&floor={2}'\r\n                .replace('{0}', pageInfo.tid)\r\n                .replace('{1}', Math.floor(floor / Config.perPageFloorNum) + 1)\r\n                .replace('{2}', floor)\r\n        );\r\n    });\r\n\r\n    if (pageInfo.floor && pageInfo.floor > 0) {\r\n        var hashName = $('article[data-floor=\"' + pageInfo.floor + '\"]').prev('a').attr('name');\r\n        if (hashName) {\r\n            location.hash = '#' + hashName;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * 推帖子\r\n */\r\nvar tuiThread = function () {\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        var $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/diy_read_tui.php',\r\n            data: 'tid=' + pageInfo.tid + '&safeid=' + pageInfo.safeId,\r\n            success: function (msg) {\r\n                var matches = /<span.+?\\+\\d+!<\\/span>\\s*(\\d+)/i.exec(msg);\r\n                if (matches) {\r\n                    var $num = $this.find('span:first');\r\n                    $num.text('+1');\r\n                    window.setTimeout(function () {\r\n                        $num.text(matches[1]);\r\n                    }, 1000);\r\n                }\r\n                else if (/已推过/.test(msg)) {\r\n                    alert('已推过');\r\n                }\r\n                else {\r\n                    alert('操作失败');\r\n                }\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 复制代码\r\n */\r\nvar copyCode = function () {\r\n    $(document).on('click', '.copy-code', function (e) {\r\n        e.preventDefault();\r\n        var $this = $(this);\r\n        var code = $this.data('code');\r\n        if (code) {\r\n            $this.text('复制代码').removeData('code');\r\n            $this.next('textarea').remove();\r\n            $this.after('<pre class=\"pre-scrollable\">' + code + '</pre>');\r\n        }\r\n        else {\r\n            var $pre = $this.next('pre');\r\n            var html = $pre.html();\r\n            $this.text('还原代码').data('code', html);\r\n            html = decodeHtmlSpecialChar(html);\r\n            var height = $pre.height();\r\n            if (height < 50) height = 50;\r\n            if (height > 340) height = 340;\r\n            $pre.remove();\r\n            $('<textarea class=\"form-control code-textarea\" style=\"height: ' + height + 'px\" wrap=\"off\">' + html + '</textarea>')\r\n                .insertAfter($this).select().focus();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 获取当前页面选中的多重引用数据\r\n * @returns {{}[]} 多重引用数据列表\r\n */\r\nvar getCheckedMultiQuoteData = function () {\r\n    var quoteList = [];\r\n    $('.multi-quote-check:checked').each(function () {\r\n        var $article = $(this).closest('article');\r\n        quoteList.push({floor: $article.data('floor'), pid: $article.data('pid'), userName: $article.data('username')});\r\n    });\r\n    return quoteList;\r\n};\r\n\r\n/**\r\n * 绑定多重引用复选框点击事件\r\n */\r\nvar bindMultiQuoteCheckClick = function () {\r\n    $(document).on('click', '.multi-quote-check', function () {\r\n        var data = localStorage[Const.multiQuoteStorageName];\r\n        if (data) {\r\n            try {\r\n                data = JSON.parse(data);\r\n                if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) data = null;\r\n                else if (typeof data.tid === 'undefined' || data.tid !== pageInfo.tid || $.type(data.quoteList) !== 'object') data = null;\r\n            }\r\n            catch (ex) {\r\n                data = null;\r\n            }\r\n        }\r\n        else {\r\n            data = null;\r\n        }\r\n        var quoteList = getCheckedMultiQuoteData();\r\n        if (!data) {\r\n            localStorage.removeItem(Const.multiQuoteStorageName);\r\n            data = {tid: pageInfo.tid, quoteList: {}};\r\n        }\r\n        if (quoteList.length > 0) data.quoteList[pageInfo.currentPageNum] = quoteList;\r\n        else delete data.quoteList[pageInfo.currentPageNum];\r\n        localStorage[Const.multiQuoteStorageName] = JSON.stringify(data);\r\n    });\r\n\r\n    $('.multi-reply-btn').click(function (e) {\r\n        e.preventDefault();\r\n        handleMultiQuote(1);\r\n    });\r\n};\r\n\r\n/**\r\n * 处理多重回复和多重引用\r\n * @param {number} type 处理类型，1：多重回复；2：多重引用\r\n */\r\nvar handleMultiQuote = function (type) {\r\n    var data = localStorage[Const.multiQuoteStorageName];\r\n    if (!data) return;\r\n    try {\r\n        data = JSON.parse(data);\r\n    }\r\n    catch (ex) {\r\n        return;\r\n    }\r\n    if (!data || $.type(data) !== 'object' || $.isEmptyObject(data)) return;\r\n    if (!pageInfo.tid || typeof data.tid === 'undefined' || data.tid !== pageInfo.tid || $.type(data.quoteList) !== 'object') return;\r\n    if (type === 2 && !pageInfo.fid) return;\r\n    var list = [];\r\n    for (var i in data.quoteList) {\r\n        if ($.type(data.quoteList[i]) !== 'array') continue;\r\n        for (var j in data.quoteList[i]) {\r\n            list.push(data.quoteList[i][j]);\r\n        }\r\n    }\r\n    if (!list.length) {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        return;\r\n    }\r\n\r\n    var keywords = [];\r\n    var content = '';\r\n    if (type === 2) {\r\n        // 显示多重引用等待消息\r\n    }\r\n    $.each(list, function (index, quote) {\r\n        if (typeof quote.floor === 'undefined' || typeof quote.pid === 'undefined') return;\r\n        if ($.inArray(quote.userName, keywords) === -1) keywords.push(quote.userName);\r\n        if (type === 2) {\r\n            // 处理多重引用\r\n        }\r\n        else {\r\n            content += '[quote]回 {0}楼({1}) 的帖子[/quote]\\n'.replace('{0}', quote.floor).replace('{1}', quote.userName);\r\n        }\r\n    });\r\n    $('input[name=\"diy_guanjianci\"]').val(keywords.join(','));\r\n    $('#articleForm').submit(function () {\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n    });\r\n    if (type === 1) $('#articleContent').val(content).focus();\r\n};\r\n\r\n/**\r\n * 处理清除多重引用数据按钮\r\n * @param {number} type 处理类型，1：多重回复；2：多重引用\r\n */\r\nvar handleClearMultiQuoteDataBtn = function (type) {\r\n    $('.clear-multi-quote-data-btn').click(function (e) {\r\n        e.preventDefault();\r\n        localStorage.removeItem(Const.multiQuoteStorageName);\r\n        $('input[name=\"diy_guanjianci\"]').val('');\r\n        if (type === 2) $('#textarea').val('');\r\n        else $('#articleContent').val('');\r\n        alert('多重引用数据已被清除');\r\n    });\r\n};\r\n\r\n/**\r\n * 检查捐款按钮状态\r\n */\r\nvar checkDonationBtnStatus = function () {\r\n    if ($('form[name=\"rvrc1\"] .input-group-addon:contains(\"已捐款\")').length > 0) {\r\n        $('form[name=\"rvrc1\"]').find('input, button').prop('disabled', true);\r\n    }\r\n};\r\n\r\n/**\r\n * 处理游戏搜索区域\r\n */\r\nvar handleGameIntroSearchArea = function () {\r\n    $('#gameSearchKeyword').val(pageInfo.keyword);\r\n    $('#gameSearchType').val(pageInfo.searchType);\r\n};\r\n\r\n/**\r\n * 推游戏介绍\r\n * @param {string} type 页面类型\r\n */\r\nvar tuiGameIntro = function (type) {\r\n    var cookieName = '';\r\n    if (type === 'company') cookieName = 'g_intro_inc_tui_';\r\n    else if (type === 'type') cookieName = 'g_intro_adv_tui_';\r\n    else if (type === 'property') cookieName = 'g_intro_moe_tui_';\r\n    else cookieName = 'g_intro_tui_';\r\n    cookieName += pageInfo.id;\r\n    var url = makeUrl('game_intro/' + type, 'id=' + pageInfo.id + '&tui=1');\r\n\r\n    $('.tui-btn').click(function (e) {\r\n        e.preventDefault();\r\n        var $this = $(this);\r\n        if ($this.data('wait')) return;\r\n        if (getCookie(cookieName, '')) {\r\n            alert('你在48小时内已经推过');\r\n            return;\r\n        }\r\n        $this.data('wait', true);\r\n        $.ajax({\r\n            type: 'GET',\r\n            url: url,\r\n            success: function () {\r\n                var $num = $this.find('span:first');\r\n                var num = parseInt($num.text());\r\n                $num.text('+1');\r\n                window.setTimeout(function () {\r\n                    $num.text(++num);\r\n                }, 1000);\r\n            },\r\n            error: function () {\r\n                alert('操作失败');\r\n            },\r\n            complete: function () {\r\n                $this.removeData('wait');\r\n            },\r\n            dataType: 'html'\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 随机选择神秘盒子\r\n */\r\nvar randomSelectSmBox = function () {\r\n    $('#smBoxRandom').click(function () {\r\n        var $boxes = $('#smBoxPanel .table a');\r\n        var number = Math.floor(Math.random() * $boxes.length);\r\n        $(this).html('你选择了<b>No. ' + number + '</b>').off('click');\r\n        window.setTimeout(function () {\r\n            location.href = $boxes.eq(number).attr('href');\r\n        }, 1000);\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定收藏夹页面按钮点击事件\r\n */\r\nvar bindFavorPageBtnsClick = function () {\r\n    var $form = $('form[name=\"favorForm\"]');\r\n\r\n    $(document).on('click', '.remove-catalog', function () {\r\n        return window.confirm('是否删除该目录？');\r\n    });\r\n\r\n    $('#addCatalog').click(function (e) {\r\n        e.preventDefault();\r\n        var type = $.trim(window.prompt('请输入收藏夹目录名称：'));\r\n        if (!type) return;\r\n        $form.find('input[name=\"job\"]').val('addtype');\r\n        $form.find('input[name=\"type\"]').val(type);\r\n        $form.submit();\r\n    });\r\n\r\n    $('#favorActionBtns').on('click', 'button', function () {\r\n        var action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            selectAll($('input[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            selectReverse($('input[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'delete') {\r\n            var $checked = $('input[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && window.confirm('是否删除这{0}项？'.replace('{0}', $checked.length))) {\r\n                $form.find('input[name=\"job\"]').val('clear');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n\r\n    $('#convertCatalogDropdownMenu').on('click', 'a', function (e) {\r\n        e.preventDefault();\r\n        var type = $(this).data('type');\r\n        var $checked = $('input[name=\"delid[]\"]:checked');\r\n        if ($checked.length > 0 && window.confirm('是否将这{0}项转换到指定目录？'.replace('{0}', $checked.length))) {\r\n            $form.find('input[name=\"job\"]').val('change');\r\n            $form.find('input[name=\"type\"]').val(type);\r\n            $form.submit();\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定好友列表页面按钮点击事件\r\n */\r\nvar bindFriendPageBtnsClick = function () {\r\n    $('#friendActionBtns').on('click', 'button[type=\"button\"]', function () {\r\n        var action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            selectAll($('input[name=\"selid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            selectReverse($('input[name=\"selid[]\"]'));\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 在账号设置页面里为生日字段赋值\r\n */\r\nvar assignBirthdayFiled = function () {\r\n    $('#birthday').change(function () {\r\n        var value = $.trim($(this).val());\r\n        var matches = /(\\d{4})-(\\d{1,2})-(\\d{1,2})/.exec(value);\r\n        var year = '', month = '', day = '';\r\n        if (matches) {\r\n            year = parseInt(matches[1]);\r\n            month = parseInt(matches[2]);\r\n            day = parseInt(matches[3]);\r\n        }\r\n        $('input[name=\"proyear\"]').val(year);\r\n        $('input[name=\"promonth\"]').val(month);\r\n        $('input[name=\"proday\"]').val(day);\r\n    });\r\n};\r\n\r\n/**\r\n * 上传头像\r\n */\r\nvar uploadAvatar = function () {\r\n    $('#uploadAvatar').click(function (e) {\r\n        e.preventDefault();\r\n        var $browseAvatar = $('#browseAvatar');\r\n        if (!$browseAvatar.val()) {\r\n            alert('请选择要上传的图片');\r\n            return;\r\n        }\r\n        var formData = new FormData();\r\n        formData.append('facetype', '3');\r\n        formData.append('step', '2');\r\n        formData.append('upload', $browseAvatar.get(0).files[0]);\r\n        $.ajax({\r\n            type: 'POST',\r\n            url: '/profile.php?action=ajaxface',\r\n            data: formData,\r\n            cache: false,\r\n            contentType: false,\r\n            processData: false,\r\n            success: function (html) {\r\n                console.log(html);\r\n            },\r\n            error: function () {\r\n                alert('上传失败');\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 同步主题每页楼层数量的设置\r\n */\r\nvar syncPerPageFloorNum = function () {\r\n    /**\r\n     * 同步设置\r\n     */\r\n    var syncConfig = function () {\r\n        var perPageFloorNum = parseInt($('select[name=\"p_num\"]').val());\r\n        if (perPageFloorNum === 0) perPageFloorNum = 10;\r\n        if (!isNaN(perPageFloorNum) && perPageFloorNum !== Config.perPageFloorNum) {\r\n            Config.perPageFloorNum = perPageFloorNum;\r\n            writeConfig();\r\n        }\r\n    };\r\n\r\n    syncConfig();\r\n    $('#creator').submit(function () {\r\n        readConfig();\r\n        syncConfig();\r\n    });\r\n};\r\n\r\n/**\r\n * 转账提醒\r\n */\r\nvar transferKfbAlert = function () {\r\n    $('#transferKfbForm').submit(function () {\r\n        var $this = $(this);\r\n        var transferKfb = parseInt($this.find('input[name=\"to_money\"]').val());\r\n        var fixedDeposit = parseInt($('#fixedDeposit').text());\r\n        var currentDeposit = parseInt($('#currentDeposit').text());\r\n        if (transferKfb > 0 && fixedDeposit > 0 && transferKfb > currentDeposit) {\r\n            if (!window.confirm('你的活期存款不足，转账金额将从定期存款里扣除，是否继续？')) {\r\n                return false;\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 绑定短消息页面操作按钮点击事件\r\n */\r\nvar bindMessageActionBtnsClick = function () {\r\n    $('#messageActionBtns').on('click', 'button', function () {\r\n        var $form = $('#messageListForm');\r\n        var action = $(this).data('action');\r\n        if (action === 'selectAll') {\r\n            selectAll($('input[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectReverse') {\r\n            selectReverse($('input[name=\"delid[]\"]'));\r\n        }\r\n        else if (action === 'selectCustom') {\r\n            var title = $.trim(\r\n                window.prompt('请填写所要选择的包含指定字符串的短消息标题（可用|符号分隔多个标题）', '收到了他人转账的KFB|银行汇款通知|您的文章被评分|您的文章被删除')\r\n            );\r\n            if (!title) return;\r\n            $('input[name=\"delid[]\"]').prop('checked', false);\r\n            $('a.thread-link').each(function () {\r\n                var $this = $(this);\r\n                $.each(title.split('|'), function (index, key) {\r\n                    if ($this.text().toLowerCase().indexOf(key.toLowerCase()) > -1) {\r\n                        $this.parent().find('input[name=\"delid[]\"]').prop('checked', true);\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else if (action === 'download') {\r\n            var $checked = $('input[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && window.confirm('是否下载这{0}项？'.replace('{0}', $checked.length))) {\r\n                $form.attr('action', '/message.php').find('input[name=\"action\"]').val('down');\r\n                $form.submit();\r\n            }\r\n        }\r\n        else if (action === 'delete') {\r\n            var $checked = $('input[name=\"delid[]\"]:checked');\r\n            if ($checked.length > 0 && window.confirm('是否删除这{0}项？'.replace('{0}', $checked.length))) {\r\n                $form.attr('action', makeUrl('message/job')).find('input[name=\"action\"]').val('del');\r\n                $form.submit();\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 初始化\r\n */\r\n$(function () {\r\n    if (pageId === 'loginPage') return;\r\n    readConfig();\r\n\r\n    handleMainMenu();\r\n    handleBackToTop();\r\n    handleSearchDialog();\r\n    if (pageId === 'indexPage') {\r\n        handleAtTipsBtn();\r\n        handleIndexThreadPanel();\r\n    }\r\n    else if (pageId === 'threadPage') {\r\n        handlePageNav('thread/index');\r\n    } else if (pageId === 'readPage') {\r\n        fastGotoFloor();\r\n        handlePageNav('read/index');\r\n        tuiThread();\r\n        showFloorLink();\r\n        handleFastReplyBtn();\r\n        handleBlockFloorBtn();\r\n        handleBuyThreadBtn();\r\n        copyBuyThreadList();\r\n        handleFloorImage();\r\n        handlePostForm();\r\n        bindFastSubmitKeydown($('#articleContent'));\r\n        copyCode();\r\n        bindMultiQuoteCheckClick();\r\n        handleClearMultiQuoteDataBtn(1);\r\n        addSmileCode();\r\n    } else if (pageId === 'searchPage') {\r\n        handlePageNav('search/index');\r\n    } else if (pageId === 'gjcPage') {\r\n        highlightUnReadAtTipsMsg();\r\n    } else if (pageId === 'growUpPage') {\r\n        checkDonationBtnStatus();\r\n    } else if (pageId === 'myReplyPage') {\r\n        handlePageNav('personal/reply');\r\n    } else if (pageId === 'gameIntroSearchPage') {\r\n        handlePageNav('game_intro/search');\r\n        handleGameIntroSearchArea();\r\n    } else if (pageId === 'gameIntroPage') {\r\n        tuiGameIntro('game');\r\n    } else if (pageId === 'gameIntroCompanyPage') {\r\n        tuiGameIntro('company');\r\n    } else if (pageId === 'gameIntroTypePage') {\r\n        tuiGameIntro('type');\r\n    } else if (pageId === 'gameIntroPropertyPage') {\r\n        tuiGameIntro('property');\r\n    } else if (pageId === 'smBoxPage') {\r\n        randomSelectSmBox();\r\n    } else if (pageId === 'favorPage') {\r\n        bindFavorPageBtnsClick();\r\n    } else if (pageId === 'friendPage') {\r\n        bindFriendPageBtnsClick();\r\n    } else if (pageId === 'modifyPage') {\r\n        syncPerPageFloorNum();\r\n        assignBirthdayFiled();\r\n        //uploadAvatar();\r\n    } else if (pageId === 'bankPage') {\r\n        transferKfbAlert();\r\n    } else if (pageId === 'bankLogPage') {\r\n        handlePageNav('bank/log');\r\n    } else if (pageId === 'messagePage') {\r\n        handlePageNav('message/index');\r\n        bindMessageActionBtnsClick();\r\n    } else if (pageId === 'readMessagePage') {\r\n        handleFloorImage();\r\n        copyCode();\r\n    } else if (pageId === 'writeMessagePage') {\r\n        bindFastSubmitKeydown($('#msgContent'));\r\n    } else if (pageId === 'messageBannedPage') {\r\n        bindFastSubmitKeydown($('#banidinfo'));\r\n    }\r\n\r\n    //var tooltipStartTime = new Date();\r\n    $('[data-toggle=\"tooltip\"]').tooltip({'container': 'body'});\r\n    //console.log('tooltip初始化耗时：' + (new Date() - tooltipStartTime) + 'ms');\r\n});\r\n"],"sourceRoot":"/source/"}